<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="dark-mode">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="SolarResult Dinnis Core API Documentation" />
<meta property="og:description" content="API documentation for SolarResult Dinnis Core - IoT firmware for smart meter gateway device built with Zephyr RTOS on Nordic nRF9161" />
<!-- END opengraph metadata -->
<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="solar_result_white.svg">
<title>SolarResult Dinnis Core: modules/message_queue/message_queue.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    // Initialize Doxygen Awesome features (dark mode only, no toggle)
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="solar_result_white.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SolarResult Dinnis Core
   &#160;<span id="projectnumber">v1.0.0-unstable</span>
   </div>
   <div id="projectbrief">Dinnis Rev1.0.0 Firmware - IoT Gateway for DSMR P1 Smart Meters</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('message__queue_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">message_queue.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;zephyr/kernel.h&gt;</code><br />
<code>#include &lt;zephyr/logging/log.h&gt;</code><br />
<code>#include &lt;zephyr/smf.h&gt;</code><br />
<code>#include &lt;zephyr/task_wdt/task_wdt.h&gt;</code><br />
<code>#include &lt;zephyr/zbus/zbus.h&gt;</code><br />
<code>#include &lt;net/nrf_cloud.h&gt;</code><br />
<code>#include &lt;net/nrf_cloud_codec.h&gt;</code><br />
<code>#include &lt;net/nrf_cloud_defs.h&gt;</code><br />
<code>#include &quot;<a class="el" href="cloud__zbus_8h_source.html">cloud_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="energy__pulse__zbus_8h_source.html">energy_pulse_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="message__queue__zbus_8h_source.html">message_queue_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="modules__common_8h_source.html">modules_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p__one__zbus_8h_source.html">p_one_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="task__wdt__util_8h_source.html">task_wdt_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timing__zbus_8h_source.html">timing_zbus.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for message_queue.c:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c__incl.png" border="0" usemap="#amodules_2message__queue_2message__queue_8c" loading="lazy" alt=""/></div>
<map name="amodules_2message__queue_2message__queue_8c" id="amodules_2message__queue_2message__queue_8c">
<area shape="rect" title=" " alt="" coords="800,5,988,45"/>
<area shape="rect" title=" " alt="" coords="230,255,353,280"/>
<area shape="poly" title=" " alt="" coords="800,31,680,36,545,46,423,66,375,79,340,96,324,109,313,125,298,164,292,205,292,240,287,240,287,205,293,163,308,123,320,105,337,91,373,74,422,61,545,41,680,30,800,25"/>
<area shape="rect" title=" " alt="" coords="1185,93,1340,119"/>
<area shape="poly" title=" " alt="" coords="983,43,1196,88,1195,93,982,48"/>
<area shape="rect" title=" " alt="" coords="1364,93,1470,119"/>
<area shape="poly" title=" " alt="" coords="989,37,1351,91,1350,96,988,42"/>
<area shape="rect" title=" " alt="" coords="330,167,491,207"/>
<area shape="poly" title=" " alt="" coords="838,48,481,165,480,160,837,43"/>
<area shape="rect" title=" " alt="" coords="712,255,858,280"/>
<area shape="poly" title=" " alt="" coords="890,46,861,118,821,208,801,244,797,241,816,205,856,116,885,44"/>
<area shape="rect" title=" " alt="" coords="1495,93,1614,119"/>
<area shape="poly" title=" " alt="" coords="989,33,1209,57,1481,91,1481,96,1209,62,988,39"/>
<area shape="rect" title=" " alt="" coords="1638,93,1802,119"/>
<area shape="poly" title=" " alt="" coords="989,32,1269,56,1624,90,1624,96,1269,61,988,37"/>
<area shape="rect" title=" " alt="" coords="1826,93,1981,119"/>
<area shape="poly" title=" " alt="" coords="989,29,1346,52,1813,91,1813,96,1346,57,988,34"/>
<area shape="rect" href="cloud__zbus_8h.html" title=" " alt="" coords="516,174,622,199"/>
<area shape="poly" title=" " alt="" coords="857,48,606,170,603,166,855,43"/>
<area shape="rect" href="energy__pulse__zbus_8h.html" title=" " alt="" coords="647,174,806,199"/>
<area shape="poly" title=" " alt="" coords="876,47,750,166,747,162,873,44"/>
<area shape="rect" href="message__queue__zbus_8h.html" title=" " alt="" coords="932,93,1110,119"/>
<area shape="poly" title=" " alt="" coords="926,43,992,84,989,88,924,48"/>
<area shape="rect" href="p__one__zbus_8h.html" title=" " alt="" coords="1178,174,1288,199"/>
<area shape="poly" title=" " alt="" coords="989,43,1057,62,1124,91,1175,126,1215,162,1211,166,1171,130,1121,96,1055,67,988,48"/>
<area shape="rect" href="modules__common_8h.html" title=" " alt="" coords="37,93,192,119"/>
<area shape="poly" title=" " alt="" coords="801,38,223,96,206,98,205,92,222,91,800,33"/>
<area shape="rect" href="task__wdt__util_8h.html" title=" " alt="" coords="350,93,471,119"/>
<area shape="poly" title=" " alt="" coords="800,45,485,95,484,90,799,39"/>
<area shape="rect" href="timing__zbus_8h.html" title=" " alt="" coords="882,174,995,199"/>
<area shape="poly" title=" " alt="" coords="902,45,934,160,929,161,897,46"/>
<area shape="poly" title=" " alt="" coords="530,202,504,209,347,253,345,248,503,204,529,197"/>
<area shape="poly" title=" " alt="" coords="601,197,742,248,740,253,599,202"/>
<area shape="poly" title=" " alt="" coords="672,202,635,209,367,256,366,251,634,204,671,197"/>
<area shape="poly" title=" " alt="" coords="737,198,770,242,766,245,733,201"/>
<area shape="poly" title=" " alt="" coords="979,121,783,173,782,168,977,116"/>
<area shape="rect" title=" " alt="" coords="1020,174,1102,199"/>
<area shape="poly" title=" " alt="" coords="1029,118,1051,161,1047,163,1025,120"/>
<area shape="rect" title=" " alt="" coords="1104,255,1175,280"/>
<area shape="poly" title=" " alt="" coords="1051,116,1086,136,1116,165,1134,203,1141,240,1136,241,1129,205,1112,168,1082,140,1049,121"/>
<area shape="poly" title=" " alt="" coords="1053,116,1190,167,1189,172,1051,121"/>
<area shape="poly" title=" " alt="" coords="1221,202,1166,248,1162,244,1218,197"/>
<area shape="poly" title=" " alt="" coords="78,121,43,139,27,152,15,168,8,188,10,196,15,205,27,215,46,225,97,240,158,251,217,258,216,263,157,256,96,245,44,230,24,220,11,208,5,198,3,187,11,165,24,149,40,135,75,116"/>
<area shape="rect" title=" " alt="" coords="26,174,203,199"/>
<area shape="poly" title=" " alt="" coords="117,119,117,160,112,160,112,119"/>
<area shape="poly" title=" " alt="" coords="383,121,350,140,320,168,303,205,296,241,291,240,298,203,316,165,347,136,381,116"/>
<area shape="poly" title=" " alt="" coords="413,119,413,153,408,153,408,119"/>
<area shape="poly" title=" " alt="" coords="917,202,821,251,819,246,914,197"/>
<area shape="poly" title=" " alt="" coords="969,197,1099,247,1097,252,967,202"/>
</map>
</div>
</div>
<p><a href="message__queue_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:message_5Fqueue_5Fstate_5Fobject" id="r_message_5Fqueue_5Fstate_5Fobject"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmessage__queue__state__object.html">message_queue_state_object</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3b5933d01a8c2ba7a93b5e6aa71593b8" id="r_a3b5933d01a8c2ba7a93b5e6aa71593b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>(X)</td></tr>
<tr class="memitem:a17e333794ae761cd55ec6fd6fc0f1bac" id="r_a17e333794ae761cd55ec6fd6fc0f1bac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17e333794ae761cd55ec6fd6fc0f1bac">MAX_MSG_SIZE</a>&#160;&#160;&#160;<a class="el" href="modules__common_8h.html#ae3900a89ee01727e706bded5fb7e0d11">MAX_MSG_SIZE_FROM_LIST</a>(<a class="el" href="cloud_8c.html#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>)</td></tr>
<tr class="memitem:a848ed8b7e0fb0c3ef37659dd114b7a48" id="r_a848ed8b7e0fb0c3ef37659dd114b7a48"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a848ed8b7e0fb0c3ef37659dd114b7a48">ADD_OBSERVERS</a>(_chan,  _type)</td></tr>
<tr class="memitem:a7ebddf689a7814bf99a483ee93342257" id="r_a7ebddf689a7814bf99a483ee93342257"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ebddf689a7814bf99a483ee93342257">COLLECTION_TIMEOUT_MS</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memitem:a2c8e46d63c3681faca97c3341bd2af97" id="r_a2c8e46d63c3681faca97c3341bd2af97"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c8e46d63c3681faca97c3341bd2af97">MAX_MSGS_PER_CYCLE</a>&#160;&#160;&#160;10</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-enum-members" class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ac36eaccb444831fdf2690af621237d3e" id="r_ac36eaccb444831fdf2690af621237d3e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac36eaccb444831fdf2690af621237d3e">message_queue_state</a> { <br />
&#160;&#160;<a class="el" href="#ac36eaccb444831fdf2690af621237d3eae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a>
, <br />
&#160;&#160;<a class="el" href="#ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66">STATE_COLLECTING_DATA</a>
, <br />
&#160;&#160;<a class="el" href="#ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4">STATE_SEND_MSG_ATTEMPT</a>
<br />
 }</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aff430b898ed92fcfcb14c01d3cc0d2c9" id="r_aff430b898ed92fcfcb14c01d3cc0d2c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff430b898ed92fcfcb14c01d3cc0d2c9">LOG_MODULE_REGISTER</a> (message_queue, CONFIG_APP_MESSAGE_QUEUE_MODULE_LOG_LEVEL)</td></tr>
<tr class="memitem:af2a996a587e51f1c9bae9e4d484afc61" id="r_af2a996a587e51f1c9bae9e4d484afc61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2a996a587e51f1c9bae9e4d484afc61">BUILD_ASSERT</a> (CONFIG_APP_MESSAGE_QUEUE_MODULE_WATCHDOG_TIMEOUT_SECONDS &gt; CONFIG_APP_MESSAGE_QUEUE_MODULE_MSG_PROCESSING_TIME_SECONDS, &quot;Watchdog timeout must be greater than message processing time&quot;)</td></tr>
<tr class="memitem:a0e845823aaacc286f3e8c0aaf560c98b" id="r_a0e845823aaacc286f3e8c0aaf560c98b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e845823aaacc286f3e8c0aaf560c98b">ZBUS_MSG_SUBSCRIBER_DEFINE</a> (message_queue_subscriber)</td></tr>
<tr class="memitem:a59a0d14215c57cca3cc579702c365566" id="r_a59a0d14215c57cca3cc579702c365566"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59a0d14215c57cca3cc579702c365566">ZBUS_CHAN_ADD_OBS</a> (CLOUD_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a67ac4f6e77aa428626bd119ed894eaeb" id="r_a67ac4f6e77aa428626bd119ed894eaeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67ac4f6e77aa428626bd119ed894eaeb">ZBUS_CHAN_ADD_OBS</a> (P_ONE_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a2e9a50628d2d7e871721c130837b3943" id="r_a2e9a50628d2d7e871721c130837b3943"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e9a50628d2d7e871721c130837b3943">ZBUS_CHAN_ADD_OBS</a> (ENERGY_PULSE_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a4de0aa1fcbf51a587a3ab462c1326ecb" id="r_a4de0aa1fcbf51a587a3ab462c1326ecb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4de0aa1fcbf51a587a3ab462c1326ecb">ZBUS_CHAN_ADD_OBS</a> (DATA_PUBLISH_REQUEST_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:ac86772b6559cbc5ca3de13e0a2091fb1" id="r_ac86772b6559cbc5ca3de13e0a2091fb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac86772b6559cbc5ca3de13e0a2091fb1">ZBUS_CHAN_ADD_OBS</a> (DATA_SEND_REQUEST_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a1960ea4ac2008ab8f4cab1059ab651ac" id="r_a1960ea4ac2008ab8f4cab1059ab651ac"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1960ea4ac2008ab8f4cab1059ab651ac">state_operational_entry</a> (void *o)</td></tr>
<tr class="memdesc:a1960ea4ac2008ab8f4cab1059ab651ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry function for OPERATIONAL state.  <br /></td></tr>
<tr class="memitem:a5894fe4ced254ada1ff0ec62e8c3dab9" id="r_a5894fe4ced254ada1ff0ec62e8c3dab9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5894fe4ced254ada1ff0ec62e8c3dab9">state_operational_run</a> (void *o)</td></tr>
<tr class="memdesc:a5894fe4ced254ada1ff0ec62e8c3dab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run function for OPERATIONAL state.  <br /></td></tr>
<tr class="memitem:a69e0516026a9b9eef40a8cc1919d9e4d" id="r_a69e0516026a9b9eef40a8cc1919d9e4d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a69e0516026a9b9eef40a8cc1919d9e4d">state_collecting_data_entry</a> (void *o)</td></tr>
<tr class="memdesc:a69e0516026a9b9eef40a8cc1919d9e4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry function for COLLECTING_DATA state.  <br /></td></tr>
<tr class="memitem:a4ffe60323dfa7ef4c85510e2c7e135c1" id="r_a4ffe60323dfa7ef4c85510e2c7e135c1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ffe60323dfa7ef4c85510e2c7e135c1">state_collecting_data_run</a> (void *o)</td></tr>
<tr class="memdesc:a4ffe60323dfa7ef4c85510e2c7e135c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run function for COLLECTING_DATA state.  <br /></td></tr>
<tr class="memitem:a38cb2a08ca66bebc3fa27058d4cfd91f" id="r_a38cb2a08ca66bebc3fa27058d4cfd91f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38cb2a08ca66bebc3fa27058d4cfd91f">state_send_msg_attempt_entry</a> (void *o)</td></tr>
<tr class="memdesc:a38cb2a08ca66bebc3fa27058d4cfd91f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry function for SEND_MSG_ATTEMPT state.  <br /></td></tr>
<tr class="memitem:a97890684bfa65f65e530be570155ef6e" id="r_a97890684bfa65f65e530be570155ef6e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97890684bfa65f65e530be570155ef6e">update_cloud_status</a> (const struct <a class="el" href="structcloud__msg.html">cloud_msg</a> *msg)</td></tr>
<tr class="memdesc:a97890684bfa65f65e530be570155ef6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update cloud readiness status.  <br /></td></tr>
<tr class="memitem:a6150572ae890b0b64b8deb007fe3b402" id="r_a6150572ae890b0b64b8deb007fe3b402"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6150572ae890b0b64b8deb007fe3b402">combine_and_queue_data</a> (void)</td></tr>
<tr class="memdesc:a6150572ae890b0b64b8deb007fe3b402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine collected data and queue the result.  <br /></td></tr>
<tr class="memitem:ab9815de4b7b6dd6a1d493fb57448a61d" id="r_ab9815de4b7b6dd6a1d493fb57448a61d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab9815de4b7b6dd6a1d493fb57448a61d">collection_timeout_handler</a> (struct k_timer *timer)</td></tr>
<tr class="memdesc:ab9815de4b7b6dd6a1d493fb57448a61d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collection timeout handler.  <br /></td></tr>
<tr class="memitem:af7e68654facf8babc9920ba337d98b3f" id="r_af7e68654facf8babc9920ba337d98b3f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7e68654facf8babc9920ba337d98b3f">queue_combined_message</a> (const struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a> *msg)</td></tr>
<tr class="memdesc:af7e68654facf8babc9920ba337d98b3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue a combined energy message with FIFO drop-oldest strategy.  <br /></td></tr>
<tr class="memitem:ad3667701d9e14f8b5fc4e3ee0131a27b" id="r_ad3667701d9e14f8b5fc4e3ee0131a27b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3667701d9e14f8b5fc4e3ee0131a27b">task_wdt_callback</a> (int channel_id, void *user_data)</td></tr>
<tr class="memdesc:ad3667701d9e14f8b5fc4e3ee0131a27b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task watchdog timeout callback.  <br /></td></tr>
<tr class="memitem:ae10632bd80814b65aeab8b546f07f0bf" id="r_ae10632bd80814b65aeab8b546f07f0bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae10632bd80814b65aeab8b546f07f0bf">K_TIMER_DEFINE</a> (collection_timer, <a class="el" href="#ab9815de4b7b6dd6a1d493fb57448a61d">collection_timeout_handler</a>, NULL)</td></tr>
<tr class="memitem:ae9820326512114f9d391c41364a4a7f3" id="r_ae9820326512114f9d391c41364a4a7f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9820326512114f9d391c41364a4a7f3">K_MSGQ_DEFINE</a> (combined_energy_msgq, sizeof(struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a>), CONFIG_APP_MESSAGE_QUEUE_MODULE_QUEUE_SIZE, 1)</td></tr>
<tr class="memitem:adca8ee032108f348cf8ea3936481854d" id="r_adca8ee032108f348cf8ea3936481854d"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adca8ee032108f348cf8ea3936481854d">get_queue_usage</a> (void)</td></tr>
<tr class="memdesc:adca8ee032108f348cf8ea3936481854d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of messages currently in queue.  <br /></td></tr>
<tr class="memitem:a0a18dae9147827c899adc85732e672cd" id="r_a0a18dae9147827c899adc85732e672cd"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a18dae9147827c899adc85732e672cd">is_queue_empty</a> (void)</td></tr>
<tr class="memdesc:a0a18dae9147827c899adc85732e672cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if queue is empty.  <br /></td></tr>
<tr class="memitem:a16e0c8c199c4c428750fd989c79f437b" id="r_a16e0c8c199c4c428750fd989c79f437b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16e0c8c199c4c428750fd989c79f437b">build_combined_energy_json</a> (const struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a> *msg, struct nrf_cloud_obj *const obj)</td></tr>
<tr class="memdesc:a16e0c8c199c4c428750fd989c79f437b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build nRF Cloud JSON object from combined energy message.  <br /></td></tr>
<tr class="memitem:ab4b89d883393468f3d4629a61ed0b07a" id="r_ab4b89d883393468f3d4629a61ed0b07a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab4b89d883393468f3d4629a61ed0b07a">message_queue_thread</a> (void)</td></tr>
<tr class="memdesc:ab4b89d883393468f3d4629a61ed0b07a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main message queue thread.  <br /></td></tr>
<tr class="memitem:a8466a00a75815de095e483573fba1617" id="r_a8466a00a75815de095e483573fba1617"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8466a00a75815de095e483573fba1617">K_THREAD_DEFINE</a> (message_queue_thread_id, CONFIG_APP_MESSAGE_QUEUE_MODULE_THREAD_STACK_SIZE, <a class="el" href="#ab4b89d883393468f3d4629a61ed0b07a">message_queue_thread</a>, NULL, NULL, NULL, CONFIG_APP_THREAD_PRIORITY_MESSAGE_QUEUE, 0, 0)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a693d2ea076d2873522108af791cbf451" id="r_a693d2ea076d2873522108af791cbf451"><td class="memItemLeft" align="right" valign="top">static const struct smf_state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a693d2ea076d2873522108af791cbf451">states</a> []</td></tr>
<tr class="memitem:"><td class="memItemLeft anon">struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a793c60eb3eb2d4dee66264636979039c" id="r_a793c60eb3eb2d4dee66264636979039c"><td class="memItemLeft anon">&#160;&#160;&#160;bool&#160;&#160;&#160;<a class="el" href="#a6a0e977ab733be8d10cfdeabb12314b4">has_data</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ac5800ad7ae7032b9486e76c4ddac0d30" id="r_ac5800ad7ae7032b9486e76c4ddac0d30"><td class="memItemLeft anon">&#160;&#160;&#160;struct <a class="el" href="structp__one__msg.html">p_one_msg</a>&#160;&#160;&#160;<a class="el" href="#afe1b4b4eb80224902d335e63ace502af">data</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a2d5e02455d1f14bb83db9571fdf67bd2" id="r_a2d5e02455d1f14bb83db9571fdf67bd2"><td class="memItemLeft anonEnd" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d5e02455d1f14bb83db9571fdf67bd2">collected_p1</a></td></tr>
<tr class="memitem:"><td class="memItemLeft anon">struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:aef5c13fe3cbdcf65fbf2f99a21a3dc95" id="r_aef5c13fe3cbdcf65fbf2f99a21a3dc95"><td class="memItemLeft anon">&#160;&#160;&#160;bool&#160;&#160;&#160;<a class="el" href="#a6a0e977ab733be8d10cfdeabb12314b4">has_data</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ab0aefeae0bb716742f1778eb0b440cce" id="r_ab0aefeae0bb716742f1778eb0b440cce"><td class="memItemLeft anon">&#160;&#160;&#160;struct <a class="el" href="structenergy__pulse__msg.html">energy_pulse_msg</a>&#160;&#160;&#160;<a class="el" href="#afe1b4b4eb80224902d335e63ace502af">data</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a2857022b6a6f199a8f0ac696dd4381ef" id="r_a2857022b6a6f199a8f0ac696dd4381ef"><td class="memItemLeft anonEnd" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2857022b6a6f199a8f0ac696dd4381ef">collected_pulse</a></td></tr>
<tr class="memitem:a46c0c7b465fa0f91ab3e2b5cfa3b09c4" id="r_a46c0c7b465fa0f91ab3e2b5cfa3b09c4"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46c0c7b465fa0f91ab3e2b5cfa3b09c4">collection_timeout_expired</a> = false</td></tr>
<tr class="memitem:a6f1182cd9184295f68d09c18dc04ba36" id="r_a6f1182cd9184295f68d09c18dc04ba36"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f1182cd9184295f68d09c18dc04ba36">is_cloud_ready</a> = false</td></tr>
</table>
<a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="a848ed8b7e0fb0c3ef37659dd114b7a48" name="a848ed8b7e0fb0c3ef37659dd114b7a48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848ed8b7e0fb0c3ef37659dd114b7a48">&#9670;&#160;</a></span>ADD_OBSERVERS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADD_OBSERVERS</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_chan</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_function" href="cloud_8c.html#ac9283cac5c939b94ce902cdf54042b7b">ZBUS_CHAN_ADD_OBS</a>(_chan, message_queue_subscriber, 0);</div>
<div class="ttc" id="acloud_8c_html_ac9283cac5c939b94ce902cdf54042b7b"><div class="ttname"><a href="cloud_8c.html#ac9283cac5c939b94ce902cdf54042b7b">ZBUS_CHAN_ADD_OBS</a></div><div class="ttdeci">ZBUS_CHAN_ADD_OBS(NETWORK_CHAN, cloud_subscriber, 0)</div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00062">62</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a3b5933d01a8c2ba7a93b5e6aa71593b8" name="a3b5933d01a8c2ba7a93b5e6aa71593b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b5933d01a8c2ba7a93b5e6aa71593b8">&#9670;&#160;</a></span>CHANNEL_LIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHANNEL_LIST</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    X(CLOUD_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structcloud__msg.html">cloud_msg</a>)                       \</div>
<div class="line">    X(P_ONE_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structp__one__msg.html">p_one_msg</a>)                       \</div>
<div class="line">    X(ENERGY_PULSE_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structenergy__pulse__msg.html">energy_pulse_msg</a>)         \</div>
<div class="line">    X(DATA_PUBLISH_REQUEST_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structtiming__event__msg.html">timing_event_msg</a>) \</div>
<div class="line">    X(DATA_SEND_REQUEST_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structtiming__event__msg.html">timing_event_msg</a>)</div>
<div class="ttc" id="astructcloud__msg_html"><div class="ttname"><a href="structcloud__msg.html">cloud_msg</a></div><div class="ttdef"><b>Definition</b> <a href="cloud__zbus_8h_source.html#l00039">cloud_zbus.h:39</a></div></div>
<div class="ttc" id="astructenergy__pulse__msg_html"><div class="ttname"><a href="structenergy__pulse__msg.html">energy_pulse_msg</a></div><div class="ttdoc">Energy pulse message.</div><div class="ttdef"><b>Definition</b> <a href="energy__pulse__zbus_8h_source.html#l00034">energy_pulse_zbus.h:34</a></div></div>
<div class="ttc" id="astructp__one__msg_html"><div class="ttname"><a href="structp__one__msg.html">p_one_msg</a></div><div class="ttdoc">P_ONE module message structure.</div><div class="ttdef"><b>Definition</b> <a href="p__one__zbus_8h_source.html#l00035">p_one_zbus.h:35</a></div></div>
<div class="ttc" id="astructtiming__event__msg_html"><div class="ttname"><a href="structtiming__event__msg.html">timing_event_msg</a></div><div class="ttdoc">Timing event message structure.</div><div class="ttdef"><b>Definition</b> <a href="timing__zbus_8h_source.html#l00030">timing_zbus.h:30</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00051">51</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a7ebddf689a7814bf99a483ee93342257" name="a7ebddf689a7814bf99a483ee93342257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ebddf689a7814bf99a483ee93342257">&#9670;&#160;</a></span>COLLECTION_TIMEOUT_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COLLECTION_TIMEOUT_MS&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00176">176</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00707">state_collecting_data_entry()</a>.</p>

</div>
</div>
<a id="a17e333794ae761cd55ec6fd6fc0f1bac" name="a17e333794ae761cd55ec6fd6fc0f1bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e333794ae761cd55ec6fd6fc0f1bac">&#9670;&#160;</a></span>MAX_MSG_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MSG_SIZE&#160;&#160;&#160;<a class="el" href="modules__common_8h.html#ae3900a89ee01727e706bded5fb7e0d11">MAX_MSG_SIZE_FROM_LIST</a>(<a class="el" href="cloud_8c.html#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00059">59</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a2c8e46d63c3681faca97c3341bd2af97" name="a2c8e46d63c3681faca97c3341bd2af97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c8e46d63c3681faca97c3341bd2af97">&#9670;&#160;</a></span>MAX_MSGS_PER_CYCLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MSGS_PER_CYCLE&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00815">state_send_msg_attempt_entry()</a>.</p>

</div>
</div>
<a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Enumeration Type Documentation</h2>
<a id="ac36eaccb444831fdf2690af621237d3e" name="ac36eaccb444831fdf2690af621237d3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac36eaccb444831fdf2690af621237d3e">&#9670;&#160;</a></span>message_queue_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ac36eaccb444831fdf2690af621237d3e">message_queue_state</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ac36eaccb444831fdf2690af621237d3eae76ec4894110475b8ecfcce46d09066d" name="ac36eaccb444831fdf2690af621237d3eae76ec4894110475b8ecfcce46d09066d"></a>STATE_OPERATIONAL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66" name="ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66"></a>STATE_COLLECTING_DATA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4" name="ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4"></a>STATE_SEND_MSG_ATTEMPT&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00075">75</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="af2a996a587e51f1c9bae9e4d484afc61" name="af2a996a587e51f1c9bae9e4d484afc61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a996a587e51f1c9bae9e4d484afc61">&#9670;&#160;</a></span>BUILD_ASSERT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BUILD_ASSERT </td>
          <td>(</td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_WATCHDOG_TIMEOUT_SECONDS</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_MSG_PROCESSING_TIME_SECONDS</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;Watchdog timeout must be greater than message processing time&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a16e0c8c199c4c428750fd989c79f437b" name="a16e0c8c199c4c428750fd989c79f437b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e0c8c199c4c428750fd989c79f437b">&#9670;&#160;</a></span>build_combined_energy_json()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int build_combined_energy_json </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct nrf_cloud_obj *const</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build nRF Cloud JSON object from combined energy message. </p>
<p>Creates a JSON object with appId="DINNIS" containing P1 and/or Pulse data. Structure follows nRF Cloud device message format with timestamp and data sections. Uses short key names for bandwidth optimization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Combined energy message with P1 and/or Pulse data </td></tr>
    <tr><td class="paramname">obj</td><td>Output object to be encoded (must be initialized)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00420">420</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="p__one__zbus_8h_source.html#l00039">p_one_msg::energy_consumed_wh_tariff1</a>, <a class="el" href="p__one__zbus_8h_source.html#l00040">p_one_msg::energy_consumed_wh_tariff2</a>, <a class="el" href="p__one__zbus_8h_source.html#l00043">p_one_msg::energy_delivered_wh_tariff1</a>, <a class="el" href="p__one__zbus_8h_source.html#l00044">p_one_msg::energy_delivered_wh_tariff2</a>, <a class="el" href="p__one__zbus_8h_source.html#l00047">p_one_msg::gas_consumed_m3</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00039">combined_energy_msg::has_p1_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00042">combined_energy_msg::has_pulse_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00040">combined_energy_msg::p1_data</a>, <a class="el" href="p__one__zbus_8h_source.html#l00051">p_one_msg::power_consumed_avg_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00053">p_one_msg::power_consumed_max_timestamp</a>, <a class="el" href="p__one__zbus_8h_source.html#l00052">p_one_msg::power_consumed_max_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00054">p_one_msg::power_consumed_min_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00058">p_one_msg::power_delivered_avg_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00060">p_one_msg::power_delivered_max_timestamp</a>, <a class="el" href="p__one__zbus_8h_source.html#l00059">p_one_msg::power_delivered_max_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00061">p_one_msg::power_delivered_min_w</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00043">combined_energy_msg::pulse_data</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00036">energy_pulse_msg::pulse_energy_ch1_wh</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00037">energy_pulse_msg::pulse_energy_ch2_wh</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00037">combined_energy_msg::timestamp</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00035">energy_pulse_msg::timestamp</a>, and <a class="el" href="p__one__zbus_8h_source.html#l00036">p_one_msg::timestamp</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00815">state_send_msg_attempt_entry()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a16e0c8c199c4c428750fd989c79f437b_icgraph.png" border="0" usemap="#amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_icgraph" id="amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_icgraph">
<area shape="rect" title="Build nRF Cloud JSON object from combined energy message." alt="" coords="240,13,451,38"/>
<area shape="rect" href="message__queue_8c.html#a38cb2a08ca66bebc3fa27058d4cfd91f" title="Entry function for SEND_MSG_ATTEMPT state." alt="" coords="5,5,192,45"/>
<area shape="poly" title=" " alt="" coords="226,28,192,28,192,23,226,23"/>
</map>
</div>

</div>
</div>
<a id="ab9815de4b7b6dd6a1d493fb57448a61d" name="ab9815de4b7b6dd6a1d493fb57448a61d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9815de4b7b6dd6a1d493fb57448a61d">&#9670;&#160;</a></span>collection_timeout_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void collection_timeout_handler </td>
          <td>(</td>
          <td class="paramtype">struct k_timer *</td>          <td class="paramname"><span class="paramname"><em>timer</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collection timeout handler. </p>
<p>Called when collection window times out. Sets a flag that will be checked by the state machine in the main thread.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timer</td><td>Timer that expired (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00299">299</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00164">collection_timeout_expired</a>.</p>

<p class="reference">Referenced by <a class="el" href="#ae10632bd80814b65aeab8b546f07f0bf">K_TIMER_DEFINE()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ab9815de4b7b6dd6a1d493fb57448a61d_icgraph.png" border="0" usemap="#amessage__queue_8c_ab9815de4b7b6dd6a1d493fb57448a61d_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ab9815de4b7b6dd6a1d493fb57448a61d_icgraph" id="amessage__queue_8c_ab9815de4b7b6dd6a1d493fb57448a61d_icgraph">
<area shape="rect" title="Collection timeout handler." alt="" coords="188,5,331,45"/>
<area shape="rect" href="message__queue_8c.html#ae10632bd80814b65aeab8b546f07f0bf" title=" " alt="" coords="5,13,140,38"/>
<area shape="poly" title=" " alt="" coords="175,28,140,28,140,23,175,23"/>
</map>
</div>

</div>
</div>
<a id="a6150572ae890b0b64b8deb007fe3b402" name="a6150572ae890b0b64b8deb007fe3b402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6150572ae890b0b64b8deb007fe3b402">&#9670;&#160;</a></span>combine_and_queue_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void combine_and_queue_data </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Combine collected data and queue the result. </p>
<p>Called when collection window closes (either all data received or timeout). Combines whatever data was collected and queues it with flags indicating which data sources were available. </p>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00237">237</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="#a2d5e02455d1f14bb83db9571fdf67bd2">collected_p1</a>, <a class="el" href="#a2857022b6a6f199a8f0ac696dd4381ef">collected_pulse</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00039">combined_energy_msg::has_p1_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00042">combined_energy_msg::has_pulse_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00040">combined_energy_msg::p1_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00043">combined_energy_msg::pulse_data</a>, <a class="el" href="message__queue_8c_source.html#l00364">queue_combined_message()</a>, and <a class="el" href="message__queue__zbus_8h_source.html#l00037">combined_energy_msg::timestamp</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00730">state_collecting_data_run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a6150572ae890b0b64b8deb007fe3b402_cgraph.png" border="0" usemap="#amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_cgraph" id="amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_cgraph">
<area shape="rect" title="Combine collected data and queue the result." alt="" coords="5,5,197,31"/>
<area shape="rect" href="message__queue_8c.html#af7e68654facf8babc9920ba337d98b3f" title="Queue a combined energy message with FIFO drop&#45;oldest strategy." alt="" coords="245,5,444,31"/>
<area shape="poly" title=" " alt="" coords="197,15,232,15,232,21,197,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a6150572ae890b0b64b8deb007fe3b402_icgraph.png" border="0" usemap="#amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_icgraph" id="amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_icgraph">
<area shape="rect" title="Combine collected data and queue the result." alt="" coords="243,5,435,31"/>
<area shape="rect" href="message__queue_8c.html#a4ffe60323dfa7ef4c85510e2c7e135c1" title="Run function for COLLECTING_DATA state." alt="" coords="5,5,195,31"/>
<area shape="poly" title=" " alt="" coords="229,21,195,21,195,15,229,15"/>
</map>
</div>

</div>
</div>
<a id="adca8ee032108f348cf8ea3936481854d" name="adca8ee032108f348cf8ea3936481854d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adca8ee032108f348cf8ea3936481854d">&#9670;&#160;</a></span>get_queue_usage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t get_queue_usage </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get number of messages currently in queue. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of messages in queue </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00341">341</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00657">state_operational_run()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_adca8ee032108f348cf8ea3936481854d_icgraph.png" border="0" usemap="#amessage__queue_8c_adca8ee032108f348cf8ea3936481854d_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_adca8ee032108f348cf8ea3936481854d_icgraph" id="amessage__queue_8c_adca8ee032108f348cf8ea3936481854d_icgraph">
<area shape="rect" title="Get number of messages currently in queue." alt="" coords="217,5,353,31"/>
<area shape="rect" href="message__queue_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9" title="Run function for OPERATIONAL state." alt="" coords="5,5,169,31"/>
<area shape="poly" title=" " alt="" coords="204,21,170,21,170,15,204,15"/>
</map>
</div>

</div>
</div>
<a id="a0a18dae9147827c899adc85732e672cd" name="a0a18dae9147827c899adc85732e672cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a18dae9147827c899adc85732e672cd">&#9670;&#160;</a></span>is_queue_empty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool is_queue_empty </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if queue is empty. </p>
<dl class="section return"><dt>Returns</dt><dd>true if queue is empty, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00351">351</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="ae9820326512114f9d391c41364a4a7f3" name="ae9820326512114f9d391c41364a4a7f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9820326512114f9d391c41364a4a7f3">&#9670;&#160;</a></span>K_MSGQ_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">K_MSGQ_DEFINE </td>
          <td>(</td>
          <td class="paramtype">combined_energy_msgq</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sizeof(struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a>)</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_QUEUE_SIZE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">1</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8466a00a75815de095e483573fba1617" name="a8466a00a75815de095e483573fba1617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8466a00a75815de095e483573fba1617">&#9670;&#160;</a></span>K_THREAD_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">K_THREAD_DEFINE </td>
          <td>(</td>
          <td class="paramtype">message_queue_thread_id</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_THREAD_STACK_SIZE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ab4b89d883393468f3d4629a61ed0b07a">message_queue_thread</a></td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_THREAD_PRIORITY_MESSAGE_QUEUE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00908">message_queue_thread()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a8466a00a75815de095e483573fba1617_cgraph.png" border="0" usemap="#amessage__queue_8c_a8466a00a75815de095e483573fba1617_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a8466a00a75815de095e483573fba1617_cgraph" id="amessage__queue_8c_a8466a00a75815de095e483573fba1617_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,152,56"/>
<area shape="rect" href="message__queue_8c.html#ab4b89d883393468f3d4629a61ed0b07a" title="Main message queue thread." alt="" coords="200,31,377,56"/>
<area shape="poly" title=" " alt="" coords="153,41,186,41,186,46,153,46"/>
<area shape="rect" href="app_8c.html#ad3667701d9e14f8b5fc4e3ee0131a27b" title="Watchdog timeout callback." alt="" coords="430,5,573,31"/>
<area shape="poly" title=" " alt="" coords="378,30,416,25,417,31,378,35"/>
<area shape="rect" href="task__wdt__util_8c.html#a3cd0fca4b68b6c6a7222cde37cf5b49f" title="Sets up a task watchdog channel for the calling thread." alt="" coords="425,55,577,80"/>
<area shape="poly" title=" " alt="" coords="378,51,412,55,411,60,378,56"/>
</map>
</div>

</div>
</div>
<a id="ae10632bd80814b65aeab8b546f07f0bf" name="ae10632bd80814b65aeab8b546f07f0bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae10632bd80814b65aeab8b546f07f0bf">&#9670;&#160;</a></span>K_TIMER_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">K_TIMER_DEFINE </td>
          <td>(</td>
          <td class="paramtype">collection_timer</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ab9815de4b7b6dd6a1d493fb57448a61d">collection_timeout_handler</a></td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00299">collection_timeout_handler()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ae10632bd80814b65aeab8b546f07f0bf_cgraph.png" border="0" usemap="#amessage__queue_8c_ae10632bd80814b65aeab8b546f07f0bf_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ae10632bd80814b65aeab8b546f07f0bf_cgraph" id="amessage__queue_8c_ae10632bd80814b65aeab8b546f07f0bf_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,140,38"/>
<area shape="rect" href="message__queue_8c.html#ab9815de4b7b6dd6a1d493fb57448a61d" title="Collection timeout handler." alt="" coords="188,5,331,45"/>
<area shape="poly" title=" " alt="" coords="140,23,174,23,174,28,140,28"/>
</map>
</div>

</div>
</div>
<a id="aff430b898ed92fcfcb14c01d3cc0d2c9" name="aff430b898ed92fcfcb14c01d3cc0d2c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff430b898ed92fcfcb14c01d3cc0d2c9">&#9670;&#160;</a></span>LOG_MODULE_REGISTER()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LOG_MODULE_REGISTER </td>
          <td>(</td>
          <td class="paramtype">message_queue</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_LOG_LEVEL</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4b89d883393468f3d4629a61ed0b07a" name="ab4b89d883393468f3d4629a61ed0b07a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b89d883393468f3d4629a61ed0b07a">&#9670;&#160;</a></span>message_queue_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void message_queue_thread </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main message queue thread. </p>
<p>Processes ZBUS messages, manages state machine, and feeds task watchdog. Combines P1 and Pulse data, queues messages, and sends them to cloud. </p>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00908">908</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00087">message_queue_state_object::chan</a>, <a class="el" href="message__queue_8c_source.html#l00090">message_queue_state_object::msg_buf</a>, <a class="el" href="cloud_8c_source.html#l00163">STATE_OPERATIONAL</a>, <a class="el" href="cloud_8c_source.html#l00172">states</a>, <a class="el" href="app_8c_source.html#l00063">task_wdt_callback()</a>, and <a class="el" href="task__wdt__util_8c_source.html#l00016">task_wdt_util_setup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="#a8466a00a75815de095e483573fba1617">K_THREAD_DEFINE()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_cgraph.png" border="0" usemap="#amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_cgraph" id="amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_cgraph">
<area shape="rect" title="Main message queue thread." alt="" coords="5,31,183,56"/>
<area shape="rect" href="app_8c.html#ad3667701d9e14f8b5fc4e3ee0131a27b" title="Watchdog timeout callback." alt="" coords="235,5,378,31"/>
<area shape="poly" title=" " alt="" coords="183,30,221,25,222,31,183,35"/>
<area shape="rect" href="task__wdt__util_8c.html#a3cd0fca4b68b6c6a7222cde37cf5b49f" title="Sets up a task watchdog channel for the calling thread." alt="" coords="231,55,383,80"/>
<area shape="poly" title=" " alt="" coords="183,51,217,55,217,60,183,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_icgraph.png" border="0" usemap="#amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_icgraph" id="amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_icgraph">
<area shape="rect" title="Main message queue thread." alt="" coords="200,5,377,31"/>
<area shape="rect" href="message__queue_8c.html#a8466a00a75815de095e483573fba1617" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,152,21,152,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="af7e68654facf8babc9920ba337d98b3f" name="af7e68654facf8babc9920ba337d98b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7e68654facf8babc9920ba337d98b3f">&#9670;&#160;</a></span>queue_combined_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int queue_combined_message </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queue a combined energy message with FIFO drop-oldest strategy. </p>
<p>If queue is full, drops the oldest message to make room for new one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Combined energy message to queue </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00364">364</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue__zbus_8h_source.html#l00037">combined_energy_msg::timestamp</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00237">combine_and_queue_data()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_af7e68654facf8babc9920ba337d98b3f_icgraph.png" border="0" usemap="#amessage__queue_8c_af7e68654facf8babc9920ba337d98b3f_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_af7e68654facf8babc9920ba337d98b3f_icgraph" id="amessage__queue_8c_af7e68654facf8babc9920ba337d98b3f_icgraph">
<area shape="rect" title="Queue a combined energy message with FIFO drop&#45;oldest strategy." alt="" coords="483,5,681,31"/>
<area shape="rect" href="message__queue_8c.html#a6150572ae890b0b64b8deb007fe3b402" title="Combine collected data and queue the result." alt="" coords="243,5,435,31"/>
<area shape="poly" title=" " alt="" coords="469,21,435,21,435,15,469,15"/>
<area shape="rect" href="message__queue_8c.html#a4ffe60323dfa7ef4c85510e2c7e135c1" title="Run function for COLLECTING_DATA state." alt="" coords="5,5,195,31"/>
<area shape="poly" title=" " alt="" coords="229,21,195,21,195,15,229,15"/>
</map>
</div>

</div>
</div>
<a id="a69e0516026a9b9eef40a8cc1919d9e4d" name="a69e0516026a9b9eef40a8cc1919d9e4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69e0516026a9b9eef40a8cc1919d9e4d">&#9670;&#160;</a></span>state_collecting_data_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_collecting_data_entry </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entry function for COLLECTING_DATA state. </p>
<p>Starts the collection window and timer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00707">707</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="#a2d5e02455d1f14bb83db9571fdf67bd2">collected_p1</a>, <a class="el" href="#a2857022b6a6f199a8f0ac696dd4381ef">collected_pulse</a>, <a class="el" href="message__queue_8c_source.html#l00164">collection_timeout_expired</a>, and <a class="el" href="message__queue_8c_source.html#l00176">COLLECTION_TIMEOUT_MS</a>.</p>

</div>
</div>
<a id="a4ffe60323dfa7ef4c85510e2c7e135c1" name="a4ffe60323dfa7ef4c85510e2c7e135c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ffe60323dfa7ef4c85510e2c7e135c1">&#9670;&#160;</a></span>state_collecting_data_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_collecting_data_run </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run function for COLLECTING_DATA state. </p>
<p>Collects P1 and Pulse data. When both received or timeout occurs, combines and queues the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00730">730</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00087">message_queue_state_object::chan</a>, <a class="el" href="#a2d5e02455d1f14bb83db9571fdf67bd2">collected_p1</a>, <a class="el" href="#a2857022b6a6f199a8f0ac696dd4381ef">collected_pulse</a>, <a class="el" href="message__queue_8c_source.html#l00164">collection_timeout_expired</a>, <a class="el" href="message__queue_8c_source.html#l00237">combine_and_queue_data()</a>, <a class="el" href="message__queue_8c_source.html#l00090">message_queue_state_object::msg_buf</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00024">MSG_TO_ENERGY_PULSE_MSG_PTR</a>, <a class="el" href="p__one__zbus_8h_source.html#l00023">MSG_TO_P_ONE_MSG_PTR</a>, <a class="el" href="cloud_8c_source.html#l00163">STATE_OPERATIONAL</a>, and <a class="el" href="cloud_8c_source.html#l00172">states</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a4ffe60323dfa7ef4c85510e2c7e135c1_cgraph.png" border="0" usemap="#amessage__queue_8c_a4ffe60323dfa7ef4c85510e2c7e135c1_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a4ffe60323dfa7ef4c85510e2c7e135c1_cgraph" id="amessage__queue_8c_a4ffe60323dfa7ef4c85510e2c7e135c1_cgraph">
<area shape="rect" title="Run function for COLLECTING_DATA state." alt="" coords="5,5,195,31"/>
<area shape="rect" href="message__queue_8c.html#a6150572ae890b0b64b8deb007fe3b402" title="Combine collected data and queue the result." alt="" coords="243,5,435,31"/>
<area shape="poly" title=" " alt="" coords="195,15,229,15,229,21,195,21"/>
<area shape="rect" href="message__queue_8c.html#af7e68654facf8babc9920ba337d98b3f" title="Queue a combined energy message with FIFO drop&#45;oldest strategy." alt="" coords="483,5,681,31"/>
<area shape="poly" title=" " alt="" coords="435,15,469,15,469,21,435,21"/>
</map>
</div>

</div>
</div>
<a id="a1960ea4ac2008ab8f4cab1059ab651ac" name="a1960ea4ac2008ab8f4cab1059ab651ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1960ea4ac2008ab8f4cab1059ab651ac">&#9670;&#160;</a></span>state_operational_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_operational_entry </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entry function for OPERATIONAL state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00642">642</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a5894fe4ced254ada1ff0ec62e8c3dab9" name="a5894fe4ced254ada1ff0ec62e8c3dab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5894fe4ced254ada1ff0ec62e8c3dab9">&#9670;&#160;</a></span>state_operational_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_operational_run </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run function for OPERATIONAL state. </p>
<p>Waits for DATA_PUBLISH_REQUEST to start data collection. Cloud status is tracked but doesn't block data collection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00657">657</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00087">message_queue_state_object::chan</a>, <a class="el" href="message__queue_8c_source.html#l00341">get_queue_usage()</a>, <a class="el" href="message__queue_8c_source.html#l00167">is_cloud_ready</a>, <a class="el" href="message__queue_8c_source.html#l00090">message_queue_state_object::msg_buf</a>, <a class="el" href="cloud__zbus_8h_source.html#l00024">MSG_TO_CLOUD_MSG_PTR</a>, <a class="el" href="message__queue_8c_source.html#l00077">STATE_COLLECTING_DATA</a>, <a class="el" href="message__queue_8c_source.html#l00078">STATE_SEND_MSG_ATTEMPT</a>, <a class="el" href="cloud_8c_source.html#l00172">states</a>, and <a class="el" href="message__queue_8c_source.html#l00314">update_cloud_status()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a5894fe4ced254ada1ff0ec62e8c3dab9_cgraph.png" border="0" usemap="#amessage__queue_8c_a5894fe4ced254ada1ff0ec62e8c3dab9_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a5894fe4ced254ada1ff0ec62e8c3dab9_cgraph" id="amessage__queue_8c_a5894fe4ced254ada1ff0ec62e8c3dab9_cgraph">
<area shape="rect" title="Run function for OPERATIONAL state." alt="" coords="5,31,169,56"/>
<area shape="rect" href="message__queue_8c.html#adca8ee032108f348cf8ea3936481854d" title="Get number of messages currently in queue." alt="" coords="227,5,363,31"/>
<area shape="poly" title=" " alt="" coords="169,31,213,25,214,31,170,36"/>
<area shape="rect" href="message__queue_8c.html#a97890684bfa65f65e530be570155ef6e" title="Update cloud readiness status." alt="" coords="217,55,373,80"/>
<area shape="poly" title=" " alt="" coords="170,50,204,54,203,59,170,55"/>
<area shape="rect" href="group__cloud.html#gab80e1b04abd5e0e4e2664f8fc1969627" title=" " alt="" coords="421,55,540,80"/>
<area shape="poly" title=" " alt="" coords="374,65,407,65,407,70,374,70"/>
</map>
</div>

</div>
</div>
<a id="a38cb2a08ca66bebc3fa27058d4cfd91f" name="a38cb2a08ca66bebc3fa27058d4cfd91f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38cb2a08ca66bebc3fa27058d4cfd91f">&#9670;&#160;</a></span>state_send_msg_attempt_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_send_msg_attempt_entry </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entry function for SEND_MSG_ATTEMPT state. </p>
<p>Attempts to send as many queued messages as possible to the cloud. Runs in entry function only - immediately transitions back to OPERATIONAL.</p>
<p>Strategy:</p><ul>
<li>Double-check cloud readiness (defense in depth)</li>
<li>Send up to MAX_MSGS_PER_CYCLE messages</li>
<li>Stop on first error (queue remains intact)</li>
<li>Always return to OPERATIONAL (never block)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00815">815</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00420">build_combined_energy_json()</a>, <a class="el" href="message__queue_8c_source.html#l00167">is_cloud_ready</a>, <a class="el" href="#a2c8e46d63c3681faca97c3341bd2af97">MAX_MSGS_PER_CYCLE</a>, <a class="el" href="cloud_8c_source.html#l00163">STATE_OPERATIONAL</a>, <a class="el" href="cloud_8c_source.html#l00172">states</a>, and <a class="el" href="message__queue__zbus_8h_source.html#l00037">combined_energy_msg::timestamp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a38cb2a08ca66bebc3fa27058d4cfd91f_cgraph.png" border="0" usemap="#amessage__queue_8c_a38cb2a08ca66bebc3fa27058d4cfd91f_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a38cb2a08ca66bebc3fa27058d4cfd91f_cgraph" id="amessage__queue_8c_a38cb2a08ca66bebc3fa27058d4cfd91f_cgraph">
<area shape="rect" title="Entry function for SEND_MSG_ATTEMPT state." alt="" coords="5,5,192,45"/>
<area shape="rect" href="message__queue_8c.html#a16e0c8c199c4c428750fd989c79f437b" title="Build nRF Cloud JSON object from combined energy message." alt="" coords="240,13,451,38"/>
<area shape="poly" title=" " alt="" coords="192,23,226,23,226,28,192,28"/>
</map>
</div>

</div>
</div>
<a id="ad3667701d9e14f8b5fc4e3ee0131a27b" name="ad3667701d9e14f8b5fc4e3ee0131a27b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3667701d9e14f8b5fc4e3ee0131a27b">&#9670;&#160;</a></span>task_wdt_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void task_wdt_callback </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>channel_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>user_data</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Task watchdog timeout callback. </p>
<p>Called when the task watchdog times out. Requests a system reboot to recover from the watchdog timeout condition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel_id</td><td>Task watchdog channel ID </td></tr>
    <tr><td class="paramname">user_data</td><td>User data (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00206">206</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a97890684bfa65f65e530be570155ef6e" name="a97890684bfa65f65e530be570155ef6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97890684bfa65f65e530be570155ef6e">&#9670;&#160;</a></span>update_cloud_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void update_cloud_status </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcloud__msg.html">cloud_msg</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update cloud readiness status. </p>
<p>Tracks changes in cloud connection state and logs transitions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Cloud status message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00314">314</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="cloud__zbus_8h_source.html#l00048">cloud_is_ready()</a>, and <a class="el" href="message__queue_8c_source.html#l00167">is_cloud_ready</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00657">state_operational_run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a97890684bfa65f65e530be570155ef6e_cgraph.png" border="0" usemap="#amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_cgraph" id="amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_cgraph">
<area shape="rect" title="Update cloud readiness status." alt="" coords="5,5,161,31"/>
<area shape="rect" href="group__cloud.html#gab80e1b04abd5e0e4e2664f8fc1969627" title=" " alt="" coords="209,5,328,31"/>
<area shape="poly" title=" " alt="" coords="162,15,195,15,195,21,162,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a97890684bfa65f65e530be570155ef6e_icgraph.png" border="0" usemap="#amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_icgraph" id="amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_icgraph">
<area shape="rect" title="Update cloud readiness status." alt="" coords="217,5,373,31"/>
<area shape="rect" href="message__queue_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9" title="Run function for OPERATIONAL state." alt="" coords="5,5,169,31"/>
<area shape="poly" title=" " alt="" coords="203,21,170,21,170,15,203,15"/>
</map>
</div>

</div>
</div>
<a id="a59a0d14215c57cca3cc579702c365566" name="a59a0d14215c57cca3cc579702c365566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a0d14215c57cca3cc579702c365566">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">CLOUD_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="cloud_8c_source.html#l00073">ADD_OBSERVERS</a>.</p>

</div>
</div>
<a id="a4de0aa1fcbf51a587a3ab462c1326ecb" name="a4de0aa1fcbf51a587a3ab462c1326ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4de0aa1fcbf51a587a3ab462c1326ecb">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">DATA_PUBLISH_REQUEST_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac86772b6559cbc5ca3de13e0a2091fb1" name="ac86772b6559cbc5ca3de13e0a2091fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac86772b6559cbc5ca3de13e0a2091fb1">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">DATA_SEND_REQUEST_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e9a50628d2d7e871721c130837b3943" name="a2e9a50628d2d7e871721c130837b3943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9a50628d2d7e871721c130837b3943">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">ENERGY_PULSE_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a67ac4f6e77aa428626bd119ed894eaeb" name="a67ac4f6e77aa428626bd119ed894eaeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67ac4f6e77aa428626bd119ed894eaeb">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">P_ONE_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0e845823aaacc286f3e8c0aaf560c98b" name="a0e845823aaacc286f3e8c0aaf560c98b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e845823aaacc286f3e8c0aaf560c98b">&#9670;&#160;</a></span>ZBUS_MSG_SUBSCRIBER_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_MSG_SUBSCRIBER_DEFINE </td>
          <td>(</td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a2d5e02455d1f14bb83db9571fdf67bd2" name="a2d5e02455d1f14bb83db9571fdf67bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d5e02455d1f14bb83db9571fdf67bd2">&#9670;&#160;</a></span>[struct]</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct  { ... }  collected_p1</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .has_data = <span class="keyword">false</span>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00237">combine_and_queue_data()</a>, <a class="el" href="message__queue_8c_source.html#l00707">state_collecting_data_entry()</a>, and <a class="el" href="message__queue_8c_source.html#l00730">state_collecting_data_run()</a>.</p>

</div>
</div>
<a id="a2857022b6a6f199a8f0ac696dd4381ef" name="a2857022b6a6f199a8f0ac696dd4381ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2857022b6a6f199a8f0ac696dd4381ef">&#9670;&#160;</a></span>[struct]</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct  { ... }  collected_pulse</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .has_data = <span class="keyword">false</span>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00237">combine_and_queue_data()</a>, <a class="el" href="message__queue_8c_source.html#l00707">state_collecting_data_entry()</a>, and <a class="el" href="message__queue_8c_source.html#l00730">state_collecting_data_run()</a>.</p>

</div>
</div>
<a id="a46c0c7b465fa0f91ab3e2b5cfa3b09c4" name="a46c0c7b465fa0f91ab3e2b5cfa3b09c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46c0c7b465fa0f91ab3e2b5cfa3b09c4">&#9670;&#160;</a></span>collection_timeout_expired</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool collection_timeout_expired = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00164">164</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00299">collection_timeout_handler()</a>, <a class="el" href="message__queue_8c_source.html#l00707">state_collecting_data_entry()</a>, and <a class="el" href="message__queue_8c_source.html#l00730">state_collecting_data_run()</a>.</p>

</div>
</div>
<a id="afe1b4b4eb80224902d335e63ace502af" name="afe1b4b4eb80224902d335e63ace502af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe1b4b4eb80224902d335e63ace502af">&#9670;&#160;</a></span>data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structenergy__pulse__msg.html">energy_pulse_msg</a> data</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00151">151</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="p__one_8c_source.html#l01213">uart_event_handler()</a>.</p>

</div>
</div>
<a id="a6a0e977ab733be8d10cfdeabb12314b4" name="a6a0e977ab733be8d10cfdeabb12314b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a0e977ab733be8d10cfdeabb12314b4">&#9670;&#160;</a></span>has_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool has_data</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00150">150</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a6f1182cd9184295f68d09c18dc04ba36" name="a6f1182cd9184295f68d09c18dc04ba36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f1182cd9184295f68d09c18dc04ba36">&#9670;&#160;</a></span>is_cloud_ready</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool is_cloud_ready = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00167">167</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00657">state_operational_run()</a>, <a class="el" href="message__queue_8c_source.html#l00815">state_send_msg_attempt_entry()</a>, and <a class="el" href="message__queue_8c_source.html#l00314">update_cloud_status()</a>.</p>

</div>
</div>
<a id="a693d2ea076d2873522108af791cbf451" name="a693d2ea076d2873522108af791cbf451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a693d2ea076d2873522108af791cbf451">&#9670;&#160;</a></span>states</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct smf_state states[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    </div>
<div class="line">    [<a class="code hl_enumvalue" href="cloud_8c.html#a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a>] = SMF_CREATE_STATE(</div>
<div class="line">            <a class="code hl_function" href="cloud_8c.html#a1960ea4ac2008ab8f4cab1059ab651ac">state_operational_entry</a>, <a class="code hl_function" href="cloud_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9">state_operational_run</a>, NULL,</div>
<div class="line">            NULL, </div>
<div class="line">            NULL), </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    [<a class="code hl_enumvalue" href="#ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66">STATE_COLLECTING_DATA</a>] = SMF_CREATE_STATE(</div>
<div class="line">            <a class="code hl_function" href="#a69e0516026a9b9eef40a8cc1919d9e4d">state_collecting_data_entry</a>, <a class="code hl_function" href="#a4ffe60323dfa7ef4c85510e2c7e135c1">state_collecting_data_run</a>, NULL,</div>
<div class="line">            &amp;<a class="code hl_variable" href="cloud_8c.html#a693d2ea076d2873522108af791cbf451">states</a>[<a class="code hl_enumvalue" href="cloud_8c.html#a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a>], </div>
<div class="line">            NULL), </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    [<a class="code hl_enumvalue" href="#ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4">STATE_SEND_MSG_ATTEMPT</a>] = SMF_CREATE_STATE(</div>
<div class="line">            <a class="code hl_function" href="#a38cb2a08ca66bebc3fa27058d4cfd91f">state_send_msg_attempt_entry</a>, NULL, NULL,</div>
<div class="line">            &amp;<a class="code hl_variable" href="cloud_8c.html#a693d2ea076d2873522108af791cbf451">states</a>[<a class="code hl_enumvalue" href="cloud_8c.html#a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a>], </div>
<div class="line">            NULL), </div>
<div class="line">}</div>
<div class="ttc" id="acloud_8c_html_a1960ea4ac2008ab8f4cab1059ab651ac"><div class="ttname"><a href="cloud_8c.html#a1960ea4ac2008ab8f4cab1059ab651ac">state_operational_entry</a></div><div class="ttdeci">static void state_operational_entry(void *o)</div><div class="ttdef"><b>Definition</b> <a href="cloud_8c_source.html#l00652">cloud.c:652</a></div></div>
<div class="ttc" id="acloud_8c_html_a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d"><div class="ttname"><a href="cloud_8c.html#a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a></div><div class="ttdeci">@ STATE_OPERATIONAL</div><div class="ttdef"><b>Definition</b> <a href="cloud_8c_source.html#l00163">cloud.c:163</a></div></div>
<div class="ttc" id="acloud_8c_html_a5894fe4ced254ada1ff0ec62e8c3dab9"><div class="ttname"><a href="cloud_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9">state_operational_run</a></div><div class="ttdeci">static void state_operational_run(void *o)</div><div class="ttdef"><b>Definition</b> <a href="cloud_8c_source.html#l00665">cloud.c:665</a></div></div>
<div class="ttc" id="acloud_8c_html_a693d2ea076d2873522108af791cbf451"><div class="ttname"><a href="cloud_8c.html#a693d2ea076d2873522108af791cbf451">states</a></div><div class="ttdeci">static const struct smf_state states[]</div><div class="ttdef"><b>Definition</b> <a href="cloud_8c_source.html#l00172">cloud.c:172</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_a38cb2a08ca66bebc3fa27058d4cfd91f"><div class="ttname"><a href="#a38cb2a08ca66bebc3fa27058d4cfd91f">state_send_msg_attempt_entry</a></div><div class="ttdeci">static void state_send_msg_attempt_entry(void *o)</div><div class="ttdoc">Entry function for SEND_MSG_ATTEMPT state.</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00815">message_queue.c:815</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_a4ffe60323dfa7ef4c85510e2c7e135c1"><div class="ttname"><a href="#a4ffe60323dfa7ef4c85510e2c7e135c1">state_collecting_data_run</a></div><div class="ttdeci">static void state_collecting_data_run(void *o)</div><div class="ttdoc">Run function for COLLECTING_DATA state.</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00730">message_queue.c:730</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_a69e0516026a9b9eef40a8cc1919d9e4d"><div class="ttname"><a href="#a69e0516026a9b9eef40a8cc1919d9e4d">state_collecting_data_entry</a></div><div class="ttdeci">static void state_collecting_data_entry(void *o)</div><div class="ttdoc">Entry function for COLLECTING_DATA state.</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00707">message_queue.c:707</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66"><div class="ttname"><a href="#ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66">STATE_COLLECTING_DATA</a></div><div class="ttdeci">@ STATE_COLLECTING_DATA</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00077">message_queue.c:77</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4"><div class="ttname"><a href="#ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4">STATE_SEND_MSG_ATTEMPT</a></div><div class="ttdeci">@ STATE_SEND_MSG_ATTEMPT</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00078">message_queue.c:78</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00122">122</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_1b41d3a148801ef4e2f0892bc9eecc7e.html">modules</a></li><li class="navelem"><a href="dir_3477fc06a3faf73386151e62e3f50933.html">message_queue</a></li><li class="navelem"><a href="message__queue_8c.html">message_queue.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
