<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="dark-mode">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="SolarResult Dinnis Core API Documentation" />
<meta property="og:description" content="API documentation for SolarResult Dinnis Core - IoT firmware for smart meter gateway device built with Zephyr RTOS on Nordic nRF9161" />
<!-- END opengraph metadata -->
<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="solar_result_white.svg">
<title>SolarResult Dinnis Core: modules/message_queue/message_queue.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    // Initialize Doxygen Awesome features (dark mode only, no toggle)
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="solar_result_white.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SolarResult Dinnis Core
   </div>
   <div id="projectbrief">Dinnis Rev1.0.0 Firmware - IoT Gateway for DSMR P1 Smart Meters</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('message__queue_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">message_queue.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;zephyr/kernel.h&gt;</code><br />
<code>#include &lt;zephyr/logging/log.h&gt;</code><br />
<code>#include &lt;zephyr/smf.h&gt;</code><br />
<code>#include &lt;zephyr/sys/reboot.h&gt;</code><br />
<code>#include &lt;zephyr/task_wdt/task_wdt.h&gt;</code><br />
<code>#include &lt;zephyr/zbus/zbus.h&gt;</code><br />
<code>#include &lt;net/nrf_cloud.h&gt;</code><br />
<code>#include &lt;net/nrf_cloud_codec.h&gt;</code><br />
<code>#include &lt;net/nrf_cloud_defs.h&gt;</code><br />
<code>#include &lt;modem/lte_lc.h&gt;</code><br />
<code>#include &lt;date_time.h&gt;</code><br />
<code>#include &quot;<a class="el" href="cloud__zbus_8h_source.html">cloud_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="energy__pulse__zbus_8h_source.html">energy_pulse_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="message__queue__zbus_8h_source.html">message_queue_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="modules__common_8h_source.html">modules_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="network__zbus_8h_source.html">network_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p__one__zbus_8h_source.html">p_one_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="reboot__zbus_8h_source.html">reboot_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="task__wdt__util_8h_source.html">task_wdt_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timing__zbus_8h_source.html">timing_zbus.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for message_queue.c:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c__incl.png" border="0" usemap="#amodules_2message__queue_2message__queue_8c" loading="lazy" alt=""/></div>
<map name="amodules_2message__queue_2message__queue_8c" id="amodules_2message__queue_2message__queue_8c">
<area shape="rect" title=" " alt="" coords="1063,5,1251,45"/>
<area shape="rect" title=" " alt="" coords="917,255,1039,280"/>
<area shape="poly" title=" " alt="" coords="1063,28,803,29,478,37,322,45,186,57,84,74,50,84,29,95,17,110,14,126,14,167,9,189,9,197,13,205,25,210,50,216,133,226,386,243,903,262,903,267,385,248,132,231,49,221,23,215,10,209,3,198,4,188,9,166,9,125,12,108,26,91,48,79,83,69,186,52,321,40,478,31,803,24,1063,23"/>
<area shape="rect" title=" " alt="" coords="281,174,435,199"/>
<area shape="poly" title=" " alt="" coords="1063,31,878,36,660,47,558,56,470,66,405,80,384,87,371,95,361,109,356,126,356,160,351,160,351,125,356,107,367,91,381,82,404,75,470,61,557,50,660,42,877,31,1063,25"/>
<area shape="rect" title=" " alt="" coords="51,93,158,119"/>
<area shape="poly" title=" " alt="" coords="1063,33,674,52,424,71,172,96,171,96,171,91,171,91,423,65,673,47,1063,27"/>
<area shape="rect" title=" " alt="" coords="775,174,925,199"/>
<area shape="poly" title=" " alt="" coords="1222,43,1256,57,1283,74,1292,85,1297,96,1297,108,1289,120,1264,139,1227,151,1182,158,1133,162,1035,165,960,169,929,174,928,169,959,164,1035,159,1133,157,1181,153,1225,145,1261,134,1285,117,1292,106,1292,97,1288,88,1280,79,1253,62,1220,48"/>
<area shape="rect" title=" " alt="" coords="23,167,184,207"/>
<area shape="poly" title=" " alt="" coords="1063,31,797,39,466,52,177,71,83,83,55,89,41,95,35,109,39,125,50,141,67,156,63,160,46,145,34,127,30,109,38,91,53,84,82,78,177,66,465,47,797,34,1062,26"/>
<area shape="rect" title=" " alt="" coords="1421,255,1567,280"/>
<area shape="poly" title=" " alt="" coords="1252,32,1441,54,1530,71,1592,91,1620,105,1641,120,1657,138,1671,166,1678,187,1671,208,1653,228,1631,242,1582,260,1580,255,1628,238,1649,224,1667,205,1673,187,1666,168,1653,141,1637,123,1617,110,1590,96,1528,76,1440,60,1251,37"/>
<area shape="rect" title=" " alt="" coords="517,93,636,119"/>
<area shape="poly" title=" " alt="" coords="1063,41,650,96,649,91,1062,36"/>
<area shape="rect" title=" " alt="" coords="660,93,824,119"/>
<area shape="poly" title=" " alt="" coords="1063,47,816,93,815,88,1062,42"/>
<area shape="rect" title=" " alt="" coords="849,93,1003,119"/>
<area shape="poly" title=" " alt="" coords="1102,48,974,91,972,86,1101,43"/>
<area shape="rect" title=" " alt="" coords="1027,93,1150,119"/>
<area shape="poly" title=" " alt="" coords="1142,47,1110,84,1106,81,1138,44"/>
<area shape="rect" title=" " alt="" coords="1175,93,1275,119"/>
<area shape="poly" title=" " alt="" coords="1175,44,1208,81,1204,84,1171,47"/>
<area shape="rect" href="cloud__zbus_8h.html" title=" " alt="" coords="1218,174,1325,199"/>
<area shape="poly" title=" " alt="" coords="1251,28,1328,35,1408,47,1476,65,1501,77,1519,91,1547,118,1569,130,1578,133,1578,134,1558,132,1515,133,1443,144,1339,169,1326,173,1324,168,1337,164,1442,139,1514,128,1559,126,1581,130,1583,136,1567,135,1544,122,1515,95,1498,82,1474,70,1406,52,1328,40,1251,33"/>
<area shape="rect" href="energy__pulse__zbus_8h.html" title=" " alt="" coords="1497,174,1656,199"/>
<area shape="poly" title=" " alt="" coords="1251,26,1340,32,1434,44,1516,63,1548,76,1569,92,1580,107,1584,125,1584,161,1579,161,1579,126,1575,109,1566,95,1545,80,1515,68,1433,49,1340,38,1251,32"/>
<area shape="rect" href="message__queue__zbus_8h.html" title=" " alt="" coords="1823,93,2000,119"/>
<area shape="poly" title=" " alt="" coords="1251,34,1810,91,1809,97,1251,39"/>
<area shape="rect" href="p__one__zbus_8h.html" title=" " alt="" coords="2028,174,2139,199"/>
<area shape="poly" title=" " alt="" coords="1251,27,1449,35,1686,48,1896,67,1970,78,2014,91,2034,105,2051,123,2075,160,2070,163,2047,127,2030,109,2012,96,1969,83,1895,72,1685,54,1449,40,1251,32"/>
<area shape="rect" href="modules__common_8h.html" title=" " alt="" coords="1350,93,1505,119"/>
<area shape="poly" title=" " alt="" coords="1222,43,1376,87,1374,92,1221,48"/>
<area shape="rect" href="network__zbus_8h.html" title=" " alt="" coords="1349,174,1473,199"/>
<area shape="poly" title=" " alt="" coords="1251,27,1336,33,1424,44,1500,63,1528,76,1548,92,1556,105,1556,118,1549,130,1538,140,1507,158,1471,172,1469,167,1505,153,1535,136,1545,127,1550,117,1550,106,1544,95,1526,80,1498,68,1423,49,1335,38,1251,32"/>
<area shape="rect" href="reboot__zbus_8h.html" title=" " alt="" coords="380,93,493,119"/>
<area shape="poly" title=" " alt="" coords="1063,37,816,60,507,96,507,91,815,55,1062,32"/>
<area shape="rect" href="task__wdt__util_8h.html" title=" " alt="" coords="183,93,304,119"/>
<area shape="poly" title=" " alt="" coords="1062,35,735,58,324,96,318,97,317,91,323,91,735,53,1062,30"/>
<area shape="rect" href="timing__zbus_8h.html" title=" " alt="" coords="1732,174,1845,199"/>
<area shape="poly" title=" " alt="" coords="1251,27,1370,33,1505,45,1628,64,1677,76,1714,91,1735,106,1753,124,1779,160,1774,163,1748,127,1731,110,1712,96,1676,81,1627,69,1504,50,1370,39,1251,32"/>
<area shape="poly" title=" " alt="" coords="1233,202,1207,209,1037,254,1036,249,1205,204,1231,197"/>
<area shape="poly" title=" " alt="" coords="1305,197,1450,248,1448,253,1303,202"/>
<area shape="poly" title=" " alt="" coords="1526,202,1487,209,1250,241,1054,262,1053,257,1249,236,1486,204,1525,197"/>
<area shape="poly" title=" " alt="" coords="1566,201,1518,247,1514,243,1563,198"/>
<area shape="poly" title=" " alt="" coords="1863,121,1639,173,1638,168,1862,116"/>
<area shape="rect" title=" " alt="" coords="1870,174,1953,199"/>
<area shape="poly" title=" " alt="" coords="1914,119,1914,160,1909,160,1909,119"/>
<area shape="rect" title=" " alt="" coords="1955,255,2025,280"/>
<area shape="poly" title=" " alt="" coords="1927,117,1948,138,1967,165,1982,204,1990,240,1985,242,1977,206,1962,168,1944,141,1923,121"/>
<area shape="poly" title=" " alt="" coords="1938,116,2047,166,2045,171,1935,121"/>
<area shape="poly" title=" " alt="" coords="2071,202,2016,248,2013,244,2068,197"/>
<area shape="poly" title=" " alt="" coords="1350,119,1138,145,1048,158,1006,169,994,184,986,203,980,241,975,240,981,201,990,181,1003,164,1047,153,1137,140,1350,113"/>
<area shape="rect" title=" " alt="" coords="1016,174,1193,199"/>
<area shape="poly" title=" " alt="" coords="1381,121,1166,173,1164,168,1380,116"/>
<area shape="poly" title=" " alt="" coords="1369,202,1337,209,1186,237,1054,258,1053,253,1186,232,1336,204,1368,197"/>
<area shape="poly" title=" " alt="" coords="1425,198,1474,243,1470,247,1422,201"/>
<area shape="poly" title=" " alt="" coords="443,118,463,162,479,185,501,204,532,218,574,230,682,247,800,257,903,262,903,267,799,262,681,252,573,235,530,223,498,209,475,189,458,164,438,120"/>
<area shape="poly" title=" " alt="" coords="427,121,381,166,378,162,423,117"/>
<area shape="poly" title=" " alt="" coords="494,115,777,169,776,174,493,121"/>
<area shape="poly" title=" " alt="" coords="490,116,574,137,667,164,715,186,736,195,764,204,892,224,1068,240,1407,260,1407,265,1068,245,891,229,763,209,734,200,713,191,665,169,572,142,489,121"/>
<area shape="rect" title=" " alt="" coords="511,167,653,207"/>
<area shape="poly" title=" " alt="" coords="459,116,536,158,534,162,457,121"/>
<area shape="poly" title=" " alt="" coords="245,119,248,162,256,185,270,205,303,218,364,230,539,247,738,257,903,262,903,267,738,262,539,252,363,235,302,223,267,209,251,188,243,163,240,119"/>
<area shape="poly" title=" " alt="" coords="224,121,150,162,148,158,222,117"/>
<area shape="poly" title=" " alt="" coords="1747,202,1551,254,1549,249,1745,197"/>
<area shape="poly" title=" " alt="" coords="1819,197,1949,247,1947,252,1817,202"/>
</map>
</div>
</div>
<p><a href="message__queue_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:message_5Fqueue_5Fstate_5Fobject" id="r_message_5Fqueue_5Fstate_5Fobject"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmessage__queue__state__object.html">message_queue_state_object</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3b5933d01a8c2ba7a93b5e6aa71593b8" id="r_a3b5933d01a8c2ba7a93b5e6aa71593b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>(X)</td></tr>
<tr class="memitem:a17e333794ae761cd55ec6fd6fc0f1bac" id="r_a17e333794ae761cd55ec6fd6fc0f1bac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17e333794ae761cd55ec6fd6fc0f1bac">MAX_MSG_SIZE</a>&#160;&#160;&#160;<a class="el" href="modules__common_8h.html#ae3900a89ee01727e706bded5fb7e0d11">MAX_MSG_SIZE_FROM_LIST</a>(<a class="el" href="cloud_8c.html#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>)</td></tr>
<tr class="memitem:a848ed8b7e0fb0c3ef37659dd114b7a48" id="r_a848ed8b7e0fb0c3ef37659dd114b7a48"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a848ed8b7e0fb0c3ef37659dd114b7a48">ADD_OBSERVERS</a>(_chan,  _type)</td></tr>
<tr class="memitem:a1ef2a6d3dd301f109fc0d273f1a3605c" id="r_a1ef2a6d3dd301f109fc0d273f1a3605c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ef2a6d3dd301f109fc0d273f1a3605c">TIME_RESYNC_INTERVAL_MS</a>&#160;&#160;&#160;(6 * 60 * 60 * 1000)</td></tr>
<tr class="memitem:a7ebddf689a7814bf99a483ee93342257" id="r_a7ebddf689a7814bf99a483ee93342257"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ebddf689a7814bf99a483ee93342257">COLLECTION_TIMEOUT_MS</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memitem:a2c8e46d63c3681faca97c3341bd2af97" id="r_a2c8e46d63c3681faca97c3341bd2af97"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c8e46d63c3681faca97c3341bd2af97">MAX_MSGS_PER_CYCLE</a>&#160;&#160;&#160;10</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-enum-members" class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ac36eaccb444831fdf2690af621237d3e" id="r_ac36eaccb444831fdf2690af621237d3e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac36eaccb444831fdf2690af621237d3e">message_queue_state</a> { <br />
&#160;&#160;<a class="el" href="#ac36eaccb444831fdf2690af621237d3eae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a>
, <br />
&#160;&#160;<a class="el" href="#ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66">STATE_COLLECTING_DATA</a>
, <br />
&#160;&#160;<a class="el" href="#ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4">STATE_SEND_MSG_ATTEMPT</a>
<br />
 }</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aff430b898ed92fcfcb14c01d3cc0d2c9" id="r_aff430b898ed92fcfcb14c01d3cc0d2c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff430b898ed92fcfcb14c01d3cc0d2c9">LOG_MODULE_REGISTER</a> (message_queue, CONFIG_APP_MESSAGE_QUEUE_MODULE_LOG_LEVEL)</td></tr>
<tr class="memitem:af2a996a587e51f1c9bae9e4d484afc61" id="r_af2a996a587e51f1c9bae9e4d484afc61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2a996a587e51f1c9bae9e4d484afc61">BUILD_ASSERT</a> (CONFIG_APP_MESSAGE_QUEUE_MODULE_WATCHDOG_TIMEOUT_SECONDS &gt; CONFIG_APP_MESSAGE_QUEUE_MODULE_MSG_PROCESSING_TIME_SECONDS, &quot;Watchdog timeout must be greater than message processing time&quot;)</td></tr>
<tr class="memitem:a0e845823aaacc286f3e8c0aaf560c98b" id="r_a0e845823aaacc286f3e8c0aaf560c98b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e845823aaacc286f3e8c0aaf560c98b">ZBUS_MSG_SUBSCRIBER_DEFINE</a> (message_queue_subscriber)</td></tr>
<tr class="memitem:a59a0d14215c57cca3cc579702c365566" id="r_a59a0d14215c57cca3cc579702c365566"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59a0d14215c57cca3cc579702c365566">ZBUS_CHAN_ADD_OBS</a> (CLOUD_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a6db0aaf3f527f3a02b1a6fcd62f57293" id="r_a6db0aaf3f527f3a02b1a6fcd62f57293"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6db0aaf3f527f3a02b1a6fcd62f57293">ZBUS_CHAN_ADD_OBS</a> (NETWORK_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a67ac4f6e77aa428626bd119ed894eaeb" id="r_a67ac4f6e77aa428626bd119ed894eaeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67ac4f6e77aa428626bd119ed894eaeb">ZBUS_CHAN_ADD_OBS</a> (P_ONE_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a2e9a50628d2d7e871721c130837b3943" id="r_a2e9a50628d2d7e871721c130837b3943"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e9a50628d2d7e871721c130837b3943">ZBUS_CHAN_ADD_OBS</a> (ENERGY_PULSE_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a4de0aa1fcbf51a587a3ab462c1326ecb" id="r_a4de0aa1fcbf51a587a3ab462c1326ecb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4de0aa1fcbf51a587a3ab462c1326ecb">ZBUS_CHAN_ADD_OBS</a> (DATA_PUBLISH_REQUEST_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:ac86772b6559cbc5ca3de13e0a2091fb1" id="r_ac86772b6559cbc5ca3de13e0a2091fb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac86772b6559cbc5ca3de13e0a2091fb1">ZBUS_CHAN_ADD_OBS</a> (DATA_SEND_REQUEST_CHAN, message_queue_subscriber, 0)</td></tr>
<tr class="memitem:a1960ea4ac2008ab8f4cab1059ab651ac" id="r_a1960ea4ac2008ab8f4cab1059ab651ac"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1960ea4ac2008ab8f4cab1059ab651ac">state_operational_entry</a> (void *o)</td></tr>
<tr class="memdesc:a1960ea4ac2008ab8f4cab1059ab651ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry function for OPERATIONAL state.  <br /></td></tr>
<tr class="memitem:a5894fe4ced254ada1ff0ec62e8c3dab9" id="r_a5894fe4ced254ada1ff0ec62e8c3dab9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5894fe4ced254ada1ff0ec62e8c3dab9">state_operational_run</a> (void *o)</td></tr>
<tr class="memdesc:a5894fe4ced254ada1ff0ec62e8c3dab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run function for OPERATIONAL state.  <br /></td></tr>
<tr class="memitem:a69e0516026a9b9eef40a8cc1919d9e4d" id="r_a69e0516026a9b9eef40a8cc1919d9e4d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a69e0516026a9b9eef40a8cc1919d9e4d">state_collecting_data_entry</a> (void *o)</td></tr>
<tr class="memdesc:a69e0516026a9b9eef40a8cc1919d9e4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry function for COLLECTING_DATA state.  <br /></td></tr>
<tr class="memitem:a4ffe60323dfa7ef4c85510e2c7e135c1" id="r_a4ffe60323dfa7ef4c85510e2c7e135c1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ffe60323dfa7ef4c85510e2c7e135c1">state_collecting_data_run</a> (void *o)</td></tr>
<tr class="memdesc:a4ffe60323dfa7ef4c85510e2c7e135c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run function for COLLECTING_DATA state.  <br /></td></tr>
<tr class="memitem:a38cb2a08ca66bebc3fa27058d4cfd91f" id="r_a38cb2a08ca66bebc3fa27058d4cfd91f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38cb2a08ca66bebc3fa27058d4cfd91f">state_send_msg_attempt_entry</a> (void *o)</td></tr>
<tr class="memdesc:a38cb2a08ca66bebc3fa27058d4cfd91f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry function for SEND_MSG_ATTEMPT state.  <br /></td></tr>
<tr class="memitem:a97890684bfa65f65e530be570155ef6e" id="r_a97890684bfa65f65e530be570155ef6e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97890684bfa65f65e530be570155ef6e">update_cloud_status</a> (const struct <a class="el" href="structcloud__msg.html">cloud_msg</a> *msg)</td></tr>
<tr class="memdesc:a97890684bfa65f65e530be570155ef6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update cloud readiness status.  <br /></td></tr>
<tr class="memitem:a6150572ae890b0b64b8deb007fe3b402" id="r_a6150572ae890b0b64b8deb007fe3b402"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6150572ae890b0b64b8deb007fe3b402">combine_and_queue_data</a> (void)</td></tr>
<tr class="memdesc:a6150572ae890b0b64b8deb007fe3b402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine collected data and queue the result.  <br /></td></tr>
<tr class="memitem:ab9815de4b7b6dd6a1d493fb57448a61d" id="r_ab9815de4b7b6dd6a1d493fb57448a61d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab9815de4b7b6dd6a1d493fb57448a61d">collection_timeout_handler</a> (struct k_timer *timer)</td></tr>
<tr class="memdesc:ab9815de4b7b6dd6a1d493fb57448a61d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collection timeout handler.  <br /></td></tr>
<tr class="memitem:af7e68654facf8babc9920ba337d98b3f" id="r_af7e68654facf8babc9920ba337d98b3f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7e68654facf8babc9920ba337d98b3f">queue_combined_message</a> (const struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a> *msg)</td></tr>
<tr class="memdesc:af7e68654facf8babc9920ba337d98b3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue a combined energy message with FIFO drop-oldest strategy.  <br /></td></tr>
<tr class="memitem:ad3667701d9e14f8b5fc4e3ee0131a27b" id="r_ad3667701d9e14f8b5fc4e3ee0131a27b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3667701d9e14f8b5fc4e3ee0131a27b">task_wdt_callback</a> (int channel_id, void *user_data)</td></tr>
<tr class="memdesc:ad3667701d9e14f8b5fc4e3ee0131a27b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task watchdog timeout callback.  <br /></td></tr>
<tr class="memitem:ac00cd01a7154d3dd81f1350d4f45f671" id="r_ac00cd01a7154d3dd81f1350d4f45f671"><td class="memItemLeft" align="right" valign="top">static int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac00cd01a7154d3dd81f1350d4f45f671">uptime_to_unix_epoch</a> (int64_t uptime_ms)</td></tr>
<tr class="memdesc:ac00cd01a7154d3dd81f1350d4f45f671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert uptime to Unix epoch timestamp.  <br /></td></tr>
<tr class="memitem:afce6fe5cf4d8a9bab120bf9ed2bb7571" id="r_afce6fe5cf4d8a9bab120bf9ed2bb7571"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afce6fe5cf4d8a9bab120bf9ed2bb7571">sync_time</a> (int64_t current_uptime_ms, bool force)</td></tr>
<tr class="memdesc:afce6fe5cf4d8a9bab120bf9ed2bb7571"><td class="mdescLeft">&#160;</td><td class="mdescRight">Synchronize time with external unix epoch source.  <br /></td></tr>
<tr class="memitem:a783d99eacfd7ec5f415842d7a928e52f" id="r_a783d99eacfd7ec5f415842d7a928e52f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a783d99eacfd7ec5f415842d7a928e52f">time_needs_resync</a> (void)</td></tr>
<tr class="memdesc:a783d99eacfd7ec5f415842d7a928e52f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if time re-sync is needed (periodic drift compensation)  <br /></td></tr>
<tr class="memitem:a78d6852f1bd08d95552028c935535196" id="r_a78d6852f1bd08d95552028c935535196"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78d6852f1bd08d95552028c935535196">date_time_evt_handler</a> (const struct date_time_evt *evt)</td></tr>
<tr class="memdesc:a78d6852f1bd08d95552028c935535196"><td class="mdescLeft">&#160;</td><td class="mdescRight">Date/time event handler callback.  <br /></td></tr>
<tr class="memitem:ae10632bd80814b65aeab8b546f07f0bf" id="r_ae10632bd80814b65aeab8b546f07f0bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae10632bd80814b65aeab8b546f07f0bf">K_TIMER_DEFINE</a> (collection_timer, <a class="el" href="#ab9815de4b7b6dd6a1d493fb57448a61d">collection_timeout_handler</a>, NULL)</td></tr>
<tr class="memitem:ae9820326512114f9d391c41364a4a7f3" id="r_ae9820326512114f9d391c41364a4a7f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9820326512114f9d391c41364a4a7f3">K_MSGQ_DEFINE</a> (combined_energy_msgq, sizeof(struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a>), CONFIG_APP_MESSAGE_QUEUE_MODULE_QUEUE_SIZE, 1)</td></tr>
<tr class="memitem:adca8ee032108f348cf8ea3936481854d" id="r_adca8ee032108f348cf8ea3936481854d"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adca8ee032108f348cf8ea3936481854d">get_queue_usage</a> (void)</td></tr>
<tr class="memdesc:adca8ee032108f348cf8ea3936481854d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of messages currently in queue.  <br /></td></tr>
<tr class="memitem:a0a18dae9147827c899adc85732e672cd" id="r_a0a18dae9147827c899adc85732e672cd"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a18dae9147827c899adc85732e672cd">is_queue_empty</a> (void)</td></tr>
<tr class="memdesc:a0a18dae9147827c899adc85732e672cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if queue is empty.  <br /></td></tr>
<tr class="memitem:a16e0c8c199c4c428750fd989c79f437b" id="r_a16e0c8c199c4c428750fd989c79f437b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16e0c8c199c4c428750fd989c79f437b">build_combined_energy_json</a> (const struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a> *msg, struct nrf_cloud_obj *const obj)</td></tr>
<tr class="memdesc:a16e0c8c199c4c428750fd989c79f437b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build nRF Cloud JSON object from combined energy message.  <br /></td></tr>
<tr class="memitem:ab4b89d883393468f3d4629a61ed0b07a" id="r_ab4b89d883393468f3d4629a61ed0b07a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab4b89d883393468f3d4629a61ed0b07a">message_queue_thread</a> (void)</td></tr>
<tr class="memdesc:ab4b89d883393468f3d4629a61ed0b07a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main message queue thread.  <br /></td></tr>
<tr class="memitem:a8466a00a75815de095e483573fba1617" id="r_a8466a00a75815de095e483573fba1617"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8466a00a75815de095e483573fba1617">K_THREAD_DEFINE</a> (message_queue_thread_id, CONFIG_APP_MESSAGE_QUEUE_MODULE_THREAD_STACK_SIZE, <a class="el" href="#ab4b89d883393468f3d4629a61ed0b07a">message_queue_thread</a>, NULL, NULL, NULL, CONFIG_APP_THREAD_PRIORITY_MESSAGE_QUEUE, 0, 0)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a693d2ea076d2873522108af791cbf451" id="r_a693d2ea076d2873522108af791cbf451"><td class="memItemLeft" align="right" valign="top">static const struct smf_state&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a693d2ea076d2873522108af791cbf451">states</a> []</td></tr>
<tr class="memitem:"><td class="memItemLeft anon">struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a793c60eb3eb2d4dee66264636979039c" id="r_a793c60eb3eb2d4dee66264636979039c"><td class="memItemLeft anon">&#160;&#160;&#160;bool&#160;&#160;&#160;<a class="el" href="#a6a0e977ab733be8d10cfdeabb12314b4">has_data</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ac5800ad7ae7032b9486e76c4ddac0d30" id="r_ac5800ad7ae7032b9486e76c4ddac0d30"><td class="memItemLeft anon">&#160;&#160;&#160;struct <a class="el" href="structp__one__msg.html">p_one_msg</a>&#160;&#160;&#160;<a class="el" href="#afe1b4b4eb80224902d335e63ace502af">data</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a2d5e02455d1f14bb83db9571fdf67bd2" id="r_a2d5e02455d1f14bb83db9571fdf67bd2"><td class="memItemLeft anonEnd" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d5e02455d1f14bb83db9571fdf67bd2">collected_p1</a></td></tr>
<tr class="memitem:"><td class="memItemLeft anon">struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:aef5c13fe3cbdcf65fbf2f99a21a3dc95" id="r_aef5c13fe3cbdcf65fbf2f99a21a3dc95"><td class="memItemLeft anon">&#160;&#160;&#160;bool&#160;&#160;&#160;<a class="el" href="#a6a0e977ab733be8d10cfdeabb12314b4">has_data</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ab0aefeae0bb716742f1778eb0b440cce" id="r_ab0aefeae0bb716742f1778eb0b440cce"><td class="memItemLeft anon">&#160;&#160;&#160;struct <a class="el" href="structenergy__pulse__msg.html">energy_pulse_msg</a>&#160;&#160;&#160;<a class="el" href="#afe1b4b4eb80224902d335e63ace502af">data</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a2857022b6a6f199a8f0ac696dd4381ef" id="r_a2857022b6a6f199a8f0ac696dd4381ef"><td class="memItemLeft anonEnd" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2857022b6a6f199a8f0ac696dd4381ef">collected_pulse</a></td></tr>
<tr class="memitem:a0a63193d33e12e71f80735c00e2b4df7" id="r_a0a63193d33e12e71f80735c00e2b4df7"><td class="memItemLeft" align="right" valign="top">static atomic_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a63193d33e12e71f80735c00e2b4df7">collection_timeout_expired</a> = ATOMIC_INIT(0)</td></tr>
<tr class="memitem:a6f1182cd9184295f68d09c18dc04ba36" id="r_a6f1182cd9184295f68d09c18dc04ba36"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f1182cd9184295f68d09c18dc04ba36">is_cloud_ready</a> = false</td></tr>
<tr class="memitem:"><td class="memItemLeft anon">struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a946a96c28597812241e567aa6e1a0f5a" id="r_a946a96c28597812241e567aa6e1a0f5a"><td class="memItemLeft anon">&#160;&#160;&#160;bool&#160;&#160;&#160;<a class="el" href="#af833b67b3ae9804347e263aecbc92b84">time_synced</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ac76593598a929e36754a41597da87832" id="r_ac76593598a929e36754a41597da87832"><td class="memItemLeft anon">&#160;&#160;&#160;int64_t&#160;&#160;&#160;<a class="el" href="#a8f26a2e900c06ab2ba63387db37c70dc">unix_epoch_offset_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:af2ab1433dd1d1792ac8788dfcf8911e3" id="r_af2ab1433dd1d1792ac8788dfcf8911e3"><td class="memItemLeft anon">&#160;&#160;&#160;int64_t&#160;&#160;&#160;<a class="el" href="#aa45ad6c345c6e5d5f777f2e625e76d3d">last_sync_uptime_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a24f289b5acdd69f6969843364b8f96ac" id="r_a24f289b5acdd69f6969843364b8f96ac"><td class="memItemLeft anonEnd" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a24f289b5acdd69f6969843364b8f96ac">time_sync_state</a></td></tr>
</table>
<a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="a848ed8b7e0fb0c3ef37659dd114b7a48" name="a848ed8b7e0fb0c3ef37659dd114b7a48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848ed8b7e0fb0c3ef37659dd114b7a48">&#9670;&#160;</a></span>ADD_OBSERVERS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADD_OBSERVERS</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_chan</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_function" href="cloud_8c.html#ac9283cac5c939b94ce902cdf54042b7b">ZBUS_CHAN_ADD_OBS</a>(_chan, message_queue_subscriber, 0);</div>
<div class="ttc" id="acloud_8c_html_ac9283cac5c939b94ce902cdf54042b7b"><div class="ttname"><a href="cloud_8c.html#ac9283cac5c939b94ce902cdf54042b7b">ZBUS_CHAN_ADD_OBS</a></div><div class="ttdeci">ZBUS_CHAN_ADD_OBS(NETWORK_CHAN, cloud_subscriber, 0)</div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00070">70</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a3b5933d01a8c2ba7a93b5e6aa71593b8" name="a3b5933d01a8c2ba7a93b5e6aa71593b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b5933d01a8c2ba7a93b5e6aa71593b8">&#9670;&#160;</a></span>CHANNEL_LIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHANNEL_LIST</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    X(CLOUD_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structcloud__msg.html">cloud_msg</a>)                       \</div>
<div class="line">    X(NETWORK_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structnetwork__msg.html">network_msg</a>)                   \</div>
<div class="line">    X(P_ONE_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structp__one__msg.html">p_one_msg</a>)                       \</div>
<div class="line">    X(ENERGY_PULSE_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structenergy__pulse__msg.html">energy_pulse_msg</a>)         \</div>
<div class="line">    X(DATA_PUBLISH_REQUEST_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structtiming__event__msg.html">timing_event_msg</a>) \</div>
<div class="line">    X(DATA_SEND_REQUEST_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structtiming__event__msg.html">timing_event_msg</a>)</div>
<div class="ttc" id="astructcloud__msg_html"><div class="ttname"><a href="structcloud__msg.html">cloud_msg</a></div><div class="ttdef"><b>Definition</b> <a href="cloud__zbus_8h_source.html#l00039">cloud_zbus.h:39</a></div></div>
<div class="ttc" id="astructenergy__pulse__msg_html"><div class="ttname"><a href="structenergy__pulse__msg.html">energy_pulse_msg</a></div><div class="ttdoc">Energy pulse message.</div><div class="ttdef"><b>Definition</b> <a href="energy__pulse__zbus_8h_source.html#l00034">energy_pulse_zbus.h:34</a></div></div>
<div class="ttc" id="astructnetwork__msg_html"><div class="ttname"><a href="structnetwork__msg.html">network_msg</a></div><div class="ttdef"><b>Definition</b> <a href="network__zbus_8h_source.html#l00042">network_zbus.h:42</a></div></div>
<div class="ttc" id="astructp__one__msg_html"><div class="ttname"><a href="structp__one__msg.html">p_one_msg</a></div><div class="ttdoc">P_ONE module message structure.</div><div class="ttdef"><b>Definition</b> <a href="p__one__zbus_8h_source.html#l00037">p_one_zbus.h:37</a></div></div>
<div class="ttc" id="astructtiming__event__msg_html"><div class="ttname"><a href="structtiming__event__msg.html">timing_event_msg</a></div><div class="ttdoc">Timing event message structure.</div><div class="ttdef"><b>Definition</b> <a href="timing__zbus_8h_source.html#l00030">timing_zbus.h:30</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00058">58</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a7ebddf689a7814bf99a483ee93342257" name="a7ebddf689a7814bf99a483ee93342257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ebddf689a7814bf99a483ee93342257">&#9670;&#160;</a></span>COLLECTION_TIMEOUT_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COLLECTION_TIMEOUT_MS&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00306">306</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00897">state_collecting_data_entry()</a>.</p>

</div>
</div>
<a id="a17e333794ae761cd55ec6fd6fc0f1bac" name="a17e333794ae761cd55ec6fd6fc0f1bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e333794ae761cd55ec6fd6fc0f1bac">&#9670;&#160;</a></span>MAX_MSG_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MSG_SIZE&#160;&#160;&#160;<a class="el" href="modules__common_8h.html#ae3900a89ee01727e706bded5fb7e0d11">MAX_MSG_SIZE_FROM_LIST</a>(<a class="el" href="cloud_8c.html#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00067">67</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a2c8e46d63c3681faca97c3341bd2af97" name="a2c8e46d63c3681faca97c3341bd2af97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c8e46d63c3681faca97c3341bd2af97">&#9670;&#160;</a></span>MAX_MSGS_PER_CYCLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MSGS_PER_CYCLE&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l01005">state_send_msg_attempt_entry()</a>.</p>

</div>
</div>
<a id="a1ef2a6d3dd301f109fc0d273f1a3605c" name="a1ef2a6d3dd301f109fc0d273f1a3605c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ef2a6d3dd301f109fc0d273f1a3605c">&#9670;&#160;</a></span>TIME_RESYNC_INTERVAL_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_RESYNC_INTERVAL_MS&#160;&#160;&#160;(6 * 60 * 60 * 1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00187">187</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00260">time_needs_resync()</a>.</p>

</div>
</div>
<a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Enumeration Type Documentation</h2>
<a id="ac36eaccb444831fdf2690af621237d3e" name="ac36eaccb444831fdf2690af621237d3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac36eaccb444831fdf2690af621237d3e">&#9670;&#160;</a></span>message_queue_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ac36eaccb444831fdf2690af621237d3e">message_queue_state</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ac36eaccb444831fdf2690af621237d3eae76ec4894110475b8ecfcce46d09066d" name="ac36eaccb444831fdf2690af621237d3eae76ec4894110475b8ecfcce46d09066d"></a>STATE_OPERATIONAL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66" name="ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66"></a>STATE_COLLECTING_DATA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4" name="ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4"></a>STATE_SEND_MSG_ATTEMPT&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00083">83</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="af2a996a587e51f1c9bae9e4d484afc61" name="af2a996a587e51f1c9bae9e4d484afc61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a996a587e51f1c9bae9e4d484afc61">&#9670;&#160;</a></span>BUILD_ASSERT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BUILD_ASSERT </td>
          <td>(</td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_WATCHDOG_TIMEOUT_SECONDS</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_MSG_PROCESSING_TIME_SECONDS</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;Watchdog timeout must be greater than message processing time&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a16e0c8c199c4c428750fd989c79f437b" name="a16e0c8c199c4c428750fd989c79f437b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e0c8c199c4c428750fd989c79f437b">&#9670;&#160;</a></span>build_combined_energy_json()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int build_combined_energy_json </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct nrf_cloud_obj *const</td>          <td class="paramname"><span class="paramname"><em>obj</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build nRF Cloud JSON object from combined energy message. </p>
<p>Creates a JSON object with board-specific appId containing P1 and/or Pulse data. Structure follows nRF Cloud device message format with timestamp and data sections. Uses short key names for bandwidth optimization.</p>
<p>Converts uptime timestamps to Unix epoch before adding to JSON. If time is not synced, timestamps will be 0 (invalid).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Combined energy message with P1 and/or Pulse data </td></tr>
    <tr><td class="paramname">obj</td><td>Output object to be encoded (must be initialized)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00562">562</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="p__one__zbus_8h_source.html#l00041">p_one_msg::energy_consumed_wh_tariff1</a>, <a class="el" href="p__one__zbus_8h_source.html#l00042">p_one_msg::energy_consumed_wh_tariff2</a>, <a class="el" href="p__one__zbus_8h_source.html#l00045">p_one_msg::energy_delivered_wh_tariff1</a>, <a class="el" href="p__one__zbus_8h_source.html#l00046">p_one_msg::energy_delivered_wh_tariff2</a>, <a class="el" href="p__one__zbus_8h_source.html#l00049">p_one_msg::gas_consumed_dm3</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00042">combined_energy_msg::has_p1_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00045">combined_energy_msg::has_pulse_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00043">combined_energy_msg::p1_data</a>, <a class="el" href="p__one__zbus_8h_source.html#l00053">p_one_msg::power_consumed_avg_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00055">p_one_msg::power_consumed_max_timestamp_epoch_ms</a>, <a class="el" href="p__one__zbus_8h_source.html#l00054">p_one_msg::power_consumed_max_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00056">p_one_msg::power_consumed_min_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00060">p_one_msg::power_delivered_avg_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00062">p_one_msg::power_delivered_max_timestamp_epoch_ms</a>, <a class="el" href="p__one__zbus_8h_source.html#l00061">p_one_msg::power_delivered_max_w</a>, <a class="el" href="p__one__zbus_8h_source.html#l00063">p_one_msg::power_delivered_min_w</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00046">combined_energy_msg::pulse_data</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00036">energy_pulse_msg::pulse_energy_ch1_wh</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00037">energy_pulse_msg::pulse_energy_ch2_wh</a>, <a class="el" href="#a24f289b5acdd69f6969843364b8f96ac">time_sync_state</a>, <a class="el" href="p__one__zbus_8h_source.html#l00038">p_one_msg::timestamp_epoch_ms</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00040">combined_energy_msg::uptime_ms</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00035">energy_pulse_msg::uptime_ms</a>, and <a class="el" href="message__queue_8c_source.html#l00206">uptime_to_unix_epoch()</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l01005">state_send_msg_attempt_entry()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a16e0c8c199c4c428750fd989c79f437b_cgraph.png" border="0" usemap="#amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_cgraph" id="amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_cgraph">
<area shape="rect" title="Build nRF Cloud JSON object from combined energy message." alt="" coords="5,5,216,31"/>
<area shape="rect" href="message__queue_8c.html#ac00cd01a7154d3dd81f1350d4f45f671" title="Convert uptime to Unix epoch timestamp." alt="" coords="264,5,433,31"/>
<area shape="poly" title=" " alt="" coords="216,15,250,15,250,21,216,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a16e0c8c199c4c428750fd989c79f437b_icgraph.png" border="0" usemap="#amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_icgraph" id="amessage__queue_8c_a16e0c8c199c4c428750fd989c79f437b_icgraph">
<area shape="rect" title="Build nRF Cloud JSON object from combined energy message." alt="" coords="240,13,451,38"/>
<area shape="rect" href="message__queue_8c.html#a38cb2a08ca66bebc3fa27058d4cfd91f" title="Entry function for SEND_MSG_ATTEMPT state." alt="" coords="5,5,192,45"/>
<area shape="poly" title=" " alt="" coords="226,28,192,28,192,23,226,23"/>
</map>
</div>

</div>
</div>
<a id="ab9815de4b7b6dd6a1d493fb57448a61d" name="ab9815de4b7b6dd6a1d493fb57448a61d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9815de4b7b6dd6a1d493fb57448a61d">&#9670;&#160;</a></span>collection_timeout_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void collection_timeout_handler </td>
          <td>(</td>
          <td class="paramtype">struct k_timer *</td>          <td class="paramname"><span class="paramname"><em>timer</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collection timeout handler. </p>
<p>Called when collection window times out. Sets an atomic flag that will be checked by the state machine in the main thread. Uses atomic operations for safe cross-thread communication.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timer</td><td>Timer that expired (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00438">438</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00175">collection_timeout_expired</a>.</p>

<p class="reference">Referenced by <a class="el" href="#ae10632bd80814b65aeab8b546f07f0bf">K_TIMER_DEFINE()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ab9815de4b7b6dd6a1d493fb57448a61d_icgraph.png" border="0" usemap="#amessage__queue_8c_ab9815de4b7b6dd6a1d493fb57448a61d_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ab9815de4b7b6dd6a1d493fb57448a61d_icgraph" id="amessage__queue_8c_ab9815de4b7b6dd6a1d493fb57448a61d_icgraph">
<area shape="rect" title="Collection timeout handler." alt="" coords="188,5,331,45"/>
<area shape="rect" href="message__queue_8c.html#ae10632bd80814b65aeab8b546f07f0bf" title=" " alt="" coords="5,13,140,38"/>
<area shape="poly" title=" " alt="" coords="175,28,140,28,140,23,175,23"/>
</map>
</div>

</div>
</div>
<a id="a6150572ae890b0b64b8deb007fe3b402" name="a6150572ae890b0b64b8deb007fe3b402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6150572ae890b0b64b8deb007fe3b402">&#9670;&#160;</a></span>combine_and_queue_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void combine_and_queue_data </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Combine collected data and queue the result. </p>
<p>Called when collection window closes (either all data received or timeout). Combines whatever data was collected and queues it with flags indicating which data sources were available. </p>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00370">370</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="#a2d5e02455d1f14bb83db9571fdf67bd2">collected_p1</a>, <a class="el" href="#a2857022b6a6f199a8f0ac696dd4381ef">collected_pulse</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00042">combined_energy_msg::has_p1_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00045">combined_energy_msg::has_pulse_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00043">combined_energy_msg::p1_data</a>, <a class="el" href="message__queue__zbus_8h_source.html#l00046">combined_energy_msg::pulse_data</a>, <a class="el" href="message__queue_8c_source.html#l00503">queue_combined_message()</a>, and <a class="el" href="message__queue__zbus_8h_source.html#l00040">combined_energy_msg::uptime_ms</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00920">state_collecting_data_run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a6150572ae890b0b64b8deb007fe3b402_cgraph.png" border="0" usemap="#amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_cgraph" id="amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_cgraph">
<area shape="rect" title="Combine collected data and queue the result." alt="" coords="5,5,197,31"/>
<area shape="rect" href="message__queue_8c.html#af7e68654facf8babc9920ba337d98b3f" title="Queue a combined energy message with FIFO drop&#45;oldest strategy." alt="" coords="245,5,444,31"/>
<area shape="poly" title=" " alt="" coords="197,15,232,15,232,21,197,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a6150572ae890b0b64b8deb007fe3b402_icgraph.png" border="0" usemap="#amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_icgraph" id="amessage__queue_8c_a6150572ae890b0b64b8deb007fe3b402_icgraph">
<area shape="rect" title="Combine collected data and queue the result." alt="" coords="243,5,435,31"/>
<area shape="rect" href="message__queue_8c.html#a4ffe60323dfa7ef4c85510e2c7e135c1" title="Run function for COLLECTING_DATA state." alt="" coords="5,5,195,31"/>
<area shape="poly" title=" " alt="" coords="229,21,195,21,195,15,229,15"/>
</map>
</div>

</div>
</div>
<a id="a78d6852f1bd08d95552028c935535196" name="a78d6852f1bd08d95552028c935535196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78d6852f1bd08d95552028c935535196">&#9670;&#160;</a></span>date_time_evt_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void date_time_evt_handler </td>
          <td>(</td>
          <td class="paramtype">const struct date_time_evt *</td>          <td class="paramname"><span class="paramname"><em>evt</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Date/time event handler callback. </p>
<p>Called by date_time library when NTP sync completes. Triggers time synchronization using the obtained Unix timestamp.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evt</td><td>Date/time event </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00280">280</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00226">sync_time()</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l01108">message_queue_thread()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a78d6852f1bd08d95552028c935535196_cgraph.png" border="0" usemap="#amessage__queue_8c_a78d6852f1bd08d95552028c935535196_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a78d6852f1bd08d95552028c935535196_cgraph" id="amessage__queue_8c_a78d6852f1bd08d95552028c935535196_cgraph">
<area shape="rect" title="Date/time event handler callback." alt="" coords="5,5,177,31"/>
<area shape="rect" href="message__queue_8c.html#afce6fe5cf4d8a9bab120bf9ed2bb7571" title="Synchronize time with external unix epoch source." alt="" coords="225,5,315,31"/>
<area shape="poly" title=" " alt="" coords="178,15,212,15,212,21,178,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a78d6852f1bd08d95552028c935535196_icgraph.png" border="0" usemap="#amessage__queue_8c_a78d6852f1bd08d95552028c935535196_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a78d6852f1bd08d95552028c935535196_icgraph" id="amessage__queue_8c_a78d6852f1bd08d95552028c935535196_icgraph">
<area shape="rect" title="Date/time event handler callback." alt="" coords="425,5,597,31"/>
<area shape="rect" href="message__queue_8c.html#ab4b89d883393468f3d4629a61ed0b07a" title="Main message queue thread." alt="" coords="200,5,377,31"/>
<area shape="poly" title=" " alt="" coords="411,21,377,21,377,15,411,15"/>
<area shape="rect" href="message__queue_8c.html#a8466a00a75815de095e483573fba1617" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,152,21,152,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="adca8ee032108f348cf8ea3936481854d" name="adca8ee032108f348cf8ea3936481854d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adca8ee032108f348cf8ea3936481854d">&#9670;&#160;</a></span>get_queue_usage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t get_queue_usage </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get number of messages currently in queue. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of messages in queue </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00480">480</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00832">state_operational_run()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_adca8ee032108f348cf8ea3936481854d_icgraph.png" border="0" usemap="#amessage__queue_8c_adca8ee032108f348cf8ea3936481854d_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_adca8ee032108f348cf8ea3936481854d_icgraph" id="amessage__queue_8c_adca8ee032108f348cf8ea3936481854d_icgraph">
<area shape="rect" title="Get number of messages currently in queue." alt="" coords="217,5,353,31"/>
<area shape="rect" href="message__queue_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9" title="Run function for OPERATIONAL state." alt="" coords="5,5,169,31"/>
<area shape="poly" title=" " alt="" coords="204,21,170,21,170,15,204,15"/>
</map>
</div>

</div>
</div>
<a id="a0a18dae9147827c899adc85732e672cd" name="a0a18dae9147827c899adc85732e672cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a18dae9147827c899adc85732e672cd">&#9670;&#160;</a></span>is_queue_empty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool is_queue_empty </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if queue is empty. </p>
<dl class="section return"><dt>Returns</dt><dd>true if queue is empty, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00490">490</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="ae9820326512114f9d391c41364a4a7f3" name="ae9820326512114f9d391c41364a4a7f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9820326512114f9d391c41364a4a7f3">&#9670;&#160;</a></span>K_MSGQ_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">K_MSGQ_DEFINE </td>
          <td>(</td>
          <td class="paramtype">combined_energy_msgq</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sizeof(struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a>)</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_QUEUE_SIZE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">1</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8466a00a75815de095e483573fba1617" name="a8466a00a75815de095e483573fba1617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8466a00a75815de095e483573fba1617">&#9670;&#160;</a></span>K_THREAD_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">K_THREAD_DEFINE </td>
          <td>(</td>
          <td class="paramtype">message_queue_thread_id</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_THREAD_STACK_SIZE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ab4b89d883393468f3d4629a61ed0b07a">message_queue_thread</a></td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_THREAD_PRIORITY_MESSAGE_QUEUE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l01108">message_queue_thread()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a8466a00a75815de095e483573fba1617_cgraph.png" border="0" usemap="#amessage__queue_8c_a8466a00a75815de095e483573fba1617_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a8466a00a75815de095e483573fba1617_cgraph" id="amessage__queue_8c_a8466a00a75815de095e483573fba1617_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,152,107"/>
<area shape="rect" href="message__queue_8c.html#ab4b89d883393468f3d4629a61ed0b07a" title="Main message queue thread." alt="" coords="200,81,377,107"/>
<area shape="poly" title=" " alt="" coords="153,91,186,91,186,97,153,97"/>
<area shape="rect" href="message__queue_8c.html#a78d6852f1bd08d95552028c935535196" title="Date/time event handler callback." alt="" coords="425,5,597,31"/>
<area shape="poly" title=" " alt="" coords="326,79,459,33,461,38,328,84"/>
<area shape="rect" href="group__reboot.html#ga87f85e14d0d9ee938e640881ee58b65c" title="Publish reboot request to ZBUS." alt="" coords="645,81,820,107"/>
<area shape="poly" title=" " alt="" coords="378,91,632,91,632,97,378,97"/>
<area shape="rect" href="app_8c.html#ad3667701d9e14f8b5fc4e3ee0131a27b" title="Watchdog timeout callback." alt="" coords="440,107,583,132"/>
<area shape="poly" title=" " alt="" coords="378,101,427,107,426,112,377,107"/>
<area shape="rect" href="task__wdt__util_8c.html#a3cd0fca4b68b6c6a7222cde37cf5b49f" title="Sets up a task watchdog channel for the calling thread." alt="" coords="435,156,587,181"/>
<area shape="poly" title=" " alt="" coords="323,104,426,142,450,149,448,155,424,147,321,109"/>
<area shape="rect" href="message__queue_8c.html#afce6fe5cf4d8a9bab120bf9ed2bb7571" title="Synchronize time with external unix epoch source." alt="" coords="688,5,777,31"/>
<area shape="poly" title=" " alt="" coords="598,15,674,15,674,21,598,21"/>
<area shape="rect" href="reboot__zbus_8c.html#ade3f3b087041c1ad9a0f490df51df19b" title="Get string representation of reboot type." alt="" coords="868,81,1020,107"/>
<area shape="poly" title=" " alt="" coords="820,91,854,91,854,97,820,97"/>
<area shape="poly" title=" " alt="" coords="583,109,631,103,632,108,583,114"/>
</map>
</div>

</div>
</div>
<a id="ae10632bd80814b65aeab8b546f07f0bf" name="ae10632bd80814b65aeab8b546f07f0bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae10632bd80814b65aeab8b546f07f0bf">&#9670;&#160;</a></span>K_TIMER_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">K_TIMER_DEFINE </td>
          <td>(</td>
          <td class="paramtype">collection_timer</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ab9815de4b7b6dd6a1d493fb57448a61d">collection_timeout_handler</a></td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00438">collection_timeout_handler()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ae10632bd80814b65aeab8b546f07f0bf_cgraph.png" border="0" usemap="#amessage__queue_8c_ae10632bd80814b65aeab8b546f07f0bf_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ae10632bd80814b65aeab8b546f07f0bf_cgraph" id="amessage__queue_8c_ae10632bd80814b65aeab8b546f07f0bf_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,140,38"/>
<area shape="rect" href="message__queue_8c.html#ab9815de4b7b6dd6a1d493fb57448a61d" title="Collection timeout handler." alt="" coords="188,5,331,45"/>
<area shape="poly" title=" " alt="" coords="140,23,174,23,174,28,140,28"/>
</map>
</div>

</div>
</div>
<a id="aff430b898ed92fcfcb14c01d3cc0d2c9" name="aff430b898ed92fcfcb14c01d3cc0d2c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff430b898ed92fcfcb14c01d3cc0d2c9">&#9670;&#160;</a></span>LOG_MODULE_REGISTER()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LOG_MODULE_REGISTER </td>
          <td>(</td>
          <td class="paramtype">message_queue</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_MESSAGE_QUEUE_MODULE_LOG_LEVEL</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4b89d883393468f3d4629a61ed0b07a" name="ab4b89d883393468f3d4629a61ed0b07a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b89d883393468f3d4629a61ed0b07a">&#9670;&#160;</a></span>message_queue_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void message_queue_thread </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main message queue thread. </p>
<p>Processes ZBUS messages, manages state machine, and feeds task watchdog. Combines P1 and Pulse data, queues messages, and sends them to cloud. </p>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l01108">1108</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00095">message_queue_state_object::chan</a>, <a class="el" href="message__queue_8c_source.html#l00280">date_time_evt_handler()</a>, <a class="el" href="message__queue_8c_source.html#l00098">message_queue_state_object::msg_buf</a>, <a class="el" href="reboot__zbus_8c_source.html#l00063">reboot_request_publish()</a>, <a class="el" href="reboot__zbus_8h_source.html#l00064">REBOOT_TYPE_ERROR</a>, <a class="el" href="cloud_8c_source.html#l00164">STATE_OPERATIONAL</a>, <a class="el" href="cloud_8c_source.html#l00173">states</a>, <a class="el" href="app_8c_source.html#l00081">task_wdt_callback()</a>, and <a class="el" href="task__wdt__util_8c_source.html#l00016">task_wdt_util_setup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="#a8466a00a75815de095e483573fba1617">K_THREAD_DEFINE()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_cgraph.png" border="0" usemap="#amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_cgraph" id="amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_cgraph">
<area shape="rect" title="Main message queue thread." alt="" coords="5,81,183,107"/>
<area shape="rect" href="message__queue_8c.html#a78d6852f1bd08d95552028c935535196" title="Date/time event handler callback." alt="" coords="231,5,403,31"/>
<area shape="poly" title=" " alt="" coords="131,79,264,33,266,38,133,84"/>
<area shape="rect" href="group__reboot.html#ga87f85e14d0d9ee938e640881ee58b65c" title="Publish reboot request to ZBUS." alt="" coords="451,81,625,107"/>
<area shape="poly" title=" " alt="" coords="183,91,437,91,437,97,183,97"/>
<area shape="rect" href="app_8c.html#ad3667701d9e14f8b5fc4e3ee0131a27b" title="Watchdog timeout callback." alt="" coords="245,107,388,132"/>
<area shape="poly" title=" " alt="" coords="183,101,232,107,232,112,183,107"/>
<area shape="rect" href="task__wdt__util_8c.html#a3cd0fca4b68b6c6a7222cde37cf5b49f" title="Sets up a task watchdog channel for the calling thread." alt="" coords="241,156,393,181"/>
<area shape="poly" title=" " alt="" coords="128,104,232,142,255,149,254,155,230,147,126,109"/>
<area shape="rect" href="message__queue_8c.html#afce6fe5cf4d8a9bab120bf9ed2bb7571" title="Synchronize time with external unix epoch source." alt="" coords="493,5,583,31"/>
<area shape="poly" title=" " alt="" coords="403,15,479,15,479,21,403,21"/>
<area shape="rect" href="reboot__zbus_8c.html#ade3f3b087041c1ad9a0f490df51df19b" title="Get string representation of reboot type." alt="" coords="673,81,825,107"/>
<area shape="poly" title=" " alt="" coords="625,91,659,91,659,97,625,97"/>
<area shape="poly" title=" " alt="" coords="388,109,436,103,437,108,389,114"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_icgraph.png" border="0" usemap="#amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_icgraph" id="amessage__queue_8c_ab4b89d883393468f3d4629a61ed0b07a_icgraph">
<area shape="rect" title="Main message queue thread." alt="" coords="200,5,377,31"/>
<area shape="rect" href="message__queue_8c.html#a8466a00a75815de095e483573fba1617" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,152,21,152,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="af7e68654facf8babc9920ba337d98b3f" name="af7e68654facf8babc9920ba337d98b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7e68654facf8babc9920ba337d98b3f">&#9670;&#160;</a></span>queue_combined_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int queue_combined_message </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcombined__energy__msg.html">combined_energy_msg</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queue a combined energy message with FIFO drop-oldest strategy. </p>
<p>If queue is full, drops the oldest message to make room for new one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Combined energy message to queue </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00503">503</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue__zbus_8h_source.html#l00040">combined_energy_msg::uptime_ms</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00370">combine_and_queue_data()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_af7e68654facf8babc9920ba337d98b3f_icgraph.png" border="0" usemap="#amessage__queue_8c_af7e68654facf8babc9920ba337d98b3f_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_af7e68654facf8babc9920ba337d98b3f_icgraph" id="amessage__queue_8c_af7e68654facf8babc9920ba337d98b3f_icgraph">
<area shape="rect" title="Queue a combined energy message with FIFO drop&#45;oldest strategy." alt="" coords="483,5,681,31"/>
<area shape="rect" href="message__queue_8c.html#a6150572ae890b0b64b8deb007fe3b402" title="Combine collected data and queue the result." alt="" coords="243,5,435,31"/>
<area shape="poly" title=" " alt="" coords="469,21,435,21,435,15,469,15"/>
<area shape="rect" href="message__queue_8c.html#a4ffe60323dfa7ef4c85510e2c7e135c1" title="Run function for COLLECTING_DATA state." alt="" coords="5,5,195,31"/>
<area shape="poly" title=" " alt="" coords="229,21,195,21,195,15,229,15"/>
</map>
</div>

</div>
</div>
<a id="a69e0516026a9b9eef40a8cc1919d9e4d" name="a69e0516026a9b9eef40a8cc1919d9e4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69e0516026a9b9eef40a8cc1919d9e4d">&#9670;&#160;</a></span>state_collecting_data_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_collecting_data_entry </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entry function for COLLECTING_DATA state. </p>
<p>Starts the collection window and timer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00897">897</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="#a2d5e02455d1f14bb83db9571fdf67bd2">collected_p1</a>, <a class="el" href="#a2857022b6a6f199a8f0ac696dd4381ef">collected_pulse</a>, <a class="el" href="message__queue_8c_source.html#l00175">collection_timeout_expired</a>, and <a class="el" href="message__queue_8c_source.html#l00306">COLLECTION_TIMEOUT_MS</a>.</p>

</div>
</div>
<a id="a4ffe60323dfa7ef4c85510e2c7e135c1" name="a4ffe60323dfa7ef4c85510e2c7e135c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ffe60323dfa7ef4c85510e2c7e135c1">&#9670;&#160;</a></span>state_collecting_data_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_collecting_data_run </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run function for COLLECTING_DATA state. </p>
<p>Collects P1 and Pulse data. When both received or timeout occurs, combines and queues the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00920">920</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00095">message_queue_state_object::chan</a>, <a class="el" href="#a2d5e02455d1f14bb83db9571fdf67bd2">collected_p1</a>, <a class="el" href="#a2857022b6a6f199a8f0ac696dd4381ef">collected_pulse</a>, <a class="el" href="message__queue_8c_source.html#l00175">collection_timeout_expired</a>, <a class="el" href="message__queue_8c_source.html#l00370">combine_and_queue_data()</a>, <a class="el" href="message__queue_8c_source.html#l00098">message_queue_state_object::msg_buf</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00024">MSG_TO_ENERGY_PULSE_MSG_PTR</a>, <a class="el" href="p__one__zbus_8h_source.html#l00023">MSG_TO_P_ONE_MSG_PTR</a>, <a class="el" href="cloud_8c_source.html#l00164">STATE_OPERATIONAL</a>, and <a class="el" href="cloud_8c_source.html#l00173">states</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a4ffe60323dfa7ef4c85510e2c7e135c1_cgraph.png" border="0" usemap="#amessage__queue_8c_a4ffe60323dfa7ef4c85510e2c7e135c1_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a4ffe60323dfa7ef4c85510e2c7e135c1_cgraph" id="amessage__queue_8c_a4ffe60323dfa7ef4c85510e2c7e135c1_cgraph">
<area shape="rect" title="Run function for COLLECTING_DATA state." alt="" coords="5,5,195,31"/>
<area shape="rect" href="message__queue_8c.html#a6150572ae890b0b64b8deb007fe3b402" title="Combine collected data and queue the result." alt="" coords="243,5,435,31"/>
<area shape="poly" title=" " alt="" coords="195,15,229,15,229,21,195,21"/>
<area shape="rect" href="message__queue_8c.html#af7e68654facf8babc9920ba337d98b3f" title="Queue a combined energy message with FIFO drop&#45;oldest strategy." alt="" coords="483,5,681,31"/>
<area shape="poly" title=" " alt="" coords="435,15,469,15,469,21,435,21"/>
</map>
</div>

</div>
</div>
<a id="a1960ea4ac2008ab8f4cab1059ab651ac" name="a1960ea4ac2008ab8f4cab1059ab651ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1960ea4ac2008ab8f4cab1059ab651ac">&#9670;&#160;</a></span>state_operational_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_operational_entry </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entry function for OPERATIONAL state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00816">816</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a5894fe4ced254ada1ff0ec62e8c3dab9" name="a5894fe4ced254ada1ff0ec62e8c3dab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5894fe4ced254ada1ff0ec62e8c3dab9">&#9670;&#160;</a></span>state_operational_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_operational_run </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run function for OPERATIONAL state. </p>
<p>Waits for DATA_PUBLISH_REQUEST to start data collection. Cloud status is tracked but doesn't block data collection. Network status is tracked for periodic time re-sync (drift compensation).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00832">832</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00095">message_queue_state_object::chan</a>, <a class="el" href="message__queue_8c_source.html#l00480">get_queue_usage()</a>, <a class="el" href="message__queue_8c_source.html#l00178">is_cloud_ready</a>, <a class="el" href="message__queue_8c_source.html#l00098">message_queue_state_object::msg_buf</a>, <a class="el" href="cloud__zbus_8h_source.html#l00024">MSG_TO_CLOUD_MSG_PTR</a>, <a class="el" href="network__zbus_8h_source.html#l00024">MSG_TO_NETWORK_MSG_PTR</a>, <a class="el" href="network__zbus_8h_source.html#l00051">network_is_connected()</a>, <a class="el" href="message__queue_8c_source.html#l00085">STATE_COLLECTING_DATA</a>, <a class="el" href="message__queue_8c_source.html#l00086">STATE_SEND_MSG_ATTEMPT</a>, <a class="el" href="cloud_8c_source.html#l00173">states</a>, <a class="el" href="message__queue_8c_source.html#l00226">sync_time()</a>, <a class="el" href="message__queue_8c_source.html#l00260">time_needs_resync()</a>, and <a class="el" href="message__queue_8c_source.html#l00453">update_cloud_status()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a5894fe4ced254ada1ff0ec62e8c3dab9_cgraph.png" border="0" usemap="#amessage__queue_8c_a5894fe4ced254ada1ff0ec62e8c3dab9_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a5894fe4ced254ada1ff0ec62e8c3dab9_cgraph" id="amessage__queue_8c_a5894fe4ced254ada1ff0ec62e8c3dab9_cgraph">
<area shape="rect" title="Run function for OPERATIONAL state." alt="" coords="5,104,169,129"/>
<area shape="rect" href="message__queue_8c.html#adca8ee032108f348cf8ea3936481854d" title="Get number of messages currently in queue." alt="" coords="233,5,369,31"/>
<area shape="poly" title=" " alt="" coords="106,102,155,71,216,40,235,32,237,37,218,44,158,76,109,106"/>
<area shape="rect" href="group__network.html#gaf90ab11a76c35273f82a9d3c481b65f6" title=" " alt="" coords="217,55,384,80"/>
<area shape="poly" title=" " alt="" coords="142,101,231,81,232,86,144,107"/>
<area shape="rect" href="message__queue_8c.html#afce6fe5cf4d8a9bab120bf9ed2bb7571" title="Synchronize time with external unix epoch source." alt="" coords="256,104,345,129"/>
<area shape="poly" title=" " alt="" coords="170,114,242,114,242,119,170,119"/>
<area shape="rect" href="message__queue_8c.html#a783d99eacfd7ec5f415842d7a928e52f" title="Check if time re&#45;sync is needed (periodic drift compensation)" alt="" coords="227,153,375,179"/>
<area shape="poly" title=" " alt="" coords="144,127,232,148,231,153,142,132"/>
<area shape="rect" href="message__queue_8c.html#a97890684bfa65f65e530be570155ef6e" title="Update cloud readiness status." alt="" coords="223,203,379,228"/>
<area shape="poly" title=" " alt="" coords="109,127,158,157,218,188,240,196,238,201,216,192,155,161,107,132"/>
<area shape="rect" href="group__cloud.html#gab80e1b04abd5e0e4e2664f8fc1969627" title=" " alt="" coords="432,203,551,228"/>
<area shape="poly" title=" " alt="" coords="379,213,418,213,418,218,379,218"/>
</map>
</div>

</div>
</div>
<a id="a38cb2a08ca66bebc3fa27058d4cfd91f" name="a38cb2a08ca66bebc3fa27058d4cfd91f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38cb2a08ca66bebc3fa27058d4cfd91f">&#9670;&#160;</a></span>state_send_msg_attempt_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void state_send_msg_attempt_entry </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>o</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entry function for SEND_MSG_ATTEMPT state. </p>
<p>Attempts to send as many queued messages as possible to the cloud. Runs in entry function only - immediately transitions back to OPERATIONAL.</p>
<p>Strategy:</p><ul>
<li>Double-check cloud readiness (defense in depth)</li>
<li>Send up to MAX_MSGS_PER_CYCLE messages</li>
<li>Stop on first error (queue remains intact)</li>
<li>Always return to OPERATIONAL (never block)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">o</td><td>State object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l01005">1005</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00562">build_combined_energy_json()</a>, <a class="el" href="message__queue_8c_source.html#l00178">is_cloud_ready</a>, <a class="el" href="#a2c8e46d63c3681faca97c3341bd2af97">MAX_MSGS_PER_CYCLE</a>, <a class="el" href="cloud_8c_source.html#l00164">STATE_OPERATIONAL</a>, <a class="el" href="cloud_8c_source.html#l00173">states</a>, and <a class="el" href="message__queue__zbus_8h_source.html#l00040">combined_energy_msg::uptime_ms</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a38cb2a08ca66bebc3fa27058d4cfd91f_cgraph.png" border="0" usemap="#amessage__queue_8c_a38cb2a08ca66bebc3fa27058d4cfd91f_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a38cb2a08ca66bebc3fa27058d4cfd91f_cgraph" id="amessage__queue_8c_a38cb2a08ca66bebc3fa27058d4cfd91f_cgraph">
<area shape="rect" title="Entry function for SEND_MSG_ATTEMPT state." alt="" coords="5,5,192,45"/>
<area shape="rect" href="message__queue_8c.html#a16e0c8c199c4c428750fd989c79f437b" title="Build nRF Cloud JSON object from combined energy message." alt="" coords="240,13,451,38"/>
<area shape="poly" title=" " alt="" coords="192,23,226,23,226,28,192,28"/>
<area shape="rect" href="message__queue_8c.html#ac00cd01a7154d3dd81f1350d4f45f671" title="Convert uptime to Unix epoch timestamp." alt="" coords="499,13,668,38"/>
<area shape="poly" title=" " alt="" coords="451,23,485,23,485,28,451,28"/>
</map>
</div>

</div>
</div>
<a id="afce6fe5cf4d8a9bab120bf9ed2bb7571" name="afce6fe5cf4d8a9bab120bf9ed2bb7571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afce6fe5cf4d8a9bab120bf9ed2bb7571">&#9670;&#160;</a></span>sync_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void sync_time </td>
          <td>(</td>
          <td class="paramtype">int64_t</td>          <td class="paramname"><span class="paramname"><em>current_uptime_ms</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>force</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Synchronize time with external unix epoch source. </p>
<p>Called when DATE_TIME_OBTAINED event is received (after NTP sync completes), or periodically to compensate for clock drift (RC oscillator 250 ppm).</p>
<p>Uses date_time library which is updated via nRF Cloud's NTP sync.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_uptime_ms</td><td>Current system uptime in milliseconds </td></tr>
    <tr><td class="paramname">force</td><td>Force re-sync even if already synced (for periodic updates) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00226">226</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="#a24f289b5acdd69f6969843364b8f96ac">time_sync_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00280">date_time_evt_handler()</a>, and <a class="el" href="message__queue_8c_source.html#l00832">state_operational_run()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_afce6fe5cf4d8a9bab120bf9ed2bb7571_icgraph.png" border="0" usemap="#amessage__queue_8c_afce6fe5cf4d8a9bab120bf9ed2bb7571_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_afce6fe5cf4d8a9bab120bf9ed2bb7571_icgraph" id="amessage__queue_8c_afce6fe5cf4d8a9bab120bf9ed2bb7571_icgraph">
<area shape="rect" title="Synchronize time with external unix epoch source." alt="" coords="645,31,735,56"/>
<area shape="rect" href="message__queue_8c.html#a78d6852f1bd08d95552028c935535196" title="Date/time event handler callback." alt="" coords="425,5,597,31"/>
<area shape="poly" title=" " alt="" coords="631,38,597,33,598,28,632,33"/>
<area shape="rect" href="message__queue_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9" title="Run function for OPERATIONAL state." alt="" coords="429,55,593,80"/>
<area shape="poly" title=" " alt="" coords="632,54,594,59,593,54,631,48"/>
<area shape="rect" href="message__queue_8c.html#ab4b89d883393468f3d4629a61ed0b07a" title="Main message queue thread." alt="" coords="200,5,377,31"/>
<area shape="poly" title=" " alt="" coords="411,21,377,21,377,15,411,15"/>
<area shape="rect" href="message__queue_8c.html#a8466a00a75815de095e483573fba1617" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,152,21,152,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="ad3667701d9e14f8b5fc4e3ee0131a27b" name="ad3667701d9e14f8b5fc4e3ee0131a27b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3667701d9e14f8b5fc4e3ee0131a27b">&#9670;&#160;</a></span>task_wdt_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void task_wdt_callback </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>channel_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>user_data</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Task watchdog timeout callback. </p>
<p>Called when the task watchdog times out. Requests a system reboot to recover from the watchdog timeout condition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel_id</td><td>Task watchdog channel ID </td></tr>
    <tr><td class="paramname">user_data</td><td>User data (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00336">336</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="reboot__zbus_8c_source.html#l00063">reboot_request_publish()</a>, and <a class="el" href="reboot__zbus_8h_source.html#l00064">REBOOT_TYPE_ERROR</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ad3667701d9e14f8b5fc4e3ee0131a27b_cgraph.png" border="0" usemap="#amessage__queue_8c_ad3667701d9e14f8b5fc4e3ee0131a27b_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ad3667701d9e14f8b5fc4e3ee0131a27b_cgraph" id="amessage__queue_8c_ad3667701d9e14f8b5fc4e3ee0131a27b_cgraph">
<area shape="rect" title="Task watchdog timeout callback." alt="" coords="5,5,148,31"/>
<area shape="rect" href="group__reboot.html#ga87f85e14d0d9ee938e640881ee58b65c" title="Publish reboot request to ZBUS." alt="" coords="196,5,371,31"/>
<area shape="poly" title=" " alt="" coords="148,15,182,15,182,21,148,21"/>
<area shape="rect" href="reboot__zbus_8c.html#ade3f3b087041c1ad9a0f490df51df19b" title="Get string representation of reboot type." alt="" coords="419,5,571,31"/>
<area shape="poly" title=" " alt="" coords="371,15,405,15,405,21,371,21"/>
</map>
</div>

</div>
</div>
<a id="a783d99eacfd7ec5f415842d7a928e52f" name="a783d99eacfd7ec5f415842d7a928e52f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a783d99eacfd7ec5f415842d7a928e52f">&#9670;&#160;</a></span>time_needs_resync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool time_needs_resync </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if time re-sync is needed (periodic drift compensation) </p>
<dl class="section return"><dt>Returns</dt><dd>true if re-sync needed, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00260">260</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="message__queue_8c_source.html#l00187">TIME_RESYNC_INTERVAL_MS</a>, and <a class="el" href="#a24f289b5acdd69f6969843364b8f96ac">time_sync_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00832">state_operational_run()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a783d99eacfd7ec5f415842d7a928e52f_icgraph.png" border="0" usemap="#amessage__queue_8c_a783d99eacfd7ec5f415842d7a928e52f_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a783d99eacfd7ec5f415842d7a928e52f_icgraph" id="amessage__queue_8c_a783d99eacfd7ec5f415842d7a928e52f_icgraph">
<area shape="rect" title="Check if time re&#45;sync is needed (periodic drift compensation)" alt="" coords="217,5,365,31"/>
<area shape="rect" href="message__queue_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9" title="Run function for OPERATIONAL state." alt="" coords="5,5,169,31"/>
<area shape="poly" title=" " alt="" coords="204,21,169,21,169,15,204,15"/>
</map>
</div>

</div>
</div>
<a id="a97890684bfa65f65e530be570155ef6e" name="a97890684bfa65f65e530be570155ef6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97890684bfa65f65e530be570155ef6e">&#9670;&#160;</a></span>update_cloud_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void update_cloud_status </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcloud__msg.html">cloud_msg</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update cloud readiness status. </p>
<p>Tracks changes in cloud connection state and logs transitions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Cloud status message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00453">453</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="cloud__zbus_8h_source.html#l00048">cloud_is_ready()</a>, and <a class="el" href="message__queue_8c_source.html#l00178">is_cloud_ready</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00832">state_operational_run()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a97890684bfa65f65e530be570155ef6e_cgraph.png" border="0" usemap="#amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_cgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_cgraph" id="amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_cgraph">
<area shape="rect" title="Update cloud readiness status." alt="" coords="5,5,161,31"/>
<area shape="rect" href="group__cloud.html#gab80e1b04abd5e0e4e2664f8fc1969627" title=" " alt="" coords="209,5,328,31"/>
<area shape="poly" title=" " alt="" coords="162,15,195,15,195,21,162,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_a97890684bfa65f65e530be570155ef6e_icgraph.png" border="0" usemap="#amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_icgraph" id="amessage__queue_8c_a97890684bfa65f65e530be570155ef6e_icgraph">
<area shape="rect" title="Update cloud readiness status." alt="" coords="217,5,373,31"/>
<area shape="rect" href="message__queue_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9" title="Run function for OPERATIONAL state." alt="" coords="5,5,169,31"/>
<area shape="poly" title=" " alt="" coords="203,21,170,21,170,15,203,15"/>
</map>
</div>

</div>
</div>
<a id="ac00cd01a7154d3dd81f1350d4f45f671" name="ac00cd01a7154d3dd81f1350d4f45f671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac00cd01a7154d3dd81f1350d4f45f671">&#9670;&#160;</a></span>uptime_to_unix_epoch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int64_t uptime_to_unix_epoch </td>
          <td>(</td>
          <td class="paramtype">int64_t</td>          <td class="paramname"><span class="paramname"><em>uptime_ms</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert uptime to Unix epoch timestamp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uptime_ms</td><td>Uptime in milliseconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Unix epoch timestamp in milliseconds, or 0 if not synced </dd></dl>

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00206">206</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">References <a class="el" href="#a24f289b5acdd69f6969843364b8f96ac">time_sync_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00562">build_combined_energy_json()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="message__queue_8c_ac00cd01a7154d3dd81f1350d4f45f671_icgraph.png" border="0" usemap="#amessage__queue_8c_ac00cd01a7154d3dd81f1350d4f45f671_icgraph" loading="lazy" alt=""/></div>
<map name="amessage__queue_8c_ac00cd01a7154d3dd81f1350d4f45f671_icgraph" id="amessage__queue_8c_ac00cd01a7154d3dd81f1350d4f45f671_icgraph">
<area shape="rect" title="Convert uptime to Unix epoch timestamp." alt="" coords="499,13,668,38"/>
<area shape="rect" href="message__queue_8c.html#a16e0c8c199c4c428750fd989c79f437b" title="Build nRF Cloud JSON object from combined energy message." alt="" coords="240,13,451,38"/>
<area shape="poly" title=" " alt="" coords="485,28,451,28,451,23,485,23"/>
<area shape="rect" href="message__queue_8c.html#a38cb2a08ca66bebc3fa27058d4cfd91f" title="Entry function for SEND_MSG_ATTEMPT state." alt="" coords="5,5,192,45"/>
<area shape="poly" title=" " alt="" coords="226,28,192,28,192,23,226,23"/>
</map>
</div>

</div>
</div>
<a id="a59a0d14215c57cca3cc579702c365566" name="a59a0d14215c57cca3cc579702c365566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a0d14215c57cca3cc579702c365566">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">CLOUD_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="cloud_8c_source.html#l00074">ADD_OBSERVERS</a>.</p>

</div>
</div>
<a id="a4de0aa1fcbf51a587a3ab462c1326ecb" name="a4de0aa1fcbf51a587a3ab462c1326ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4de0aa1fcbf51a587a3ab462c1326ecb">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">DATA_PUBLISH_REQUEST_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac86772b6559cbc5ca3de13e0a2091fb1" name="ac86772b6559cbc5ca3de13e0a2091fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac86772b6559cbc5ca3de13e0a2091fb1">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">DATA_SEND_REQUEST_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e9a50628d2d7e871721c130837b3943" name="a2e9a50628d2d7e871721c130837b3943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9a50628d2d7e871721c130837b3943">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">ENERGY_PULSE_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6db0aaf3f527f3a02b1a6fcd62f57293" name="a6db0aaf3f527f3a02b1a6fcd62f57293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6db0aaf3f527f3a02b1a6fcd62f57293">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">NETWORK_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a67ac4f6e77aa428626bd119ed894eaeb" name="a67ac4f6e77aa428626bd119ed894eaeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67ac4f6e77aa428626bd119ed894eaeb">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">P_ONE_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0e845823aaacc286f3e8c0aaf560c98b" name="a0e845823aaacc286f3e8c0aaf560c98b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e845823aaacc286f3e8c0aaf560c98b">&#9670;&#160;</a></span>ZBUS_MSG_SUBSCRIBER_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_MSG_SUBSCRIBER_DEFINE </td>
          <td>(</td>
          <td class="paramtype">message_queue_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a2d5e02455d1f14bb83db9571fdf67bd2" name="a2d5e02455d1f14bb83db9571fdf67bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d5e02455d1f14bb83db9571fdf67bd2">&#9670;&#160;</a></span>[struct]</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct  { ... }  collected_p1</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .has_data = <span class="keyword">false</span>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00370">combine_and_queue_data()</a>, <a class="el" href="message__queue_8c_source.html#l00897">state_collecting_data_entry()</a>, and <a class="el" href="message__queue_8c_source.html#l00920">state_collecting_data_run()</a>.</p>

</div>
</div>
<a id="a2857022b6a6f199a8f0ac696dd4381ef" name="a2857022b6a6f199a8f0ac696dd4381ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2857022b6a6f199a8f0ac696dd4381ef">&#9670;&#160;</a></span>[struct]</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct  { ... }  collected_pulse</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .has_data = <span class="keyword">false</span>,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00370">combine_and_queue_data()</a>, <a class="el" href="message__queue_8c_source.html#l00897">state_collecting_data_entry()</a>, and <a class="el" href="message__queue_8c_source.html#l00920">state_collecting_data_run()</a>.</p>

</div>
</div>
<a id="a0a63193d33e12e71f80735c00e2b4df7" name="a0a63193d33e12e71f80735c00e2b4df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a63193d33e12e71f80735c00e2b4df7">&#9670;&#160;</a></span>collection_timeout_expired</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">atomic_t collection_timeout_expired = ATOMIC_INIT(0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00175">175</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00438">collection_timeout_handler()</a>, <a class="el" href="message__queue_8c_source.html#l00897">state_collecting_data_entry()</a>, and <a class="el" href="message__queue_8c_source.html#l00920">state_collecting_data_run()</a>.</p>

</div>
</div>
<a id="afe1b4b4eb80224902d335e63ace502af" name="afe1b4b4eb80224902d335e63ace502af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe1b4b4eb80224902d335e63ace502af">&#9670;&#160;</a></span>data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structenergy__pulse__msg.html">energy_pulse_msg</a> data</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00159">159</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="p__one_8c_source.html#l01246">uart_event_handler()</a>.</p>

</div>
</div>
<a id="a6a0e977ab733be8d10cfdeabb12314b4" name="a6a0e977ab733be8d10cfdeabb12314b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a0e977ab733be8d10cfdeabb12314b4">&#9670;&#160;</a></span>has_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool has_data</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00158">158</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a6f1182cd9184295f68d09c18dc04ba36" name="a6f1182cd9184295f68d09c18dc04ba36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f1182cd9184295f68d09c18dc04ba36">&#9670;&#160;</a></span>is_cloud_ready</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool is_cloud_ready = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00178">178</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00832">state_operational_run()</a>, <a class="el" href="message__queue_8c_source.html#l01005">state_send_msg_attempt_entry()</a>, and <a class="el" href="message__queue_8c_source.html#l00453">update_cloud_status()</a>.</p>

</div>
</div>
<a id="aa45ad6c345c6e5d5f777f2e625e76d3d" name="aa45ad6c345c6e5d5f777f2e625e76d3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa45ad6c345c6e5d5f777f2e625e76d3d">&#9670;&#160;</a></span>last_sync_uptime_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t last_sync_uptime_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00193">193</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a693d2ea076d2873522108af791cbf451" name="a693d2ea076d2873522108af791cbf451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a693d2ea076d2873522108af791cbf451">&#9670;&#160;</a></span>states</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct smf_state states[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    </div>
<div class="line">    [<a class="code hl_enumvalue" href="cloud_8c.html#a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a>] = SMF_CREATE_STATE(</div>
<div class="line">            <a class="code hl_function" href="cloud_8c.html#a1960ea4ac2008ab8f4cab1059ab651ac">state_operational_entry</a>, <a class="code hl_function" href="cloud_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9">state_operational_run</a>, NULL,</div>
<div class="line">            NULL, </div>
<div class="line">            NULL), </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    [<a class="code hl_enumvalue" href="#ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66">STATE_COLLECTING_DATA</a>] = SMF_CREATE_STATE(</div>
<div class="line">            <a class="code hl_function" href="#a69e0516026a9b9eef40a8cc1919d9e4d">state_collecting_data_entry</a>, <a class="code hl_function" href="#a4ffe60323dfa7ef4c85510e2c7e135c1">state_collecting_data_run</a>, NULL,</div>
<div class="line">            &amp;<a class="code hl_variable" href="cloud_8c.html#a693d2ea076d2873522108af791cbf451">states</a>[<a class="code hl_enumvalue" href="cloud_8c.html#a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a>], </div>
<div class="line">            NULL), </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    [<a class="code hl_enumvalue" href="#ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4">STATE_SEND_MSG_ATTEMPT</a>] = SMF_CREATE_STATE(</div>
<div class="line">            <a class="code hl_function" href="#a38cb2a08ca66bebc3fa27058d4cfd91f">state_send_msg_attempt_entry</a>, NULL, NULL,</div>
<div class="line">            &amp;<a class="code hl_variable" href="cloud_8c.html#a693d2ea076d2873522108af791cbf451">states</a>[<a class="code hl_enumvalue" href="cloud_8c.html#a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a>], </div>
<div class="line">            NULL), </div>
<div class="line">}</div>
<div class="ttc" id="acloud_8c_html_a1960ea4ac2008ab8f4cab1059ab651ac"><div class="ttname"><a href="cloud_8c.html#a1960ea4ac2008ab8f4cab1059ab651ac">state_operational_entry</a></div><div class="ttdeci">static void state_operational_entry(void *o)</div><div class="ttdef"><b>Definition</b> <a href="cloud_8c_source.html#l00661">cloud.c:661</a></div></div>
<div class="ttc" id="acloud_8c_html_a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d"><div class="ttname"><a href="cloud_8c.html#a2df95ca6d4273a301824e2d033bdc8faae76ec4894110475b8ecfcce46d09066d">STATE_OPERATIONAL</a></div><div class="ttdeci">@ STATE_OPERATIONAL</div><div class="ttdef"><b>Definition</b> <a href="cloud_8c_source.html#l00164">cloud.c:164</a></div></div>
<div class="ttc" id="acloud_8c_html_a5894fe4ced254ada1ff0ec62e8c3dab9"><div class="ttname"><a href="cloud_8c.html#a5894fe4ced254ada1ff0ec62e8c3dab9">state_operational_run</a></div><div class="ttdeci">static void state_operational_run(void *o)</div><div class="ttdef"><b>Definition</b> <a href="cloud_8c_source.html#l00674">cloud.c:674</a></div></div>
<div class="ttc" id="acloud_8c_html_a693d2ea076d2873522108af791cbf451"><div class="ttname"><a href="cloud_8c.html#a693d2ea076d2873522108af791cbf451">states</a></div><div class="ttdeci">static const struct smf_state states[]</div><div class="ttdef"><b>Definition</b> <a href="cloud_8c_source.html#l00173">cloud.c:173</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_a38cb2a08ca66bebc3fa27058d4cfd91f"><div class="ttname"><a href="#a38cb2a08ca66bebc3fa27058d4cfd91f">state_send_msg_attempt_entry</a></div><div class="ttdeci">static void state_send_msg_attempt_entry(void *o)</div><div class="ttdoc">Entry function for SEND_MSG_ATTEMPT state.</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l01005">message_queue.c:1005</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_a4ffe60323dfa7ef4c85510e2c7e135c1"><div class="ttname"><a href="#a4ffe60323dfa7ef4c85510e2c7e135c1">state_collecting_data_run</a></div><div class="ttdeci">static void state_collecting_data_run(void *o)</div><div class="ttdoc">Run function for COLLECTING_DATA state.</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00920">message_queue.c:920</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_a69e0516026a9b9eef40a8cc1919d9e4d"><div class="ttname"><a href="#a69e0516026a9b9eef40a8cc1919d9e4d">state_collecting_data_entry</a></div><div class="ttdeci">static void state_collecting_data_entry(void *o)</div><div class="ttdoc">Entry function for COLLECTING_DATA state.</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00897">message_queue.c:897</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66"><div class="ttname"><a href="#ac36eaccb444831fdf2690af621237d3ea6561237aff059c64168a20b3c1ed6e66">STATE_COLLECTING_DATA</a></div><div class="ttdeci">@ STATE_COLLECTING_DATA</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00085">message_queue.c:85</a></div></div>
<div class="ttc" id="amessage__queue_8c_html_ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4"><div class="ttname"><a href="#ac36eaccb444831fdf2690af621237d3ea6e6775de49bf992ddcadb98415404fb4">STATE_SEND_MSG_ATTEMPT</a></div><div class="ttdeci">@ STATE_SEND_MSG_ATTEMPT</div><div class="ttdef"><b>Definition</b> <a href="message__queue_8c_source.html#l00086">message_queue.c:86</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00130">130</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a24f289b5acdd69f6969843364b8f96ac" name="a24f289b5acdd69f6969843364b8f96ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f289b5acdd69f6969843364b8f96ac">&#9670;&#160;</a></span>[struct]</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct  { ... }  time_sync_state</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .time_synced = <span class="keyword">false</span>,</div>
<div class="line">    .unix_epoch_offset_ms = 0,</div>
<div class="line">    .last_sync_uptime_ms = 0,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="message__queue_8c_source.html#l00562">build_combined_energy_json()</a>, <a class="el" href="message__queue_8c_source.html#l00226">sync_time()</a>, <a class="el" href="message__queue_8c_source.html#l00260">time_needs_resync()</a>, and <a class="el" href="message__queue_8c_source.html#l00206">uptime_to_unix_epoch()</a>.</p>

</div>
</div>
<a id="af833b67b3ae9804347e263aecbc92b84" name="af833b67b3ae9804347e263aecbc92b84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af833b67b3ae9804347e263aecbc92b84">&#9670;&#160;</a></span>time_synced</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool time_synced</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00191">191</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
<a id="a8f26a2e900c06ab2ba63387db37c70dc" name="a8f26a2e900c06ab2ba63387db37c70dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f26a2e900c06ab2ba63387db37c70dc">&#9670;&#160;</a></span>unix_epoch_offset_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t unix_epoch_offset_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="message__queue_8c_source.html#l00192">192</a> of file <a class="el" href="message__queue_8c_source.html">message_queue.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_1b41d3a148801ef4e2f0892bc9eecc7e.html">modules</a></li><li class="navelem"><a href="dir_3477fc06a3faf73386151e62e3f50933.html">message_queue</a></li><li class="navelem"><a href="message__queue_8c.html">message_queue.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
