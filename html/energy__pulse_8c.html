<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="dark-mode">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="SolarResult Dinnis Core API Documentation" />
<meta property="og:description" content="API documentation for SolarResult Dinnis Core - IoT firmware for smart meter gateway device built with Zephyr RTOS on Nordic nRF9161" />
<!-- END opengraph metadata -->
<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="solar_result_white.svg">
<title>SolarResult Dinnis Core: modules/energy_pulse/energy_pulse.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    // Initialize Doxygen Awesome features (dark mode only, no toggle)
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="solar_result_white.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SolarResult Dinnis Core
   </div>
   <div id="projectbrief">Dinnis Rev1.0.0 Firmware - IoT Gateway for DSMR P1 Smart Meters</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('energy__pulse_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">energy_pulse.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;zephyr/drivers/gpio.h&gt;</code><br />
<code>#include &lt;zephyr/kernel.h&gt;</code><br />
<code>#include &lt;zephyr/logging/log.h&gt;</code><br />
<code>#include &lt;zephyr/settings/settings.h&gt;</code><br />
<code>#include &lt;zephyr/sys/atomic.h&gt;</code><br />
<code>#include &lt;zephyr/task_wdt/task_wdt.h&gt;</code><br />
<code>#include &lt;zephyr/zbus/zbus.h&gt;</code><br />
<code>#include &quot;<a class="el" href="energy__pulse__zbus_8h_source.html">energy_pulse_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="modules__common_8h_source.html">modules_common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="reboot__zbus_8h_source.html">reboot_zbus.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="task__wdt__util_8h_source.html">task_wdt_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timing__zbus_8h_source.html">timing_zbus.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for energy_pulse.c:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c__incl.png" border="0" usemap="#amodules_2energy__pulse_2energy__pulse_8c" loading="lazy" alt=""/></div>
<map name="amodules_2energy__pulse_2energy__pulse_8c" id="amodules_2energy__pulse_2energy__pulse_8c">
<area shape="rect" title=" " alt="" coords="828,5,997,45"/>
<area shape="rect" title=" " alt="" coords="5,93,164,119"/>
<area shape="poly" title=" " alt="" coords="828,36,184,96,178,97,178,91,183,91,828,31"/>
<area shape="rect" title=" " alt="" coords="847,174,970,199"/>
<area shape="poly" title=" " alt="" coords="928,44,945,78,949,99,947,119,939,143,927,164,922,161,934,141,942,118,943,99,940,80,924,47"/>
<area shape="rect" title=" " alt="" coords="994,174,1149,199"/>
<area shape="poly" title=" " alt="" coords="998,34,1107,55,1152,71,1169,81,1181,92,1188,104,1188,116,1174,138,1148,157,1118,171,1116,166,1145,152,1170,134,1183,115,1183,105,1177,95,1166,85,1150,76,1105,61,997,39"/>
<area shape="rect" title=" " alt="" coords="385,93,576,119"/>
<area shape="poly" title=" " alt="" coords="828,45,557,94,556,88,827,39"/>
<area shape="rect" title=" " alt="" coords="600,93,753,119"/>
<area shape="poly" title=" " alt="" coords="857,48,725,92,723,87,855,43"/>
<area shape="rect" title=" " alt="" coords="171,167,332,207"/>
<area shape="poly" title=" " alt="" coords="828,31,666,37,477,49,314,68,258,81,229,95,223,108,222,123,233,154,228,156,217,123,217,107,225,91,256,76,313,63,477,44,666,32,828,26"/>
<area shape="rect" title=" " alt="" coords="1515,174,1662,199"/>
<area shape="poly" title=" " alt="" coords="998,30,1171,50,1271,68,1369,91,1472,127,1555,165,1553,170,1470,132,1368,96,1270,73,1170,55,997,35"/>
<area shape="rect" href="energy__pulse__zbus_8h.html" title=" " alt="" coords="1008,93,1167,119"/>
<area shape="poly" title=" " alt="" coords="956,43,1050,85,1048,90,953,48"/>
<area shape="rect" href="modules__common_8h.html" title=" " alt="" coords="778,93,933,119"/>
<area shape="poly" title=" " alt="" coords="901,47,874,84,870,80,897,44"/>
<area shape="rect" href="reboot__zbus_8h.html" title=" " alt="" coords="1243,93,1356,119"/>
<area shape="poly" title=" " alt="" coords="998,41,1230,88,1229,93,997,46"/>
<area shape="rect" href="task__wdt__util_8h.html" title=" " alt="" coords="240,93,361,119"/>
<area shape="poly" title=" " alt="" coords="828,39,375,96,375,91,827,34"/>
<area shape="rect" href="timing__zbus_8h.html" title=" " alt="" coords="1532,93,1645,119"/>
<area shape="poly" title=" " alt="" coords="998,34,1518,94,1518,99,997,39"/>
<area shape="poly" title=" " alt="" coords="1062,121,948,171,946,166,1060,116"/>
<area shape="poly" title=" " alt="" coords="1167,114,1323,135,1504,164,1527,168,1526,174,1503,169,1323,140,1167,120"/>
<area shape="poly" title=" " alt="" coords="865,117,895,161,891,164,861,120"/>
<area shape="rect" title=" " alt="" coords="645,174,823,199"/>
<area shape="poly" title=" " alt="" coords="839,121,765,169,762,164,836,117"/>
<area shape="poly" title=" " alt="" coords="1243,119,983,169,966,173,964,168,981,164,1242,114"/>
<area shape="poly" title=" " alt="" coords="1267,121,1118,172,1117,167,1265,116"/>
<area shape="poly" title=" " alt="" coords="1342,116,1534,168,1533,173,1341,121"/>
<area shape="rect" title=" " alt="" coords="1173,167,1316,207"/>
<area shape="poly" title=" " alt="" coords="1293,120,1268,157,1264,154,1289,117"/>
<area shape="rect" title=" " alt="" coords="1340,174,1491,199"/>
<area shape="poly" title=" " alt="" coords="1318,117,1388,164,1385,168,1315,121"/>
<area shape="poly" title=" " alt="" coords="362,114,374,116,504,130,605,136,707,145,836,164,855,168,854,173,835,169,706,150,605,142,504,135,374,121,361,120"/>
<area shape="poly" title=" " alt="" coords="296,120,273,156,268,154,291,117"/>
<area shape="poly" title=" " alt="" coords="1591,119,1591,160,1586,160,1586,119"/>
<area shape="rect" title=" " alt="" coords="1687,174,1757,199"/>
<area shape="poly" title=" " alt="" coords="1610,117,1692,165,1689,169,1607,121"/>
</map>
</div>
</div>
<p><a href="energy__pulse_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae2f864d54384552d9169eabece94314a" id="r_ae2f864d54384552d9169eabece94314a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2f864d54384552d9169eabece94314a">ENERGY_PULSE_CH1_KEY</a>&#160;&#160;&#160;CONFIG_APP_ENERGY_PULSE_SETTINGS_SUBTREE &quot;/ch1&quot;</td></tr>
<tr class="memitem:a3ee7b56e5fcd98e9c0b388fccab79ea8" id="r_a3ee7b56e5fcd98e9c0b388fccab79ea8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ee7b56e5fcd98e9c0b388fccab79ea8">ENERGY_PULSE_CH2_KEY</a>&#160;&#160;&#160;CONFIG_APP_ENERGY_PULSE_SETTINGS_SUBTREE &quot;/ch2&quot;</td></tr>
<tr class="memitem:afb1fa121bca48a270e1823886d81b486" id="r_afb1fa121bca48a270e1823886d81b486"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afb1fa121bca48a270e1823886d81b486">ENERGY_PULSE_WH_PER_PULSE</a>&#160;&#160;&#160;1 /* 0.001 kWh = 1 Wh per pulse */</td></tr>
<tr class="memitem:a35f5533ea197a21652ccbc05a9079ce3" id="r_a35f5533ea197a21652ccbc05a9079ce3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a35f5533ea197a21652ccbc05a9079ce3">PULSE_CH1_GPIO_NODE</a>&#160;&#160;&#160;DT_PATH(pulses, pulse_one)</td></tr>
<tr class="memitem:a1da2a7ebee05f5fce581d2e4ba6a2d28" id="r_a1da2a7ebee05f5fce581d2e4ba6a2d28"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1da2a7ebee05f5fce581d2e4ba6a2d28">PULSE_CH2_GPIO_NODE</a>&#160;&#160;&#160;DT_PATH(pulses, pulse_two)</td></tr>
<tr class="memitem:a3b5933d01a8c2ba7a93b5e6aa71593b8" id="r_a3b5933d01a8c2ba7a93b5e6aa71593b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>(X)</td></tr>
<tr class="memitem:a17e333794ae761cd55ec6fd6fc0f1bac" id="r_a17e333794ae761cd55ec6fd6fc0f1bac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17e333794ae761cd55ec6fd6fc0f1bac">MAX_MSG_SIZE</a>&#160;&#160;&#160;<a class="el" href="modules__common_8h.html#ae3900a89ee01727e706bded5fb7e0d11">MAX_MSG_SIZE_FROM_LIST</a>(<a class="el" href="cloud_8c.html#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>)</td></tr>
<tr class="memitem:a848ed8b7e0fb0c3ef37659dd114b7a48" id="r_a848ed8b7e0fb0c3ef37659dd114b7a48"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a848ed8b7e0fb0c3ef37659dd114b7a48">ADD_OBSERVERS</a>(_chan,  _type)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab691f12e2787f4ca09c14ad6d12b92b3" id="r_ab691f12e2787f4ca09c14ad6d12b92b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab691f12e2787f4ca09c14ad6d12b92b3">LOG_MODULE_REGISTER</a> (energy_pulse, CONFIG_APP_ENERGY_PULSE_MODULE_LOG_LEVEL)</td></tr>
<tr class="memitem:a6f5d7596cae44d6b771c19d31ab2ee88" id="r_a6f5d7596cae44d6b771c19d31ab2ee88"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f5d7596cae44d6b771c19d31ab2ee88">BUILD_ASSERT</a> (CONFIG_APP_ENERGY_PULSE_MODULE_WATCHDOG_TIMEOUT_SECONDS &gt; CONFIG_APP_ENERGY_PULSE_MODULE_MSG_PROCESSING_TIME_SECONDS, &quot;Watchdog timeout must be greater than message processing time&quot;)</td></tr>
<tr class="memitem:ac8bfcc8baa23f0e3f3600b1e705f323d" id="r_ac8bfcc8baa23f0e3f3600b1e705f323d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8bfcc8baa23f0e3f3600b1e705f323d">ZBUS_MSG_SUBSCRIBER_DEFINE</a> (energy_pulse_subscriber)</td></tr>
<tr class="memitem:a939a567e02c5666e7e6069482a3256b0" id="r_a939a567e02c5666e7e6069482a3256b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a939a567e02c5666e7e6069482a3256b0">ZBUS_CHAN_ADD_OBS</a> (DATA_PUBLISH_REQUEST_CHAN, energy_pulse_subscriber, 0)</td></tr>
<tr class="memitem:abfe77b426d92d33e70298643e76e0b0e" id="r_abfe77b426d92d33e70298643e76e0b0e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abfe77b426d92d33e70298643e76e0b0e">ZBUS_CHAN_ADD_OBS</a> (REBOOT_CHAN, energy_pulse_subscriber, 0)</td></tr>
<tr class="memitem:adc6936992c86b4d791dc8428cd1f1183" id="r_adc6936992c86b4d791dc8428cd1f1183"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc6936992c86b4d791dc8428cd1f1183">ZBUS_CHAN_DEFINE</a> (ENERGY_PULSE_CHAN, struct <a class="el" href="structenergy__pulse__msg.html">energy_pulse_msg</a>, NULL, NULL, ZBUS_OBSERVERS_EMPTY, ZBUS_MSG_INIT(0))</td></tr>
<tr class="memitem:abefb7627ec666a33d47d4f9edce23080" id="r_abefb7627ec666a33d47d4f9edce23080"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abefb7627ec666a33d47d4f9edce23080">pulse_gpio_callback</a> (const struct device *dev, struct gpio_callback *cb, uint32_t pins)</td></tr>
<tr class="memdesc:abefb7627ec666a33d47d4f9edce23080"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPIO callback for pulse counting.  <br /></td></tr>
<tr class="memitem:ad3667701d9e14f8b5fc4e3ee0131a27b" id="r_ad3667701d9e14f8b5fc4e3ee0131a27b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3667701d9e14f8b5fc4e3ee0131a27b">task_wdt_callback</a> (int channel_id, void *user_data)</td></tr>
<tr class="memdesc:ad3667701d9e14f8b5fc4e3ee0131a27b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Watchdog timeout callback.  <br /></td></tr>
<tr class="memitem:a3baee71ff88d13304ea1b5ae214150cf" id="r_a3baee71ff88d13304ea1b5ae214150cf"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3baee71ff88d13304ea1b5ae214150cf">setup_pulse_gpio</a> (const struct gpio_dt_spec *gpio_spec, struct gpio_callback *<a class="el" href="#a2c1fdb2a55600085d534b2305e5c3385">gpio_cb</a>)</td></tr>
<tr class="memdesc:a3baee71ff88d13304ea1b5ae214150cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize GPIO for pulse input.  <br /></td></tr>
<tr class="memitem:af2350211e61bd92164f28699163665b7" id="r_af2350211e61bd92164f28699163665b7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2350211e61bd92164f28699163665b7">energy_pulse_gpio_init</a> (void)</td></tr>
<tr class="memdesc:af2350211e61bd92164f28699163665b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize GPIO for both pulse input channels.  <br /></td></tr>
<tr class="memitem:a3196f876a6eb90c89f874161b14ac3cd" id="r_a3196f876a6eb90c89f874161b14ac3cd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3196f876a6eb90c89f874161b14ac3cd">energy_pulse_msg_publish</a> (void)</td></tr>
<tr class="memdesc:a3196f876a6eb90c89f874161b14ac3cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish energy pulse data to ZBUS.  <br /></td></tr>
<tr class="memitem:a73e5cbd4dc4398f4a645813bcd7bc1dd" id="r_a73e5cbd4dc4398f4a645813bcd7bc1dd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73e5cbd4dc4398f4a645813bcd7bc1dd">energy_pulse_settings_set</a> (const char *name, size_t len, settings_read_cb read_cb, void *cb_arg)</td></tr>
<tr class="memdesc:a73e5cbd4dc4398f4a645813bcd7bc1dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Settings handler callback for loading energy pulse data.  <br /></td></tr>
<tr class="memitem:aa7a2e9b92b7d0c72236951d33195aca3" id="r_aa7a2e9b92b7d0c72236951d33195aca3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7a2e9b92b7d0c72236951d33195aca3">SETTINGS_STATIC_HANDLER_DEFINE</a> (energy_pulse, CONFIG_APP_ENERGY_PULSE_SETTINGS_SUBTREE, NULL, <a class="el" href="#a73e5cbd4dc4398f4a645813bcd7bc1dd">energy_pulse_settings_set</a>, NULL, NULL)</td></tr>
<tr class="memitem:a18690cd2c0cd2e09ff7ab115a9294362" id="r_a18690cd2c0cd2e09ff7ab115a9294362"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a18690cd2c0cd2e09ff7ab115a9294362">save_energy_channel</a> (const char *key, const atomic_val_t <a class="el" href="p__one_8c.html#a354b99b030bdfe136490f848c05d4788">value</a>)</td></tr>
<tr class="memdesc:a18690cd2c0cd2e09ff7ab115a9294362"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a single energy channel to persistent storage.  <br /></td></tr>
<tr class="memitem:a9c9ba9582cab179bb2fe8c4de8f2fa74" id="r_a9c9ba9582cab179bb2fe8c4de8f2fa74"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c9ba9582cab179bb2fe8c4de8f2fa74">save_energy_counters</a> (void)</td></tr>
<tr class="memdesc:a9c9ba9582cab179bb2fe8c4de8f2fa74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save energy counters to persistent storage.  <br /></td></tr>
<tr class="memitem:a392a7942dccb93cda5fad8e3a5944569" id="r_a392a7942dccb93cda5fad8e3a5944569"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a392a7942dccb93cda5fad8e3a5944569">energy_pulse_load_settings</a> (void)</td></tr>
<tr class="memdesc:a392a7942dccb93cda5fad8e3a5944569"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize energy pulse data from persistent storage.  <br /></td></tr>
<tr class="memitem:a1329c6acbf8c68ee8b0ad7a7b5f3f62d" id="r_a1329c6acbf8c68ee8b0ad7a7b5f3f62d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1329c6acbf8c68ee8b0ad7a7b5f3f62d">energy_pulse_thread</a> (void)</td></tr>
<tr class="memdesc:a1329c6acbf8c68ee8b0ad7a7b5f3f62d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main energy pulse thread.  <br /></td></tr>
<tr class="memitem:ad1b60b3b5778d3bacbedbdaef9188276" id="r_ad1b60b3b5778d3bacbedbdaef9188276"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad1b60b3b5778d3bacbedbdaef9188276">K_THREAD_DEFINE</a> (energy_pulse_thread_id, CONFIG_APP_ENERGY_PULSE_MODULE_THREAD_STACK_SIZE, <a class="el" href="#a1329c6acbf8c68ee8b0ad7a7b5f3f62d">energy_pulse_thread</a>, NULL, NULL, NULL, CONFIG_APP_THREAD_PRIORITY_ENERGY_PULSE, 0, 0)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a414835ffc7cc99ac71c9655e8f1912fe" id="r_a414835ffc7cc99ac71c9655e8f1912fe"><td class="memItemLeft" align="right" valign="top">static const struct gpio_dt_spec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a414835ffc7cc99ac71c9655e8f1912fe">pulse_ch1_gpio</a></td></tr>
<tr class="memitem:abbd0a8e65b5facd35573d86cdd30db47" id="r_abbd0a8e65b5facd35573d86cdd30db47"><td class="memItemLeft" align="right" valign="top">static const struct gpio_dt_spec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abbd0a8e65b5facd35573d86cdd30db47">pulse_ch2_gpio</a></td></tr>
<tr class="memitem:a0886d16feaea1ed7170637194c54534f" id="r_a0886d16feaea1ed7170637194c54534f"><td class="memItemLeft" align="right" valign="top">static atomic_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0886d16feaea1ed7170637194c54534f">pulse_energy_ch1</a> = ATOMIC_INIT(0)</td></tr>
<tr class="memitem:a1b05ed500d1fa2847e79ce10f95c3c19" id="r_a1b05ed500d1fa2847e79ce10f95c3c19"><td class="memItemLeft" align="right" valign="top">static atomic_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b05ed500d1fa2847e79ce10f95c3c19">pulse_energy_ch2</a> = ATOMIC_INIT(0)</td></tr>
<tr class="memitem:a0c3e33e28926531c22ff5e7400a9776f" id="r_a0c3e33e28926531c22ff5e7400a9776f"><td class="memItemLeft" align="right" valign="top">static atomic_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c3e33e28926531c22ff5e7400a9776f">has_new_pulses_since_save</a> = ATOMIC_INIT(0)</td></tr>
<tr class="memitem:a2c1fdb2a55600085d534b2305e5c3385" id="r_a2c1fdb2a55600085d534b2305e5c3385"><td class="memItemLeft" align="right" valign="top">static struct gpio_callback&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c1fdb2a55600085d534b2305e5c3385">gpio_cb</a></td></tr>
</table>
<a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="a848ed8b7e0fb0c3ef37659dd114b7a48" name="a848ed8b7e0fb0c3ef37659dd114b7a48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848ed8b7e0fb0c3ef37659dd114b7a48">&#9670;&#160;</a></span>ADD_OBSERVERS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADD_OBSERVERS</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_chan</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <a class="code hl_function" href="cloud_8c.html#ac9283cac5c939b94ce902cdf54042b7b">ZBUS_CHAN_ADD_OBS</a>(_chan, energy_pulse_subscriber, 0);</div>
<div class="ttc" id="acloud_8c_html_ac9283cac5c939b94ce902cdf54042b7b"><div class="ttname"><a href="cloud_8c.html#ac9283cac5c939b94ce902cdf54042b7b">ZBUS_CHAN_ADD_OBS</a></div><div class="ttdeci">ZBUS_CHAN_ADD_OBS(NETWORK_CHAN, cloud_subscriber, 0)</div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00067">67</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

</div>
</div>
<a id="a3b5933d01a8c2ba7a93b5e6aa71593b8" name="a3b5933d01a8c2ba7a93b5e6aa71593b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b5933d01a8c2ba7a93b5e6aa71593b8">&#9670;&#160;</a></span>CHANNEL_LIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHANNEL_LIST</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    X(DATA_PUBLISH_REQUEST_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structtiming__event__msg.html">timing_event_msg</a>) \</div>
<div class="line">    X(REBOOT_CHAN, <span class="keyword">struct</span> <a class="code hl_struct" href="structreboot__msg.html">reboot_msg</a>)</div>
<div class="ttc" id="astructreboot__msg_html"><div class="ttname"><a href="structreboot__msg.html">reboot_msg</a></div><div class="ttdoc">Reboot message structure.</div><div class="ttdef"><b>Definition</b> <a href="reboot__zbus_8h_source.html#l00072">reboot_zbus.h:72</a></div></div>
<div class="ttc" id="astructtiming__event__msg_html"><div class="ttname"><a href="structtiming__event__msg.html">timing_event_msg</a></div><div class="ttdoc">Timing event message structure.</div><div class="ttdef"><b>Definition</b> <a href="timing__zbus_8h_source.html#l00030">timing_zbus.h:30</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00059">59</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

</div>
</div>
<a id="ae2f864d54384552d9169eabece94314a" name="ae2f864d54384552d9169eabece94314a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2f864d54384552d9169eabece94314a">&#9670;&#160;</a></span>ENERGY_PULSE_CH1_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENERGY_PULSE_CH1_KEY&#160;&#160;&#160;CONFIG_APP_ENERGY_PULSE_SETTINGS_SUBTREE &quot;/ch1&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00039">39</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00388">save_energy_counters()</a>.</p>

</div>
</div>
<a id="a3ee7b56e5fcd98e9c0b388fccab79ea8" name="a3ee7b56e5fcd98e9c0b388fccab79ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ee7b56e5fcd98e9c0b388fccab79ea8">&#9670;&#160;</a></span>ENERGY_PULSE_CH2_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENERGY_PULSE_CH2_KEY&#160;&#160;&#160;CONFIG_APP_ENERGY_PULSE_SETTINGS_SUBTREE &quot;/ch2&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00040">40</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00388">save_energy_counters()</a>.</p>

</div>
</div>
<a id="afb1fa121bca48a270e1823886d81b486" name="afb1fa121bca48a270e1823886d81b486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb1fa121bca48a270e1823886d81b486">&#9670;&#160;</a></span>ENERGY_PULSE_WH_PER_PULSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENERGY_PULSE_WH_PER_PULSE&#160;&#160;&#160;1 /* 0.001 kWh = 1 Wh per pulse */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00043">43</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00191">energy_pulse_msg_publish()</a>.</p>

</div>
</div>
<a id="a17e333794ae761cd55ec6fd6fc0f1bac" name="a17e333794ae761cd55ec6fd6fc0f1bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e333794ae761cd55ec6fd6fc0f1bac">&#9670;&#160;</a></span>MAX_MSG_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MSG_SIZE&#160;&#160;&#160;<a class="el" href="modules__common_8h.html#ae3900a89ee01727e706bded5fb7e0d11">MAX_MSG_SIZE_FROM_LIST</a>(<a class="el" href="cloud_8c.html#a3b5933d01a8c2ba7a93b5e6aa71593b8">CHANNEL_LIST</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00064">64</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

</div>
</div>
<a id="a35f5533ea197a21652ccbc05a9079ce3" name="a35f5533ea197a21652ccbc05a9079ce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35f5533ea197a21652ccbc05a9079ce3">&#9670;&#160;</a></span>PULSE_CH1_GPIO_NODE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PULSE_CH1_GPIO_NODE&#160;&#160;&#160;DT_PATH(pulses, pulse_one)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00046">46</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

</div>
</div>
<a id="a1da2a7ebee05f5fce581d2e4ba6a2d28" name="a1da2a7ebee05f5fce581d2e4ba6a2d28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1da2a7ebee05f5fce581d2e4ba6a2d28">&#9670;&#160;</a></span>PULSE_CH2_GPIO_NODE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PULSE_CH2_GPIO_NODE&#160;&#160;&#160;DT_PATH(pulses, pulse_two)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00047">47</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a6f5d7596cae44d6b771c19d31ab2ee88" name="a6f5d7596cae44d6b771c19d31ab2ee88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f5d7596cae44d6b771c19d31ab2ee88">&#9670;&#160;</a></span>BUILD_ASSERT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BUILD_ASSERT </td>
          <td>(</td>
          <td class="paramtype">CONFIG_APP_ENERGY_PULSE_MODULE_WATCHDOG_TIMEOUT_SECONDS</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_ENERGY_PULSE_MODULE_MSG_PROCESSING_TIME_SECONDS</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;Watchdog timeout must be greater than message processing time&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af2350211e61bd92164f28699163665b7" name="af2350211e61bd92164f28699163665b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2350211e61bd92164f28699163665b7">&#9670;&#160;</a></span>energy_pulse_gpio_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int energy_pulse_gpio_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize GPIO for both pulse input channels. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00158">158</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00107">gpio_cb</a>, <a class="el" href="energy__pulse_8c_source.html#l00094">pulse_ch1_gpio</a>, <a class="el" href="energy__pulse_8c_source.html#l00096">pulse_ch2_gpio</a>, <a class="el" href="energy__pulse_8c_source.html#l00242">pulse_gpio_callback()</a>, and <a class="el" href="energy__pulse_8c_source.html#l00122">setup_pulse_gpio()</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00465">energy_pulse_thread()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_af2350211e61bd92164f28699163665b7_cgraph.png" border="0" usemap="#aenergy__pulse_8c_af2350211e61bd92164f28699163665b7_cgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_af2350211e61bd92164f28699163665b7_cgraph" id="aenergy__pulse_8c_af2350211e61bd92164f28699163665b7_cgraph">
<area shape="rect" title="Initialize GPIO for both pulse input channels." alt="" coords="5,43,177,68"/>
<area shape="rect" href="energy__pulse_8c.html#abefb7627ec666a33d47d4f9edce23080" title="GPIO callback for pulse counting." alt="" coords="225,5,379,31"/>
<area shape="poly" title=" " alt="" coords="163,40,216,30,217,36,164,45"/>
<area shape="rect" href="energy__pulse_8c.html#a3baee71ff88d13304ea1b5ae214150cf" title="Initialize GPIO for pulse input." alt="" coords="235,79,369,104"/>
<area shape="poly" title=" " alt="" coords="166,65,221,75,221,80,166,71"/>
<area shape="poly" title=" " alt="" coords="267,80,260,70,264,60,278,54,302,52,331,56,343,65,340,69,329,61,302,57,280,59,268,64,265,70,272,77"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_af2350211e61bd92164f28699163665b7_icgraph.png" border="0" usemap="#aenergy__pulse_8c_af2350211e61bd92164f28699163665b7_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_af2350211e61bd92164f28699163665b7_icgraph" id="aenergy__pulse_8c_af2350211e61bd92164f28699163665b7_icgraph">
<area shape="rect" title="Initialize GPIO for both pulse input channels." alt="" coords="407,5,579,31"/>
<area shape="rect" href="energy__pulse_8c.html#a1329c6acbf8c68ee8b0ad7a7b5f3f62d" title="Main energy pulse thread." alt="" coords="200,5,359,31"/>
<area shape="poly" title=" " alt="" coords="393,21,359,21,359,15,393,15"/>
<area shape="rect" href="energy__pulse_8c.html#ad1b60b3b5778d3bacbedbdaef9188276" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,153,21,153,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="a392a7942dccb93cda5fad8e3a5944569" name="a392a7942dccb93cda5fad8e3a5944569"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a392a7942dccb93cda5fad8e3a5944569">&#9670;&#160;</a></span>energy_pulse_load_settings()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int energy_pulse_load_settings </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize energy pulse data from persistent storage. </p>
<p>Initializes the settings subsystem and loads energy pulse counters from persistent storage using the registered settings handler.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00427">427</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00104">has_new_pulses_since_save</a>, <a class="el" href="energy__pulse_8c_source.html#l00100">pulse_energy_ch1</a>, and <a class="el" href="energy__pulse_8c_source.html#l00101">pulse_energy_ch2</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00465">energy_pulse_thread()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a392a7942dccb93cda5fad8e3a5944569_icgraph.png" border="0" usemap="#aenergy__pulse_8c_a392a7942dccb93cda5fad8e3a5944569_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a392a7942dccb93cda5fad8e3a5944569_icgraph" id="aenergy__pulse_8c_a392a7942dccb93cda5fad8e3a5944569_icgraph">
<area shape="rect" title="Initialize energy pulse data from persistent storage." alt="" coords="407,5,609,31"/>
<area shape="rect" href="energy__pulse_8c.html#a1329c6acbf8c68ee8b0ad7a7b5f3f62d" title="Main energy pulse thread." alt="" coords="200,5,359,31"/>
<area shape="poly" title=" " alt="" coords="393,21,359,21,359,15,393,15"/>
<area shape="rect" href="energy__pulse_8c.html#ad1b60b3b5778d3bacbedbdaef9188276" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,153,21,153,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="a3196f876a6eb90c89f874161b14ac3cd" name="a3196f876a6eb90c89f874161b14ac3cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3196f876a6eb90c89f874161b14ac3cd">&#9670;&#160;</a></span>energy_pulse_msg_publish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void energy_pulse_msg_publish </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Publish energy pulse data to ZBUS. </p>
<p>Atomically reads the pulse counters, converts to Wh (int32_t, no FPU!), and publishes the data with current timestamp to the ENERGY_PULSE_CHAN. </p>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00191">191</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00043">ENERGY_PULSE_WH_PER_PULSE</a>, <a class="el" href="energy__pulse_8c_source.html#l00100">pulse_energy_ch1</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00036">energy_pulse_msg::pulse_energy_ch1_wh</a>, <a class="el" href="energy__pulse_8c_source.html#l00101">pulse_energy_ch2</a>, <a class="el" href="energy__pulse__zbus_8h_source.html#l00037">energy_pulse_msg::pulse_energy_ch2_wh</a>, and <a class="el" href="energy__pulse__zbus_8h_source.html#l00035">energy_pulse_msg::uptime_ms</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00465">energy_pulse_thread()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a3196f876a6eb90c89f874161b14ac3cd_icgraph.png" border="0" usemap="#aenergy__pulse_8c_a3196f876a6eb90c89f874161b14ac3cd_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a3196f876a6eb90c89f874161b14ac3cd_icgraph" id="aenergy__pulse_8c_a3196f876a6eb90c89f874161b14ac3cd_icgraph">
<area shape="rect" title="Publish energy pulse data to ZBUS." alt="" coords="407,5,605,31"/>
<area shape="rect" href="energy__pulse_8c.html#a1329c6acbf8c68ee8b0ad7a7b5f3f62d" title="Main energy pulse thread." alt="" coords="200,5,359,31"/>
<area shape="poly" title=" " alt="" coords="393,21,359,21,359,15,393,15"/>
<area shape="rect" href="energy__pulse_8c.html#ad1b60b3b5778d3bacbedbdaef9188276" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,153,21,153,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="a73e5cbd4dc4398f4a645813bcd7bc1dd" name="a73e5cbd4dc4398f4a645813bcd7bc1dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73e5cbd4dc4398f4a645813bcd7bc1dd">&#9670;&#160;</a></span>energy_pulse_settings_set()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int energy_pulse_settings_set </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">settings_read_cb</td>          <td class="paramname"><span class="paramname"><em>read_cb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>cb_arg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Settings handler callback for loading energy pulse data. </p>
<p>Called by settings_load() when restoring data from persistent storage. Parses the key name and loads the corresponding channel data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Setting name (without subtree prefix, e.g., "ch1" or "ch2") </td></tr>
    <tr><td class="paramname">len</td><td>Length of data to read </td></tr>
    <tr><td class="paramname">read_cb</td><td>Callback function to read data from backend </td></tr>
    <tr><td class="paramname">cb_arg</td><td>Argument to pass to read_cb </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -ENOENT if key not found, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00304">304</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00100">pulse_energy_ch1</a>, <a class="el" href="energy__pulse_8c_source.html#l00101">pulse_energy_ch2</a>, and <a class="el" href="p__one_8c_source.html#l00254">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="#aa7a2e9b92b7d0c72236951d33195aca3">SETTINGS_STATIC_HANDLER_DEFINE()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a73e5cbd4dc4398f4a645813bcd7bc1dd_icgraph.png" border="0" usemap="#aenergy__pulse_8c_a73e5cbd4dc4398f4a645813bcd7bc1dd_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a73e5cbd4dc4398f4a645813bcd7bc1dd_icgraph" id="aenergy__pulse_8c_a73e5cbd4dc4398f4a645813bcd7bc1dd_icgraph">
<area shape="rect" title="Settings handler callback for loading energy pulse data." alt="" coords="260,13,455,38"/>
<area shape="rect" href="energy__pulse_8c.html#aa7a2e9b92b7d0c72236951d33195aca3" title=" " alt="" coords="5,5,212,45"/>
<area shape="poly" title=" " alt="" coords="246,28,212,28,212,23,246,23"/>
</map>
</div>

</div>
</div>
<a id="a1329c6acbf8c68ee8b0ad7a7b5f3f62d" name="a1329c6acbf8c68ee8b0ad7a7b5f3f62d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1329c6acbf8c68ee8b0ad7a7b5f3f62d">&#9670;&#160;</a></span>energy_pulse_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void energy_pulse_thread </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main energy pulse thread. </p>
<p>Initializes the module, monitors trigger messages and feeds watchdog timer. </p>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00465">465</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00158">energy_pulse_gpio_init()</a>, <a class="el" href="energy__pulse_8c_source.html#l00427">energy_pulse_load_settings()</a>, <a class="el" href="energy__pulse_8c_source.html#l00191">energy_pulse_msg_publish()</a>, <a class="el" href="cloud_8c_source.html#l00070">MAX_MSG_SIZE</a>, <a class="el" href="reboot__zbus_8h_source.html#l00048">MSG_TO_REBOOT_MSG_PTR</a>, <a class="el" href="timing__zbus_8h_source.html#l00021">MSG_TO_TIMING_EVENT_MSG_PTR</a>, <a class="el" href="energy__pulse_8c_source.html#l00388">save_energy_counters()</a>, <a class="el" href="reboot__zbus_8c_source.html#l00088">shutdown_acknowledge_publish()</a>, <a class="el" href="reboot__zbus_8h_source.html#l00055">SHUTDOWN_REQ</a>, <a class="el" href="app_8c_source.html#l00079">task_wdt_callback()</a>, <a class="el" href="task__wdt__util_8c_source.html#l00016">task_wdt_util_setup()</a>, <a class="el" href="reboot__zbus_8h_source.html#l00073">reboot_msg::type</a>, and <a class="el" href="timing__zbus_8h_source.html#l00031">timing_event_msg::uptime_ms</a>.</p>

<p class="reference">Referenced by <a class="el" href="#ad1b60b3b5778d3bacbedbdaef9188276">K_THREAD_DEFINE()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a1329c6acbf8c68ee8b0ad7a7b5f3f62d_cgraph.png" border="0" usemap="#aenergy__pulse_8c_a1329c6acbf8c68ee8b0ad7a7b5f3f62d_cgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a1329c6acbf8c68ee8b0ad7a7b5f3f62d_cgraph" id="aenergy__pulse_8c_a1329c6acbf8c68ee8b0ad7a7b5f3f62d_cgraph">
<area shape="rect" title="Main energy pulse thread." alt="" coords="5,189,164,215"/>
<area shape="rect" href="energy__pulse_8c.html#af2350211e61bd92164f28699163665b7" title="Initialize GPIO for both pulse input channels." alt="" coords="227,41,399,67"/>
<area shape="poly" title=" " alt="" coords="93,187,139,133,173,102,211,76,225,69,227,74,213,80,176,106,143,137,97,191"/>
<area shape="rect" href="energy__pulse_8c.html#a392a7942dccb93cda5fad8e3a5944569" title="Initialize energy pulse data from persistent storage." alt="" coords="212,91,415,116"/>
<area shape="poly" title=" " alt="" coords="102,187,150,156,211,125,232,117,234,122,213,130,152,161,105,192"/>
<area shape="rect" href="energy__pulse_8c.html#a3196f876a6eb90c89f874161b14ac3cd" title="Publish energy pulse data to ZBUS." alt="" coords="214,140,413,165"/>
<area shape="poly" title=" " alt="" coords="144,187,240,166,241,171,145,192"/>
<area shape="rect" href="energy__pulse_8c.html#a9c9ba9582cab179bb2fe8c4de8f2fa74" title="Save energy counters to persistent storage." alt="" coords="229,189,397,215"/>
<area shape="poly" title=" " alt="" coords="164,199,216,199,216,205,164,205"/>
<area shape="rect" href="group__reboot.html#gac92d45e2bf7302d8b7691195e0d23650" title="Publish shutdown acknowledgment to ZBUS." alt="" coords="224,239,403,279"/>
<area shape="poly" title=" " alt="" coords="137,212,221,233,219,239,136,217"/>
<area shape="rect" href="app_8c.html#ad3667701d9e14f8b5fc4e3ee0131a27b" title="Watchdog timeout callback." alt="" coords="242,304,385,329"/>
<area shape="poly" title=" " alt="" coords="102,213,150,251,180,271,213,289,235,297,233,302,211,294,178,276,146,255,99,217"/>
<area shape="rect" href="task__wdt__util_8c.html#a3cd0fca4b68b6c6a7222cde37cf5b49f" title="Sets up a task watchdog channel for the calling thread." alt="" coords="237,353,389,379"/>
<area shape="poly" title=" " alt="" coords="96,213,140,275,174,310,213,340,226,346,223,351,211,344,171,314,136,278,91,216"/>
<area shape="rect" href="energy__pulse_8c.html#abefb7627ec666a33d47d4f9edce23080" title="GPIO callback for pulse counting." alt="" coords="467,5,621,31"/>
<area shape="poly" title=" " alt="" coords="395,39,454,29,454,35,395,44"/>
<area shape="rect" href="energy__pulse_8c.html#a3baee71ff88d13304ea1b5ae214150cf" title="Initialize GPIO for pulse input." alt="" coords="477,79,611,104"/>
<area shape="poly" title=" " alt="" coords="393,64,464,76,463,81,392,69"/>
<area shape="poly" title=" " alt="" coords="507,80,499,70,503,60,518,54,544,52,576,56,589,65,585,70,574,61,544,57,519,59,506,64,504,70,511,77"/>
<area shape="rect" href="energy__pulse_8c.html#a18690cd2c0cd2e09ff7ab115a9294362" title="Save a single energy channel to persistent storage." alt="" coords="463,189,625,215"/>
<area shape="poly" title=" " alt="" coords="398,199,449,199,449,205,398,205"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a1329c6acbf8c68ee8b0ad7a7b5f3f62d_icgraph.png" border="0" usemap="#aenergy__pulse_8c_a1329c6acbf8c68ee8b0ad7a7b5f3f62d_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a1329c6acbf8c68ee8b0ad7a7b5f3f62d_icgraph" id="aenergy__pulse_8c_a1329c6acbf8c68ee8b0ad7a7b5f3f62d_icgraph">
<area shape="rect" title="Main energy pulse thread." alt="" coords="200,5,359,31"/>
<area shape="rect" href="energy__pulse_8c.html#ad1b60b3b5778d3bacbedbdaef9188276" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,153,21,153,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="ad1b60b3b5778d3bacbedbdaef9188276" name="ad1b60b3b5778d3bacbedbdaef9188276"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1b60b3b5778d3bacbedbdaef9188276">&#9670;&#160;</a></span>K_THREAD_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">K_THREAD_DEFINE </td>
          <td>(</td>
          <td class="paramtype">energy_pulse_thread_id</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_ENERGY_PULSE_MODULE_THREAD_STACK_SIZE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a1329c6acbf8c68ee8b0ad7a7b5f3f62d">energy_pulse_thread</a></td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_THREAD_PRIORITY_ENERGY_PULSE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00465">energy_pulse_thread()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_ad1b60b3b5778d3bacbedbdaef9188276_cgraph.png" border="0" usemap="#aenergy__pulse_8c_ad1b60b3b5778d3bacbedbdaef9188276_cgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_ad1b60b3b5778d3bacbedbdaef9188276_cgraph" id="aenergy__pulse_8c_ad1b60b3b5778d3bacbedbdaef9188276_cgraph">
<area shape="rect" title=" " alt="" coords="5,189,152,215"/>
<area shape="rect" href="energy__pulse_8c.html#a1329c6acbf8c68ee8b0ad7a7b5f3f62d" title="Main energy pulse thread." alt="" coords="200,189,359,215"/>
<area shape="poly" title=" " alt="" coords="152,199,187,199,187,205,152,205"/>
<area shape="rect" href="energy__pulse_8c.html#af2350211e61bd92164f28699163665b7" title="Initialize GPIO for both pulse input channels." alt="" coords="422,41,594,67"/>
<area shape="poly" title=" " alt="" coords="288,187,334,133,367,102,405,76,419,69,422,74,408,80,371,106,338,137,292,191"/>
<area shape="rect" href="energy__pulse_8c.html#a392a7942dccb93cda5fad8e3a5944569" title="Initialize energy pulse data from persistent storage." alt="" coords="407,91,609,116"/>
<area shape="poly" title=" " alt="" coords="297,187,344,156,406,125,427,117,429,122,408,130,347,161,300,192"/>
<area shape="rect" href="energy__pulse_8c.html#a3196f876a6eb90c89f874161b14ac3cd" title="Publish energy pulse data to ZBUS." alt="" coords="409,140,607,165"/>
<area shape="poly" title=" " alt="" coords="338,187,434,166,435,171,339,192"/>
<area shape="rect" href="energy__pulse_8c.html#a9c9ba9582cab179bb2fe8c4de8f2fa74" title="Save energy counters to persistent storage." alt="" coords="424,189,592,215"/>
<area shape="poly" title=" " alt="" coords="359,199,410,199,410,205,359,205"/>
<area shape="rect" href="group__reboot.html#gac92d45e2bf7302d8b7691195e0d23650" title="Publish shutdown acknowledgment to ZBUS." alt="" coords="419,239,597,279"/>
<area shape="poly" title=" " alt="" coords="331,212,415,233,414,239,330,217"/>
<area shape="rect" href="app_8c.html#ad3667701d9e14f8b5fc4e3ee0131a27b" title="Watchdog timeout callback." alt="" coords="437,304,579,329"/>
<area shape="poly" title=" " alt="" coords="297,213,344,251,375,271,408,289,430,297,428,302,406,294,372,276,341,255,293,217"/>
<area shape="rect" href="task__wdt__util_8c.html#a3cd0fca4b68b6c6a7222cde37cf5b49f" title="Sets up a task watchdog channel for the calling thread." alt="" coords="432,353,584,379"/>
<area shape="poly" title=" " alt="" coords="290,213,335,275,369,310,408,340,420,346,418,351,405,344,365,314,331,278,286,216"/>
<area shape="rect" href="energy__pulse_8c.html#abefb7627ec666a33d47d4f9edce23080" title="GPIO callback for pulse counting." alt="" coords="662,5,815,31"/>
<area shape="poly" title=" " alt="" coords="589,39,648,29,649,35,590,44"/>
<area shape="rect" href="energy__pulse_8c.html#a3baee71ff88d13304ea1b5ae214150cf" title="Initialize GPIO for pulse input." alt="" coords="671,79,806,104"/>
<area shape="poly" title=" " alt="" coords="588,64,658,76,658,81,587,69"/>
<area shape="poly" title=" " alt="" coords="701,80,693,70,697,60,713,54,739,52,771,56,783,65,780,70,769,61,739,57,714,59,701,64,698,70,705,77"/>
<area shape="rect" href="energy__pulse_8c.html#a18690cd2c0cd2e09ff7ab115a9294362" title="Save a single energy channel to persistent storage." alt="" coords="657,189,820,215"/>
<area shape="poly" title=" " alt="" coords="592,199,644,199,644,205,592,205"/>
</map>
</div>

</div>
</div>
<a id="ab691f12e2787f4ca09c14ad6d12b92b3" name="ab691f12e2787f4ca09c14ad6d12b92b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab691f12e2787f4ca09c14ad6d12b92b3">&#9670;&#160;</a></span>LOG_MODULE_REGISTER()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LOG_MODULE_REGISTER </td>
          <td>(</td>
          <td class="paramtype">energy_pulse</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_ENERGY_PULSE_MODULE_LOG_LEVEL</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abefb7627ec666a33d47d4f9edce23080" name="abefb7627ec666a33d47d4f9edce23080"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abefb7627ec666a33d47d4f9edce23080">&#9670;&#160;</a></span>pulse_gpio_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void pulse_gpio_callback </td>
          <td>(</td>
          <td class="paramtype">const struct device *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct gpio_callback *</td>          <td class="paramname"><span class="paramname"><em>cb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>pins</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>GPIO callback for pulse counting. </p>
<p>Triggered on rising edge of pulse input pins. Atomically increments the pulse counter for the corresponding channel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>GPIO device (unused) </td></tr>
    <tr><td class="paramname">cb</td><td>GPIO callback structure </td></tr>
    <tr><td class="paramname">pins</td><td>Pin mask indicating which pins triggered the interrupt </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00242">242</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00104">has_new_pulses_since_save</a>, <a class="el" href="energy__pulse_8c_source.html#l00094">pulse_ch1_gpio</a>, <a class="el" href="energy__pulse_8c_source.html#l00096">pulse_ch2_gpio</a>, <a class="el" href="energy__pulse_8c_source.html#l00100">pulse_energy_ch1</a>, and <a class="el" href="energy__pulse_8c_source.html#l00101">pulse_energy_ch2</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00158">energy_pulse_gpio_init()</a>, and <a class="el" href="#adc6936992c86b4d791dc8428cd1f1183">ZBUS_CHAN_DEFINE()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_abefb7627ec666a33d47d4f9edce23080_icgraph.png" border="0" usemap="#aenergy__pulse_8c_abefb7627ec666a33d47d4f9edce23080_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_abefb7627ec666a33d47d4f9edce23080_icgraph" id="aenergy__pulse_8c_abefb7627ec666a33d47d4f9edce23080_icgraph">
<area shape="rect" title="GPIO callback for pulse counting." alt="" coords="627,31,780,56"/>
<area shape="rect" href="energy__pulse_8c.html#af2350211e61bd92164f28699163665b7" title="Initialize GPIO for both pulse input channels." alt="" coords="407,5,579,31"/>
<area shape="poly" title=" " alt="" coords="612,35,578,31,579,26,613,30"/>
<area shape="rect" href="energy__pulse_8c.html#adc6936992c86b4d791dc8428cd1f1183" title=" " alt="" coords="413,55,572,80"/>
<area shape="poly" title=" " alt="" coords="613,56,572,61,572,56,613,51"/>
<area shape="rect" href="energy__pulse_8c.html#a1329c6acbf8c68ee8b0ad7a7b5f3f62d" title="Main energy pulse thread." alt="" coords="200,5,359,31"/>
<area shape="poly" title=" " alt="" coords="393,21,359,21,359,15,393,15"/>
<area shape="rect" href="energy__pulse_8c.html#ad1b60b3b5778d3bacbedbdaef9188276" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,153,21,153,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="a18690cd2c0cd2e09ff7ab115a9294362" name="a18690cd2c0cd2e09ff7ab115a9294362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18690cd2c0cd2e09ff7ab115a9294362">&#9670;&#160;</a></span>save_energy_channel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int save_energy_channel </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const atomic_val_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save a single energy channel to persistent storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Settings key </td></tr>
    <tr><td class="paramname">value</td><td>Pulse count value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00367">367</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="p__one_8c_source.html#l00254">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00388">save_energy_counters()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a18690cd2c0cd2e09ff7ab115a9294362_icgraph.png" border="0" usemap="#aenergy__pulse_8c_a18690cd2c0cd2e09ff7ab115a9294362_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a18690cd2c0cd2e09ff7ab115a9294362_icgraph" id="aenergy__pulse_8c_a18690cd2c0cd2e09ff7ab115a9294362_icgraph">
<area shape="rect" title="Save a single energy channel to persistent storage." alt="" coords="623,5,785,31"/>
<area shape="rect" href="energy__pulse_8c.html#a9c9ba9582cab179bb2fe8c4de8f2fa74" title="Save energy counters to persistent storage." alt="" coords="407,5,575,31"/>
<area shape="poly" title=" " alt="" coords="609,21,575,21,575,15,609,15"/>
<area shape="rect" href="energy__pulse_8c.html#a1329c6acbf8c68ee8b0ad7a7b5f3f62d" title="Main energy pulse thread." alt="" coords="200,5,359,31"/>
<area shape="poly" title=" " alt="" coords="393,21,359,21,359,15,393,15"/>
<area shape="rect" href="energy__pulse_8c.html#ad1b60b3b5778d3bacbedbdaef9188276" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,153,21,153,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="a9c9ba9582cab179bb2fe8c4de8f2fa74" name="a9c9ba9582cab179bb2fe8c4de8f2fa74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c9ba9582cab179bb2fe8c4de8f2fa74">&#9670;&#160;</a></span>save_energy_counters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int save_energy_counters </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save energy counters to persistent storage. </p>
<p>Only saves if there are new pulses since the last save operation. This prevents unnecessary flash writes and extends flash lifetime.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00388">388</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00039">ENERGY_PULSE_CH1_KEY</a>, <a class="el" href="energy__pulse_8c_source.html#l00040">ENERGY_PULSE_CH2_KEY</a>, <a class="el" href="energy__pulse_8c_source.html#l00104">has_new_pulses_since_save</a>, <a class="el" href="energy__pulse_8c_source.html#l00100">pulse_energy_ch1</a>, <a class="el" href="energy__pulse_8c_source.html#l00101">pulse_energy_ch2</a>, and <a class="el" href="energy__pulse_8c_source.html#l00367">save_energy_channel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00465">energy_pulse_thread()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a9c9ba9582cab179bb2fe8c4de8f2fa74_cgraph.png" border="0" usemap="#aenergy__pulse_8c_a9c9ba9582cab179bb2fe8c4de8f2fa74_cgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a9c9ba9582cab179bb2fe8c4de8f2fa74_cgraph" id="aenergy__pulse_8c_a9c9ba9582cab179bb2fe8c4de8f2fa74_cgraph">
<area shape="rect" title="Save energy counters to persistent storage." alt="" coords="5,5,173,31"/>
<area shape="rect" href="energy__pulse_8c.html#a18690cd2c0cd2e09ff7ab115a9294362" title="Save a single energy channel to persistent storage." alt="" coords="221,5,384,31"/>
<area shape="poly" title=" " alt="" coords="174,15,208,15,208,21,174,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a9c9ba9582cab179bb2fe8c4de8f2fa74_icgraph.png" border="0" usemap="#aenergy__pulse_8c_a9c9ba9582cab179bb2fe8c4de8f2fa74_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a9c9ba9582cab179bb2fe8c4de8f2fa74_icgraph" id="aenergy__pulse_8c_a9c9ba9582cab179bb2fe8c4de8f2fa74_icgraph">
<area shape="rect" title="Save energy counters to persistent storage." alt="" coords="407,5,575,31"/>
<area shape="rect" href="energy__pulse_8c.html#a1329c6acbf8c68ee8b0ad7a7b5f3f62d" title="Main energy pulse thread." alt="" coords="200,5,359,31"/>
<area shape="poly" title=" " alt="" coords="393,21,359,21,359,15,393,15"/>
<area shape="rect" href="energy__pulse_8c.html#ad1b60b3b5778d3bacbedbdaef9188276" title=" " alt="" coords="5,5,152,31"/>
<area shape="poly" title=" " alt="" coords="186,21,153,21,153,15,186,15"/>
</map>
</div>

</div>
</div>
<a id="aa7a2e9b92b7d0c72236951d33195aca3" name="aa7a2e9b92b7d0c72236951d33195aca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7a2e9b92b7d0c72236951d33195aca3">&#9670;&#160;</a></span>SETTINGS_STATIC_HANDLER_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SETTINGS_STATIC_HANDLER_DEFINE </td>
          <td>(</td>
          <td class="paramtype">energy_pulse</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONFIG_APP_ENERGY_PULSE_SETTINGS_SUBTREE</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a73e5cbd4dc4398f4a645813bcd7bc1dd">energy_pulse_settings_set</a></td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00304">energy_pulse_settings_set()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_aa7a2e9b92b7d0c72236951d33195aca3_cgraph.png" border="0" usemap="#aenergy__pulse_8c_aa7a2e9b92b7d0c72236951d33195aca3_cgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_aa7a2e9b92b7d0c72236951d33195aca3_cgraph" id="aenergy__pulse_8c_aa7a2e9b92b7d0c72236951d33195aca3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,212,45"/>
<area shape="rect" href="energy__pulse_8c.html#a73e5cbd4dc4398f4a645813bcd7bc1dd" title="Settings handler callback for loading energy pulse data." alt="" coords="260,13,455,38"/>
<area shape="poly" title=" " alt="" coords="212,23,246,23,246,28,212,28"/>
</map>
</div>

</div>
</div>
<a id="a3baee71ff88d13304ea1b5ae214150cf" name="a3baee71ff88d13304ea1b5ae214150cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3baee71ff88d13304ea1b5ae214150cf">&#9670;&#160;</a></span>setup_pulse_gpio()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int setup_pulse_gpio </td>
          <td>(</td>
          <td class="paramtype">const struct gpio_dt_spec *</td>          <td class="paramname"><span class="paramname"><em>gpio_spec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct gpio_callback *</td>          <td class="paramname"><span class="paramname"><em>gpio_cb</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize GPIO for pulse input. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpio_spec</td><td>GPIO device tree specification </td></tr>
    <tr><td class="paramname">gpio_cb</td><td>GPIO callback structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00122">122</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00107">gpio_cb</a>, and <a class="el" href="energy__pulse_8c_source.html#l00122">setup_pulse_gpio()</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00158">energy_pulse_gpio_init()</a>, and <a class="el" href="energy__pulse_8c_source.html#l00122">setup_pulse_gpio()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a3baee71ff88d13304ea1b5ae214150cf_cgraph.png" border="0" usemap="#aenergy__pulse_8c_a3baee71ff88d13304ea1b5ae214150cf_cgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a3baee71ff88d13304ea1b5ae214150cf_cgraph" id="aenergy__pulse_8c_a3baee71ff88d13304ea1b5ae214150cf_cgraph">
<area shape="rect" title="Initialize GPIO for pulse input." alt="" coords="5,29,140,55"/>
<area shape="poly" title=" " alt="" coords="50,30,45,21,48,11,57,5,73,3,91,6,99,14,95,18,88,11,73,8,59,10,52,14,50,20,54,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_a3baee71ff88d13304ea1b5ae214150cf_icgraph.png" border="0" usemap="#aenergy__pulse_8c_a3baee71ff88d13304ea1b5ae214150cf_icgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_a3baee71ff88d13304ea1b5ae214150cf_icgraph" id="aenergy__pulse_8c_a3baee71ff88d13304ea1b5ae214150cf_icgraph">
<area shape="rect" title="Initialize GPIO for pulse input." alt="" coords="627,29,761,55"/>
<area shape="poly" title=" " alt="" coords="730,20,720,11,694,8,673,10,662,15,659,20,665,28,661,31,654,21,658,11,671,5,694,3,722,6,733,16"/>
<area shape="rect" href="energy__pulse_8c.html#af2350211e61bd92164f28699163665b7" title="Initialize GPIO for both pulse input channels." alt="" coords="407,29,579,55"/>
<area shape="poly" title=" " alt="" coords="613,45,579,45,579,39,613,39"/>
<area shape="rect" href="energy__pulse_8c.html#a1329c6acbf8c68ee8b0ad7a7b5f3f62d" title="Main energy pulse thread." alt="" coords="200,29,359,55"/>
<area shape="poly" title=" " alt="" coords="393,45,359,45,359,39,393,39"/>
<area shape="rect" href="energy__pulse_8c.html#ad1b60b3b5778d3bacbedbdaef9188276" title=" " alt="" coords="5,29,152,55"/>
<area shape="poly" title=" " alt="" coords="186,45,153,45,153,39,186,39"/>
</map>
</div>

</div>
</div>
<a id="ad3667701d9e14f8b5fc4e3ee0131a27b" name="ad3667701d9e14f8b5fc4e3ee0131a27b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3667701d9e14f8b5fc4e3ee0131a27b">&#9670;&#160;</a></span>task_wdt_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void task_wdt_callback </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>channel_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>user_data</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Watchdog timeout callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel_id</td><td>Watchdog channel ID </td></tr>
    <tr><td class="paramname">user_data</td><td>User data (thread ID) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00273">273</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

</div>
</div>
<a id="a939a567e02c5666e7e6069482a3256b0" name="a939a567e02c5666e7e6069482a3256b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939a567e02c5666e7e6069482a3256b0">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">DATA_PUBLISH_REQUEST_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">energy_pulse_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="cloud_8c_source.html#l00073">ADD_OBSERVERS</a>.</p>

</div>
</div>
<a id="abfe77b426d92d33e70298643e76e0b0e" name="abfe77b426d92d33e70298643e76e0b0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfe77b426d92d33e70298643e76e0b0e">&#9670;&#160;</a></span>ZBUS_CHAN_ADD_OBS() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_ADD_OBS </td>
          <td>(</td>
          <td class="paramtype">REBOOT_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">energy_pulse_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adc6936992c86b4d791dc8428cd1f1183" name="adc6936992c86b4d791dc8428cd1f1183"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc6936992c86b4d791dc8428cd1f1183">&#9670;&#160;</a></span>ZBUS_CHAN_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_CHAN_DEFINE </td>
          <td>(</td>
          <td class="paramtype">ENERGY_PULSE_CHAN</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structenergy__pulse__msg.html">energy_pulse_msg</a></td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ZBUS_OBSERVERS_EMPTY</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ZBUS_MSG_INIT(0)</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">References <a class="el" href="energy__pulse_8c_source.html#l00242">pulse_gpio_callback()</a>, <a class="el" href="app_8c_source.html#l00079">task_wdt_callback()</a>, and <a class="el" href="app_8c.html#a19084703653c2a15bf7091510af4ea13">ZBUS_CHAN_DEFINE()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="energy__pulse_8c_adc6936992c86b4d791dc8428cd1f1183_cgraph.png" border="0" usemap="#aenergy__pulse_8c_adc6936992c86b4d791dc8428cd1f1183_cgraph" loading="lazy" alt=""/></div>
<map name="aenergy__pulse_8c_adc6936992c86b4d791dc8428cd1f1183_cgraph" id="aenergy__pulse_8c_adc6936992c86b4d791dc8428cd1f1183_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,164,80"/>
<area shape="rect" href="energy__pulse_8c.html#abefb7627ec666a33d47d4f9edce23080" title="GPIO callback for pulse counting." alt="" coords="215,5,368,31"/>
<area shape="poly" title=" " alt="" coords="138,52,223,31,225,37,139,57"/>
<area shape="rect" href="app_8c.html#ad3667701d9e14f8b5fc4e3ee0131a27b" title="Watchdog timeout callback." alt="" coords="220,55,363,80"/>
<area shape="poly" title=" " alt="" coords="164,65,206,65,206,70,164,70"/>
<area shape="rect" href="app_8c.html#a19084703653c2a15bf7091510af4ea13" title=" " alt="" coords="212,104,371,129"/>
<area shape="poly" title=" " alt="" coords="139,77,225,98,223,103,138,83"/>
</map>
</div>

</div>
</div>
<a id="ac8bfcc8baa23f0e3f3600b1e705f323d" name="ac8bfcc8baa23f0e3f3600b1e705f323d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8bfcc8baa23f0e3f3600b1e705f323d">&#9670;&#160;</a></span>ZBUS_MSG_SUBSCRIBER_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ZBUS_MSG_SUBSCRIBER_DEFINE </td>
          <td>(</td>
          <td class="paramtype">energy_pulse_subscriber</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a2c1fdb2a55600085d534b2305e5c3385" name="a2c1fdb2a55600085d534b2305e5c3385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c1fdb2a55600085d534b2305e5c3385">&#9670;&#160;</a></span>gpio_cb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct gpio_callback gpio_cb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00107">107</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00158">energy_pulse_gpio_init()</a>, and <a class="el" href="energy__pulse_8c_source.html#l00122">setup_pulse_gpio()</a>.</p>

</div>
</div>
<a id="a0c3e33e28926531c22ff5e7400a9776f" name="a0c3e33e28926531c22ff5e7400a9776f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c3e33e28926531c22ff5e7400a9776f">&#9670;&#160;</a></span>has_new_pulses_since_save</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">atomic_t has_new_pulses_since_save = ATOMIC_INIT(0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00104">104</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00427">energy_pulse_load_settings()</a>, <a class="el" href="energy__pulse_8c_source.html#l00242">pulse_gpio_callback()</a>, and <a class="el" href="energy__pulse_8c_source.html#l00388">save_energy_counters()</a>.</p>

</div>
</div>
<a id="a414835ffc7cc99ac71c9655e8f1912fe" name="a414835ffc7cc99ac71c9655e8f1912fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a414835ffc7cc99ac71c9655e8f1912fe">&#9670;&#160;</a></span>pulse_ch1_gpio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct gpio_dt_spec pulse_ch1_gpio</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">        GPIO_DT_SPEC_GET( DT_PATH(pulses, pulse_one) , gpios)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00094">94</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00158">energy_pulse_gpio_init()</a>, and <a class="el" href="energy__pulse_8c_source.html#l00242">pulse_gpio_callback()</a>.</p>

</div>
</div>
<a id="abbd0a8e65b5facd35573d86cdd30db47" name="abbd0a8e65b5facd35573d86cdd30db47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbd0a8e65b5facd35573d86cdd30db47">&#9670;&#160;</a></span>pulse_ch2_gpio</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct gpio_dt_spec pulse_ch2_gpio</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">        GPIO_DT_SPEC_GET( DT_PATH(pulses, pulse_two) , gpios)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00096">96</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00158">energy_pulse_gpio_init()</a>, and <a class="el" href="energy__pulse_8c_source.html#l00242">pulse_gpio_callback()</a>.</p>

</div>
</div>
<a id="a0886d16feaea1ed7170637194c54534f" name="a0886d16feaea1ed7170637194c54534f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0886d16feaea1ed7170637194c54534f">&#9670;&#160;</a></span>pulse_energy_ch1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">atomic_t pulse_energy_ch1 = ATOMIC_INIT(0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00100">100</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00427">energy_pulse_load_settings()</a>, <a class="el" href="energy__pulse_8c_source.html#l00191">energy_pulse_msg_publish()</a>, <a class="el" href="energy__pulse_8c_source.html#l00304">energy_pulse_settings_set()</a>, <a class="el" href="energy__pulse_8c_source.html#l00242">pulse_gpio_callback()</a>, and <a class="el" href="energy__pulse_8c_source.html#l00388">save_energy_counters()</a>.</p>

</div>
</div>
<a id="a1b05ed500d1fa2847e79ce10f95c3c19" name="a1b05ed500d1fa2847e79ce10f95c3c19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b05ed500d1fa2847e79ce10f95c3c19">&#9670;&#160;</a></span>pulse_energy_ch2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">atomic_t pulse_energy_ch2 = ATOMIC_INIT(0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="energy__pulse_8c_source.html#l00101">101</a> of file <a class="el" href="energy__pulse_8c_source.html">energy_pulse.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy__pulse_8c_source.html#l00427">energy_pulse_load_settings()</a>, <a class="el" href="energy__pulse_8c_source.html#l00191">energy_pulse_msg_publish()</a>, <a class="el" href="energy__pulse_8c_source.html#l00304">energy_pulse_settings_set()</a>, <a class="el" href="energy__pulse_8c_source.html#l00242">pulse_gpio_callback()</a>, and <a class="el" href="energy__pulse_8c_source.html#l00388">save_energy_counters()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_1b41d3a148801ef4e2f0892bc9eecc7e.html">modules</a></li><li class="navelem"><a href="dir_ae065dddcb864ef172d3d29770fa0240.html">energy_pulse</a></li><li class="navelem"><a href="energy__pulse_8c.html">energy_pulse.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
