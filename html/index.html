<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="dark-mode">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="SolarResult Dinnis Core API Documentation" />
<meta property="og:description" content="API documentation for SolarResult Dinnis Core - IoT firmware for smart meter gateway device built with Zephyr RTOS on Nordic nRF9161" />
<!-- END opengraph metadata -->
<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="solar_result_white.svg">
<title>SolarResult Dinnis Core: SolarResult Dinnis Core - Firmware Documentatie</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript">
    // Initialize Doxygen Awesome features (dark mode only, no toggle)
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="solar_result_white.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SolarResult Dinnis Core
   </div>
   <div id="projectbrief">Dinnis Rev1.0.0 Firmware - IoT Gateway for DSMR P1 Smart Meters</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">SolarResult Dinnis Core - Firmware Documentatie </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="mainpage"></a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md292"></a>
ğŸ“‹ Overzicht</h1>
<p>Welkom bij de API documentatie van <b>SolarResult Dinnis Core</b> - de embedded firmware voor de Dinnis Rev1.0.0 slimme meter gateway.</p>
<p>Deze firmware draait op een <b>Nordic nRF9161</b> microcontroller en is gebouwd met <b>Zephyr RTOS v4.2.0</b> en <b>nRF Connect SDK v3.1.1</b>. Het apparaat leest energiedata van P1 DSMR slimme meters en puls-tellers, en verstuurt deze naar nRF Cloud.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md294"></a>
ğŸ—ï¸ Architectuur</h1>
<p>De firmware is opgebouwd uit modulaire componenten die communiceren via <b>ZBUS</b> (Zephyr Bus). Elke module heeft zijn eigen thread en state machine voor robuuste operatie.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md295"></a>
Kernmodules</h2>
<p>Klik op een module voor de volledige documentatie inclusief design rationale, implementatie details en use cases.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Module  </th><th class="markdownTableHeadNone">Beschrijving  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="p_one_doc.html">P1 DSMR</a>  </td><td class="markdownTableBodyNone">DSMR slimme meter uitlezing via UART  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="energy_pulse_doc.html">Energy Pulse</a>  </td><td class="markdownTableBodyNone">Puls-teller monitoring via GPIO  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="message_queue_doc.html">Message Queue</a>  </td><td class="markdownTableBodyNone">Data buffering en verzending  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="cloud_doc.html">Cloud</a>  </td><td class="markdownTableBodyNone">nRF Cloud connectiviteit  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="network_doc.html">Network</a>  </td><td class="markdownTableBodyNone">LTE-M/NB-IoT modem beheer  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="timing_doc.html">Timing</a>  </td><td class="markdownTableBodyNone">Periodieke triggers en scheduling  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="led_doc.html">LED</a>  </td><td class="markdownTableBodyNone">Visuele status indicatie  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="reboot_doc.html">Reboot</a>  </td><td class="markdownTableBodyNone">Graceful shutdown en herstarten  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="app_doc.html">Application</a>  </td><td class="markdownTableBodyNone">Main application entry point  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md297"></a>
ğŸ”„ Data Flow &amp; Module Interacties</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md298"></a>
Visueel Overzicht</h2>
<div class="fragment"><div class="line">                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</div>
<div class="line">                 â”‚              ZBUS Message Bus                     â”‚</div>
<div class="line">                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
<div class="line">                                       â”‚</div>
<div class="line">     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</div>
<div class="line">     â”‚                                 â”‚                                 â”‚</div>
<div class="line">â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”    DATA_ACQUISITION   â”Œâ”€â”€â–¼â”€â”€â”€â”    P_ONE_CHAN    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”</div>
<div class="line">â”‚ Timing   â”‚â”€â”€â”€â”€TRIGGER_CHANâ”€â”€â”€â”€â”€â”€â”€â–¶â”‚ P1   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Message Queue â”‚</div>
<div class="line">â”‚  Module  â”‚                        â””â”€â”€â”€â”€â”€â”€â”˜                  â”‚               â”‚</div>
<div class="line">â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    DATA_PUBLISH           â”‚                      â”‚   (Buffer)    â”‚</div>
<div class="line">     â”‚          REQUEST_CHAN            â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜</div>
<div class="line">     â”‚          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚                              â”‚</div>
<div class="line">     â”‚                        â”‚         â”‚  ENERGY_PULSE_CHAN           â”‚</div>
<div class="line">     â”‚          DATA_SEND     â–¼         â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚</div>
<div class="line">     â”‚          REQUEST_CHAN  â”‚     â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚          â”‚</div>
<div class="line">     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â–¶â”‚   Energy   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚</div>
<div class="line">                              â”‚     â”‚   Pulse    â”‚                     â”‚</div>
<div class="line">     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚</div>
<div class="line">     â”‚                                                                  â”‚</div>
<div class="line">     â”‚                                                        CLOUD_CHANâ”‚</div>
<div class="line">     â”‚                              NETWORK_CHAN            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”</div>
<div class="line">     â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚     Cloud      â”‚</div>
<div class="line">     â”‚                      â”‚                               â”‚   (nRF Cloud)  â”‚</div>
<div class="line">â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜</div>
<div class="line">â”‚   LED    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Network â”‚                                   â”‚</div>
<div class="line">â”‚  Module  â”‚          â”‚ (Modem) â”‚                         FOTA_CHAN â”‚</div>
<div class="line">â””â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
<div class="line">     â”‚                     â”‚                                    â”‚</div>
<div class="line">     â”‚   TRIGGER_CHAN      â”‚                                    â”‚</div>
<div class="line">     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â–¼</div>
<div class="line">     â”‚                                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”</div>
<div class="line">     â”‚   FOTA_CHAN                           REBOOT_CHAN   â”‚ Reboot  â”‚</div>
<div class="line">     â””â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Module  â”‚</div>
<div class="line">                                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md299"></a>
ZBUS Channel Overzicht</h2>
<p>De firmware modules communiceren via <b>11 ZBUS channels</b>. Hieronder een compleet overzicht:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Channel  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Publisher  </th><th class="markdownTableHeadNone">Subscribers  </th><th class="markdownTableHeadNone">Doel  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>DATA_ACQUISITION_TRIGGER_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">timing_event_msg</span>  </td><td class="markdownTableBodyNone">Timing  </td><td class="markdownTableBodyNone">P1  </td><td class="markdownTableBodyNone">Trigger P1 om nieuwe data op te halen (30s interval)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>DATA_PUBLISH_REQUEST_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">timing_event_msg</span>  </td><td class="markdownTableBodyNone">Timing  </td><td class="markdownTableBodyNone">Message Queue, P1, Energy Pulse  </td><td class="markdownTableBodyNone">Request modules om statistics te publishen (10 min)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>DATA_SEND_REQUEST_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">timing_event_msg</span>  </td><td class="markdownTableBodyNone">Timing  </td><td class="markdownTableBodyNone">Message Queue  </td><td class="markdownTableBodyNone">Verzoek om gebufferde messages naar cloud te sturen (30 min)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>P_ONE_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">p_one_msg</span>  </td><td class="markdownTableBodyNone">P1  </td><td class="markdownTableBodyNone">Message Queue  </td><td class="markdownTableBodyNone">P1 meter data met statistics  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>ENERGY_PULSE_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">energy_pulse_msg</span>  </td><td class="markdownTableBodyNone">Energy Pulse  </td><td class="markdownTableBodyNone">Message Queue  </td><td class="markdownTableBodyNone">Puls-teller data (Wh per kanaal)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>NETWORK_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">network_msg</span>  </td><td class="markdownTableBodyNone">Network  </td><td class="markdownTableBodyNone">Cloud, LED  </td><td class="markdownTableBodyNone">Modem connectivity status (CONNECTED/DISCONNECTED)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>CLOUD_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">cloud_msg</span>  </td><td class="markdownTableBodyNone">Cloud  </td><td class="markdownTableBodyNone">Message Queue, Cloud, LED  </td><td class="markdownTableBodyNone">nRF Cloud connectie status  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>FOTA_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">fota_msg</span>  </td><td class="markdownTableBodyNone">Cloud  </td><td class="markdownTableBodyNone">LED  </td><td class="markdownTableBodyNone">FOTA download progress en status  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>REBOOT_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">reboot_msg</span>  </td><td class="markdownTableBodyNone">Reboot  </td><td class="markdownTableBodyNone">Cloud, Energy Pulse  </td><td class="markdownTableBodyNone">Graceful shutdown coordinatie  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>TRIGGER_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">trigger_msg</span>  </td><td class="markdownTableBodyNone"><em>(unused)</em>  </td><td class="markdownTableBodyNone">LED  </td><td class="markdownTableBodyNone">âš ï¸ Gedefinieerd door App, maar nooit gepubliceerd  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>PRIV_CLOUD_CHAN</b>  </td><td class="markdownTableBodyNone"><span class="tt">int</span>  </td><td class="markdownTableBodyNone">Cloud  </td><td class="markdownTableBodyNone">Cloud (self)  </td><td class="markdownTableBodyNone">Interne async callback â†’ state machine communicatie  </td></tr>
</table>
<h2 class="doxsection"><a class="anchor" id="autotoc_md300"></a>
Message Flow Scenarios</h2>
<h3 class="doxsection"><a class="anchor" id="autotoc_md301"></a>
ğŸ“¥ Normal Data Collection (elke 30 seconden)</h3>
<ol type="1">
<li><b>Timing</b> publiceert <span class="tt">DATA_ACQUISITION_TRIGGER_CHAN</span></li>
<li><b>P1</b> start UART data request naar slimme meter</li>
<li><b>P1</b> ontvangt telegram, parsed OBIS codes, berekent rolling statistics</li>
<li><b>P1</b> publiceert <span class="tt">P_ONE_CHAN</span> naar Message Queue</li>
<li><b>Message Queue</b> buffert data voor volgende publish cycle</li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md302"></a>
ğŸ“Š Publish Statistics (elke 10 minuten)</h3>
<ol type="1">
<li><b>Timing</b> publiceert <span class="tt">DATA_PUBLISH_REQUEST_CHAN</span></li>
<li><b>P1</b> reset rolling statistics, publiceert laatste stats via <span class="tt">P_ONE_CHAN</span></li>
<li><b>Energy Pulse</b> publiceert huidige Wh counters via <span class="tt">ENERGY_PULSE_CHAN</span></li>
<li><b>Message Queue</b> combineert P1 + Pulse data, queued message met timestamp</li>
<li>Data blijft in queue tot <span class="tt">DATA_SEND_REQUEST_CHAN</span></li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md303"></a>
â˜ï¸ Cloud Transmission (elke 30 minuten)</h3>
<ol type="1">
<li><b>Timing</b> publiceert <span class="tt">DATA_SEND_REQUEST_CHAN</span></li>
<li><b>Message Queue</b> checkt <span class="tt">CLOUD_CHAN</span> status (cloud ready?)</li>
<li>Als ready: dequeue tot 10 messages, encode als JSON, send via <span class="tt">nrf_cloud_send()</span></li>
<li>Bij failure: messages blijven in queue voor volgende cycle</li>
<li>Queue gebruikt drop-oldest strategie bij overflow (FIFO)</li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md304"></a>
ğŸ”„ Startup Sequence</h3>
<ol type="1">
<li><b>Network</b> initialiseert modem, wacht op <span class="tt">L4_CONNECTED</span> event</li>
<li><b>Network</b> publiceert <span class="tt">NETWORK_CHAN</span> met <span class="tt">CONNECTED</span> status</li>
<li><b>Cloud</b> ontvangt network ready, start nRF Cloud connect</li>
<li><b>Cloud</b> publiceert <span class="tt">CLOUD_CHAN</span> met <span class="tt">CLOUD_READY</span> status</li>
<li><b>Message Queue</b> start sending queued data (indien aanwezig)</li>
<li><b>LED</b> toont CLOUD_CONNECTED pattern (groene pulse)</li>
</ol>
<h3 class="doxsection"><a class="anchor" id="autotoc_md305"></a>
ğŸ›‘ Graceful Shutdown</h3>
<ol type="1">
<li><b>Cloud</b> ontvangt FOTA complete â†’ publiceert <span class="tt">REBOOT_CHAN</span> met <span class="tt">REBOOT_REQ</span></li>
<li><b>Reboot</b> module re-publiceert als <span class="tt">SHUTDOWN_REQ</span> met observers tracking</li>
<li><b>Cloud</b> + <b>Energy Pulse</b> ACK via <span class="tt">REBOOT_CHAN</span> (<span class="tt">SHUTDOWN_ACK</span>)</li>
<li><b>Reboot</b> wacht tot alle observers disabled (ACK count == 1, only self)</li>
<li><b>Reboot</b> roept <span class="tt">sys_reboot()</span> aan via work queue (non-blocking)</li>
</ol>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md307"></a>
âš™ï¸ Belangrijke Features</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md308"></a>
ğŸ”Œ Hardware Ondersteuning</h2>
<ul>
<li><b>Nordic nRF9161</b> - Cellular IoT SiP met Arm Cortex-M33</li>
<li><b>LTE-M / NB-IoT</b> connectiviteit</li>
<li><b>P1 DSMR interface</b> (UART met auto-baudrate detectie)</li>
<li><b>2x Puls-teller inputs</b> (GPIO interrupt-driven)</li>
<li><b>RGB LED</b> voor status indicatie</li>
<li><b>Hardware Watchdog</b> voor robuustheid</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md309"></a>
ğŸ“Š Data Verwerking</h2>
<ul>
<li><b>DSMR 5.0 / ESMR 5.0</b> parser met CRC validatie</li>
<li><b>Rolling statistics</b> (avg/min/max) over 10-minuten intervallen</li>
<li><b>Separate tracking</b> van consumed en delivered power</li>
<li><b>Timestamp synchronisatie</b> met slimme meter</li>
<li><b>Queue-based buffering</b> voor betrouwbare data delivery</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md310"></a>
â˜ï¸ Cloud Integratie</h2>
<ul>
<li><b>nRF Cloud MQTT</b> met TLS/DTLS</li>
<li><b>Exponential backoff</b> reconnect strategie</li>
<li><b>Message queueing</b> tijdens offline perioden</li>
<li><b>Device shadow</b> synchronisatie</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md311"></a>
ğŸ›¡ï¸ Robustness Features</h2>
<ul>
<li><b>State machines</b> (SMF) voor gedetermineerd gedrag</li>
<li><b>Task watchdog</b> monitoring per module</li>
<li><b>Graceful shutdown</b> coÃ¶rdinatie</li>
<li><b>Settings persistence</b> via NVS (Non-Volatile Storage)</li>
<li><b>Error recovery</b> met automatic retry</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md313"></a>
ğŸš€ Aan de Slag</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md314"></a>
Build Systeem</h2>
<p>De firmware gebruikt <b>West</b> (Zephyr's meta-tool) als build systeem:</p>
<div class="fragment"><div class="line"># Configureer build</div>
<div class="line">west config build.cmake-args &quot; -DBOARD_ROOT=../&quot;</div>
<div class="line">west config build.board &quot;dinnis_rev1_0_0/nrf9161/ns&quot;</div>
<div class="line">west config build.build-dir &quot;build&quot;</div>
<div class="line"> </div>
<div class="line"># Build firmware</div>
<div class="line">west build application</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md315"></a>
Custom Board Definition</h2>
<p>De Dinnis Rev1.0.0 board definitie bevindt zich in: </p><div class="fragment"><div class="line">boards/solarresult/dinnis_rev1_0_0/</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md316"></a>
Configuratie</h2>
<p>Belangrijke Kconfig opties zijn gedocumenteerd in elke module's README.md.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md318"></a>
ğŸ“š Documentatie Structuur</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md319"></a>
ğŸ“„ API Referentie</h2>
<ul>
<li><b>Files</b> - Alle source en header files met inline documentatie</li>
<li><b>Data Structures</b> - Structs, enums en typedefs</li>
<li><b>Functions</b> - Functie prototypes met parameters en return values</li>
<li><b>Variables</b> - Globale variabelen en constanten</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md320"></a>
ğŸ“Š Call Graphs</h2>
<p>Voor elke functie zijn er gedetailleerde grafieken:</p><ul>
<li><b>Call Graph</b> - Welke functies roept deze functie aan?</li>
<li><b>Caller Graph</b> - Welke functies roepen deze functie aan?</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md321"></a>
ğŸ“ Module README's</h2>
<p>Elke module heeft een <span class="tt">README.md</span> met:</p><ul>
<li><b>Waarom?</b> - Probleem, motivatie en design rationale</li>
<li><b>Wat?</b> - Functionaliteit, data flow en use cases</li>
<li><b>Hoe?</b> - Architectuur, gedrag en timing</li>
<li><b>Resultaat</b> - Impact cijfers en verificatie</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md323"></a>
ğŸ”— Belangrijke Links</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md324"></a>
ğŸ“š Handleidingen</h2>
<ul>
<li><a class="el" href="provisioning.html">Provisioning and Onboarding</a> - Complete stap-voor-stap gids voor het provisioneren van devices</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md325"></a>
ğŸŒ Externe Resources</h2>
<ul>
<li><b>Project Repository</b>: <a href="https://github.com/SolarResult">GitHub - SolarResult/fw-dinnis-core</a></li>
<li><b>Zephyr Documentation</b>: <a href="https://docs.zephyrproject.org/">Zephyr Project Docs</a></li>
<li><b>nRF Connect SDK</b>: <a href="https://www.nordicsemi.com/Products/Development-software/nrf-connect-sdk">Nordic Semiconductor</a></li>
<li><b>nRF Cloud</b>: <a href="https://nrfcloud.com/">nRF Cloud Portal</a></li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md327"></a>
ğŸ“ Contact</h1>
<p><b>SolarResult B.V.</b> <br  />
 Slimme energie monitoring oplossingen</p>
<ul>
<li>ğŸŒ Website: <a href="https://www.solarresult.nl">www.solarresult.nl</a></li>
<li>ğŸ“§ Email: <a href="#" onclick="location.href='mai'+'lto:'+'inf'+'o@'+'sol'+'ar'+'res'+'ul'+'t.n'+'l'; return false;">info@<span class="obfuscator">.nosp@m.</span>sola<span class="obfuscator">.nosp@m.</span>rresu<span class="obfuscator">.nosp@m.</span>lt.n<span class="obfuscator">.nosp@m.</span>l</a></li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md329"></a>
ğŸ“„ Licentie</h1>
<p>Copyright Â© 2025 SolarResult B.V. <br  />
 Alle rechten voorbehouden.</p>
<hr  />
<dl class="section note"><dt>Note</dt><dd>Deze documentatie is automatisch gegenereerd met Doxygen en gebaseerd op de source code commentaren. </dd></dl>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- doc-content -->
</div><!-- contents -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
